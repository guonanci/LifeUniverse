浏览器有GUI渲染线程与JS引擎线程，这两个线程是互斥的关系
JavaScript的加载、解析与执行会阻塞DOM的构建。也就是说，在构建DOM时，HTML解析器若遇到了JavaScript，那么它会暂停构建DOM，将控制权移交给JavaScript引擎，等JavaScript引擎运行完毕，浏览器再从中断的地方恢复DOM构建
但是如果遇到带有async和defer的script标签，就会异步请求这些资源，不会阻塞页面渲染
浏览器渲染过程分为：构建DOM -> 构建CSSOM -> 构建渲染树 -> layout布局 -> 绘制
script标签 async defer的区别
直接使用script会阻塞DOM渲染，在脚本加载&执行的过程中，会阻塞后续的DOM渲染
使用async和defer，这两个属性使得script都不会阻塞DOM的渲染
async和defer的区别：
async是无顺序的加载，而defer是有顺序的加载
1）执行顺序的区别
async的执行，并不会按照script在页面中的顺序来执行，而是谁先加载完谁执行
defer的执行，则会按照引入的顺序执行，即便是后面的script资源先返回
2）对window.onload的影响
使用defer的script标签，会在window.onload 事件之前被执行
使用async的script标签，对window.onload 事件没有影响，window.onload可以在之前或之后执行
使用场景的区别
1）defer可以用来控制js文件的加载顺序
比如jq 和 Bootstrap，因为Bootstrap中的js插件依赖于jqery，所以必须先引入jQuery，再引入Bootstrap js文件
2）如果你的脚本并不关心页面中的DOM元素（文档是否解析完毕），并且也不会产生其他脚本需要的数据，使用async， 如统计、埋点等功能
浅谈script标签中的async和defer


作者：海阔_天空
链接：https://juejin.cn/post/7146996646394462239
来源：稀土掘金
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
# 浏览器的渲染原理
1. 首先解析收到的文档，根据文档定义构建一颗 DOM 树，DOM 树是由 DOM 元素及属性节点组成的；
2. 然后对 CSS 进行解析，生成 CSSOM 规则树；
3. 根据 DOM 树和 CSSOM 规则树构建 Render Tree。渲染树的节点被称为渲染对象，渲染对象是一个包含有颜色和大小等属性的矩形，渲染对象和 DOM 对象相对应，但这种对应关系不是一对一的，不可见的 DOM 元素不会被插入渲染树。
4. 当渲染对象被创建并添加到树中，它们并没有位置和大小，所以当浏览器生成渲染树以后，就会根据渲染树来进行布局（也可以叫做回流）。这一阶段浏览器要做的事情就是要弄清楚各个节点在页面中的确切位置和大小。通常这一行为也被称为“自动重排”。
5. 布局阶段结束后是绘制阶段，比那里渲染树并调用对象的 paint 方法将它们的内容显示在屏幕上，绘制使用 UI 基础组件。

为了更好的用户体验，渲染引擎会尽可能早的将内容呈现到屏幕上，并不会等到所有的 html 解析完成之后再去构建和布局 render tree。它是解析完一部分内容就显示一部分内容，同时可能还在网络下载其余内容。
