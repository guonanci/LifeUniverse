# 岗位职责

1. 负责Web前端页面构建及后端交互的设计、开发、和支持工作；
2. 根据产品设计要求，完成巡检机器人监控管理系统平台的web端开发；
3. 负责解决系统的兼容性问题，包括多浏览器、不同终端之间，持续优化用户交互体验，保证执行效率；
4. 与后端工程师一起完成软件的开发和升级工作；
5. 参与项目需求的分析、概要设计、和详细设计等，撰写相关技术文档；
6. 领导交代的其他工作；

# 任职要求

1. 2年以上web项目经验，有巡检机器人监控管理系统的开发经验，或AGV调度系统开发经验的人优先；
2. 精通HTML5、CSS、JavaScript等Web前端开发技术，熟悉ReactJS；
3. 能熟练使用Vue、NodeJS等框架，熟悉HTML5特性，了解HTML5最新规范，能熟练运用HTML5特性构建H5应用；
4. 有使用代码管理工具的经验，能熟练使用SVN或Git，掌握一定的开发规范，具备良好的编码习惯；
5. 工作主动性强，具备团队协作精神，能够承受一定的工作压力；有较强的创造力、拓展力、和组织协调力，有较强的自学和独立解决难题的能力。

# 小马机器人产品册Xiaoma Robot Enterprise Promotion(2023)

江西小马机器人有限公司，位于小蓝经济技术开发区，研发团队由中科院博士领衔组建，公司基于机器人、大数据、物联网、人工智能等新技术，在电力、交通、矿山、林业等行业领域，和清华大学、南昌大学等国内知名高校，建立战略合作，推动产业技术革新。是EPTC机器人委员单位、以及参与制定巡检机器人的行业标准单位。

具备18项国家发明专利、24项实用新型专利、3项外观设计专利、20项软件著作权。业务范围涵盖：石化、工矿、交通、电力、铁路、林业等。产品系列包含：智慧电厂安全管控平台、智慧矿山安全管控平台、超融合智能化管控平台、智能辅助监控系统、智能巡检机器人、无人机、摄像头等。

场景级平台包括平台层、算法层、系统层、边缘层、和感知层，平台层包括铁路、电力、电厂、矿山、林业、交通、水利、化工、仓储、和园区等等，算法层包括安全帽识别、工服识别、人员闯入、烟火识别、电话识别、吸烟识别、摔倒识别、反光衣识别、电子围栏、车牌识别、OCR识别、车辆识别、裸露识别、绝缘识别、异常聚集、异常离岗、打架识别、灭火器识别、人员识别、声音识别。

以及皮带跑偏/撕裂/异物/煤流量/振动/异响/接口识别；表计/开关/指示灯/局放/油位/刀闸/压板；石油化工跑冒滴漏/设备异响/人员行为识别等等。

系统层包括环境监测、视频确认、智能分析、故障预警、立体巡视、声纹监测、设备联动、实时监控、红外测温、远程操作、设备监测、缺陷识别、台账管理、报警联动、数据分析、设备管理、远程推送、巡视报告等等。

边缘层包括数据采集、数据清洗、数据监控、数据过滤、轻量级数据库、数据安全防护、资源调度和决策优化、数据存储、数据上报、安全管理、预测维护、本地策略、应用部署、容器管理等等。

产品总览分为基础设施方面、感知设施方面、工具算法方面、以及软件平台方面。基础设施包括室外机器人、室内机器人、管廊机器人、轨道式机器人、无人机、防爆机器人、操作机器人、四足机器人、皮带检测机器人、电缆沟机器人；感知设施包括本安筒机类、本安球机类、在线测温类、激光雷达、皮带撕裂装置、温振传感器、防爆在线类、微型测温、气象站、水浸传感器、红外对射、气体传感器、智能安全箱、超声波测距、空调控制器、粉尘传感器、气象传感器、声纹装置、双目视觉等。

工具算法包括行为、安全、场景识别算法；红外、表计、缺陷识别算法；3D点云绘制软件；无人机航线规划软件等。软件平台包括超融合智能管控平台、智慧电厂安全管控平台、智慧矿山安全管控平台、远程智能巡视系统、巡检机器人系统、无人机天网调度系统。

我们的核心优势包括行车行人监测、人体区域入侵检测、人员电子围栏检测、人员离岗识别、人员异常火点检测、安全帽识别、佩戴口罩检测、空开/压板/旋钮识别、LED指示灯/数字识别、外观识别、渗shen漏油检测、鸟巢检测、开关SF6表计、套管油位表、隔离开关分/合、气体压力表、变压器油枕识别、油位计自动识别、皮带撕裂检测、皮带跑偏检测、皮带托辊gun测温、皮带卡kia堵检测、皮带异物识别、烟雾火雾识别。

数据管理包括智能标注、可视化数据集管理；模型训练包括AutoML模型自动训练、智能模型调优；模型部署包括云端在线推理、多类边缘设备支持；应用集成包括模型迭代优化、多类开放接口。

追求卓越质量，创造世界品牌。我们的合作伙伴包括中国移动、中国石化、清华大学、国家能源集团、中国大唐集团公司、中国华能、国家电投、国家电网、中国南方电网、中国三峡、中国石油。

资质及检测报告包括国家高新技术企业、ISO质量管理体系认证、EPTC电力机器人专家工作委员会委员单位、双软企业认证、ISO环境管理体系认证、中国国际贸易促进会电力行业委员会单位、CMMI3 Maturity Level3、ISO职业健康安全管理体系认证、江西省机器人与智能制造装备产业联合会单位；机器人通过电科院开普检测，MW-200集中型机器人通过武高所检测，最早入围国网的机器人单位之一。

室外机器人MW200的尺寸大小为580mm *480mm* 450mm，具备多传感器融合技术，支持LIDAR、IMU、Odom、以及Vision进行融合定位，精准区分动静障碍物，安全系数高。其智能算法支持动态智能抓拍、不停车巡检。可识别表计、刀闸、油位、声音、红外测温，支持国网17种缺陷检测。MW200应用于变电站、牵引站、升压站，首批通过武高所集中检测，人机交互包括360度全车影像、双向语音对讲、远距离遥控。

MW200配备多区域避障雷达、3D激光雷达。性能参数包括全向移动、续航8小时、5G通讯、自主充电，安全防护涵盖激光扫描、3D视觉、超声波检测、防撞条、急停。

室内机器人MN300的尺寸大小为740mm *520mm* 863mm，其具备的多传感器融合技术支持LIDAR、IMU、Odom、以及Vision进行融合定位，精准区分动静障碍物，安全系数高；智能算法支持动态智能抓拍、不停车巡检。可识别指示灯、LED数字、开关、表计、声音、红外测温、局放、支持国网17种缺陷检测。应用于配电房、铁路牵引站、继保室、高配室、隧道、IDC机房。

智能告警，数字孪生。人机交互包括声光报警、双向语音对讲、远距离遥控。性能参数包括360旋转臂、续航8小时、5G通讯、自主充电。安全防护包括激光扫描、探沟检测、超声波检测、防撞条、急停。

轨道机器人MG400A的尺寸大小为345mm *210mm* 882mm，其具备的系统功能有滑触线供电，支持DCS、PLC联动、系统具备环境数据监测，实现故障早发现、早处理。智能算法可识别指示灯、LED数字、开关、表计、声音、红外测温、局放，支持国网17种缺陷检测。通过国网电科院检测，人机交互包括语音识别、双向语音对讲、远距离遥控。性能参数包括升降高度2m、20KG、拐弯半径0.3、载波通讯。安全防护有超声波检测、防撞条、急停。

输煤栈桥机器人MG400C的尺寸大小为459mm *390mm* 477mm，其具备的系统功能有：边缘层算力21Tops，支持DCS、PLC联动，系统具备环境数据监测，实现故障早发现、早处理。智能算法可识别皮带跑偏、皮带接口检测、托辊测温、托辊缺失、表计、声音、电机震动分析，支持煤流量、人员行为安全分析。应用于管廊、煤矿、电厂、矿山。智能告警、数字孪生。人机交互包括语音识别、双向语音对讲、远距离遥控。

性能参数有自主无线充电、爬60坡、拐弯半径0.3.安全防护有超声波检测、防撞条、急停。室内外一体机器人MY500尺寸大小为700mm *544mm* (861 - 1861)mm，其具备的多传感器融合技术支持LIDAR、IMU、Odom、以及Vision进行融合定位，精准区分动静障碍物，安全系数高；智能算法支持动态智能抓拍、不停车巡检。可识别指示灯、LED数字、开关、表计、声音、红外测温、局放、支持国网17种缺陷检测。

应用于配电房、铁路牵引站、继保室、高配室、隧道、IDC机房。人机交互包括语音识别、双向语音对讲、远距离遥控。性能参数包括升降高度1.8m、续航8小时、自主充电。安全防护有激光扫描、探沟检测、超声波检测、防撞条、急停。

一体化感知系统是巡检行业领军企业构建的天空-陆地一体化感知系统，涵盖空基-无人机低空数据感知，用于应急、精细化、常规巡检；和天基的卫星，有遥感影像和北斗导航定位；还有陆基的机场、机器人、摄像头、物联网，以及线缆机器人、监控管廊、电缆沟等等，可进行数据综合汇总处理；监测对象全感知，包括水库、林业、电厂、风力等等，监测手段全应用，包括多传感器、遥感视频等等。

场景级级别涵盖能源侧、输变侧、配用侧，能源侧有智慧电厂安全平台、虚拟电厂调度平台、输电线路巡检平台、智慧风力巡检系统、智慧光伏巡检系统；输变侧有在线智能巡视系统、变电站智慧辅控系统、变电站巡视系统、变电站集中巡视系统、变电站区域巡视系统、电缆沟巡检系统；配用侧包括智慧空调管控平台、智慧能源安全平台、智慧高速巡视系统、智慧林业巡视系统。

业务场景一，是落地的智慧矿山业务场景，项目背景是这样的：我国矿产自然资源丰富，生产利用率高。随着工业化进程的推进，矿业开采加工的生产任务也日益繁重。对于选煤厂、综采面、井下皮带、井上供电系统、井下供电系统等场景，需加强管控。常见管控措施主要依赖人工巡检，预警能力低，无法做到全方位监测，一旦发生事故后果不堪设想。

‘智慧矿山’是指利用人工智能、工业互联网信息技术、以及自动控制等现代技术来开发利用煤矿，使得各个系统充分融合，能够全面感知，包括能够自适应地自主学习，实现整个煤矿的开拓、采掘、通风、洗选、安全保障、运输各个环节的智能化、自动化运行。

解决方案如下：智慧矿山可视化管理系统建设，融合5G、大数据、视频、云计算、AI、融合通信等前沿技术应用，将信息、技术、设备与矿山管理需求有机结合，覆盖安监生产、综合集控、智能巡检、经营管理、智能掘进、智能开采、智能运输等多个业务领域。赋能用户业务应用，实现‘智能感知、智能观测、智能处置、智能告警、智能改进’，有效提升跨部门决策和资源协调效率。

客户成就方面，首先可以做到：矿井减员，提升作业安全性，提高运维效率，实时掌握生产流程、提高可控性，科学制定生产计划、简化线下流程，从而提升员工的工作效率；其次可以做到：安全保障，管理升级。对人员、设备等进行准确管控，实时保障现场环境安全性，提升工人生命安全，提升设备稳定性，保障信息安全。统一云运维和云管平台，实现云安全防护，提升系统安全性和硬件安全性。

业务场景二是智慧电厂业务场景，项目背景是这样的：电厂作业环境复杂，风险因素较多，易发生安全事故，且发生安全事故的后果严重、损失巨大。输煤栈桥、升压站、配电室等都是重点巡视区域，对关键区域不间断进行巡检，受到人员责任心和技术水平的制约，容易出现设备漏检的情况，存在安全隐患。借助信息化、自动化的技术手段，提供智能巡检工作方式，实时自动巡检运行设备，做到‘早发现、早处理’，提高运行人员对设备缺陷的识别能力和预见性。

解决方案是这样的：融合运用可见光、热成像、智能巡检、云平台、大数据等先进技术，对电厂内输煤栈桥、升压站、煤场、配电室等场景进行全面巡检，降低人工成本。提高管理者对现场各个场景、人员的可视化管理能力。可导出巡检报表，进行对比分析。现场变化一目了然，报表记录防范未然。

客户成就包括精细化运营和提升管控安全可靠性方面。精细化运营是指，提高运维效率，实时掌握生产流程、提高可控性，科学制定生产计划、从而提升员工的工作效率。提升管控安全可靠性包括人员安全方面和设备安全方面，人员安全方面可以通过机器人等技术，大大减少高危作业，设备安全方面可以通过智能传感器等，实时追踪设备状态，全面了解关键部件的健康状况，并对存在风险的设备进行预警。

# 智能巡检机器人产品宣传手册

创新/专注/超越 科技赋能世界，守护企业安全 智能/安全/高效
联系方式：
小马机器人有限公司（LITTLE HOTER ROBOT Co. LTD）
地址：江西省南昌小蓝经济技术开发区小蓝中大道346号尚荣产业园11栋
邮箱：<littlehorse@xmrobot.com.cn>
网站：www.techxiaoma.com
电话：400-926-2660

公司简介如下：小马机器人有限公司位于小蓝经济技术开发区，研发团队由中科院博士领衔组建，公司基于机器人、大数据、物联网、人工智能等新技术，在电力、交通、矿山、林业等行业领域，与清华大学、南昌大学等国内知名高校建立战略合作，推动产业技术革新。公司秉承‘专业、精细、特色、新颖ying’的理念，获评‘2023年度江西省专精特新企业’，是EPTC机器人委员单位、以及参与制定巡检机器人的行业标准单位。

业务范围涵盖电厂Power plant、电力Electricity、交通Transportation、教育Education、铁路Railway、煤矿Coal mines、林业Forestry、医疗Medical treatment。公司资质及检测报告包括：国家高新技术企业、双软企业认证、CMMI3 Maturity Level3、机器人通过电科院开普检测；MW-200集中型机器人通过武高所检测，最早入围国网的机器人单位之一。

还有ISO质量管理体系认证、ISO环境管理体系认证、ISO职业健康安全管理体系认证、EPTC电力机器人专家工作委员会委员单位、中国国际贸易促进会电力行业委员会单位、江西省机器人与智能制造装备产业联合会单位。

输煤栈桥机器人MG400C的壳ke体采用迷宫槽+密封垫圈的结构设计，具备防水、防尘功能。另外，机器人具备较小的拐弯半径，较大的爬坡角度，具备一定的跨层能力。技术参数包括：尺寸大小460mm *390mm* 455mm，续航时间为8小时，爬坡能力为60度，充电时间小于3h，最大探伤速度为1m/s，总重量为35kg。支持无线充电，红外测温精度±2℃，定位精度±5㎜，支持红外测温、撕裂、跑偏、AI识别如开关/指示灯/缺陷/装置屏。

智能联动，如皮带、气体、温度；支持第三方系统接入，如DCS。

系统架构包括智慧决策、智慧应用、技术支撑、边缘设备。智慧决策涵盖经营决策、安全决策、生产决策、检修决策、绩效决策。智慧应用为输煤栈桥智能巡视一体化平台，其中的人员安全巡检模块包括的功能有实时定位、人员统计、历史轨迹、预设任务、厂区出入、电子围栏、穿戴规范、操作违规；设备、物料巡检模块包括的功能有皮带撕裂跑偏、煤监检测、撒煤漏煤、指针数字表计、电机震动温度、管道跑冒滴漏、煤流偏斜、漏煤桶堵塞se。

环境巡检包括火情监测、烟雾监测、声音监测、温湿度、PM2.5/PM10、H2、CO/CO2、CH4。技术支撑包括人工智能算法、物联传感、边缘计算、远程管控。边缘设备有无线网络（5G/可信WIFI）、有线网络、安全模块/交换机/防火墙，以及输煤栈桥轨道巡检机器人、特种传感器、智能穿戴设备、摄像机、智能远程监控。

跑冒滴漏、指示灯识别、设备测温、煤流量检测、粉尘浓度检测，是输煤栈桥机器人MG400C的几个主要模块。

随着工业基础建设不断完善，机器人的用途也在不断拓展。输煤栈桥机器人主要用于矿厂、隧道、综合管廊等场景。目前基于人工方式排查缺陷难度大、需要投入人力多、工作环境差、巡检环境差、巡检效率低，制约了设备异常、缺陷、故障的早期识别及预警，降低了设备的可靠性。AI安全管控平台以‘智能、安全、高质、高效’为设计理念，融合了智能感知、自主巡视、AI识别、红外测温、环境检测语音对讲、声光告警等功能。

室外巡检机器人MW200B采用视觉定位、激光雷达定位、里程计融合定位技术，使机器人在巡视过程中能精准定位和自主导航，可适应室内环境、室外环境、恶劣天气、及复杂地形中稳定工作。此外，机器人采用了模块化设计，功能和性能可以更灵活地扩展和提升，从而满足不同场景和任务的需求。技术参数有：尺寸大小876㎜ *654㎜* 873㎜、8小时续航、爬坡能力20度、充电时间小于3h、最大探伤速度1m/s、总重量≤80kg。

防水等级IP65、红外测温精度±2℃；视觉360影像技术，双向语音对讲；识别误差率＜5%、多传感器融合技术，定位精度±10㎜；支持第三方系统接入，如智能巡检系统。

MW200B可以做到表计识别、单闸分合识别、分合指示识别、油位识别、红外测温。通过在现场部署巡检机器人，进行全方位、多角度、高频次巡检，实现对室外、室内设备进行探测、监控、故障诊断、和预警，并将巡检数据结构化存储，通过数据分析进行预测性防护，实现自主巡视、调度运行、二次确认、风险预警、和故障追踪，保障设备的安全可靠运行，在降低综合运营成本的同时，提高先进运营水平。

室内巡检机器人MN300通过四轴机械臂，可灵活的调整云台高度，实现不同角度的检测需求，具备高效、智能、安全等特点，大大提高巡检的效率和安全性。技术参数有：尺寸大小740㎜ *520㎜* 863㎜、8小时续航、爬坡能力10度、充电时间小于3h、最大探伤速度1.2m/s、总重量60kg。红外测温精度±2℃，360度旋转臂，支持红外测温、局放、声纹、AI识别开关/指示灯/缺陷/装置屏，多传感器融合技术，定位精度±10㎜，支持第三方系统接入，如智能巡检系统。

室内巡检机器人MN300是针对室内开关柜、配电柜等屏柜的室内巡检设备。通过机器人和人工智能技术的结合，对柜体的开关指示灯、压板、旋钮、LED指示灯等，进行有效巡检。机器人为可移动形式，集成激光雷达、热成像可见光相机（超声波、地电波、特高频）、超声波传感器、语音系统、无线天线等部件。机器人本体是差速运动结构，摄像头等部件固定在机械臂上，可满足室内各种尺寸屏柜的检测需求。

室外巡检机器人MW200采用小型化设计，配置全向移动驱动结构，可适配现场各种复杂环境下不同巡视需求，在狭窄环境下具备良好的通过性。技术参数有：尺寸大小585㎜ *495㎜* 650㎜、8小时续航、爬坡能力20度、充电时间小于3h、最大探伤速度1.2m/s、总重量45kg。防水等级IP65，红外测温精度±2℃，四轮八驱全向移动，识别误差率<5%，多传感器融合技术，定位精度±10㎜，支持第三方系统接入，如智能巡检系统。

随着工业化进程的不断发展，设备巡检需求不断提高，智能化巡检逐渐被提上日程。利用先进的机器人和自动化技术，实现对室外环境、设施设备等进行高效、准确、安全的巡检。解决传统室外巡检存在的问题，提高了巡检效率、安全性、和数据采集能力，通过配备气象传感器、摄像头、和机器人设备，结合智能AI算法对现场各类设备、人员行为、基础设施进行采集，由算法分析服务器进行状态、开关量、表计等类型分析，如发现异常立刻后台告警处理，提升对无人值守变电站的现场管控能力。

室内轨道巡检机器人MG400A替代人工，实现无人值守巡检检测工作，其优势在于可以自动完成各类设备的运行状况巡检，巡检过程无需人工参与，全天后7 *24小时工作，不受环境危险恶劣因素影响，完成巡检工作，从而达到高效巡检工作。技术参数有：尺寸大小344㎜* 234㎜ * 882㎜、24小时续航、升降范围0到1500mm、充电时间小于3h、最大探伤速度1m/s、总重量25kg。防水等级IP54，升降高度2m，升降精度±10mm，最小拐弯半径0.3m。

定位精度±1mm；滑触线供电，电力载波通讯；支持第三方系统接入，如智能巡视系统。

当今电力行业处于蓬勃发展时期，大量变电站/配电室投产使得人力资源日趋紧张，无人值守模式的发展，也需要智能巡检工具的产生。特别是在高压、超高压、以及复杂环境下，人工巡检存在一定风险性。室内空间过于狭窄，室内轮式机器人无法运行时，可采用轨道巡检机器人完成巡检作业。搭载多种传感器，如可见光、热成像、局放、气体等。可实现对设备、环境进行综合检测，巡检完成后，自动生成巡检报表，及时反馈设备运行和环境等情况。

# 轮式机器人

## components/WheeledMapSet

WheeledMapSetProps：默认的当前任务颜色、默认的当前任务已完成部分点线的颜色、默认的模板颜色、默认的鼠标选中颜色、默认的提示颜色、默认的选中颜色、默认的添加路径颜色、默认的已重复点线的颜色、

默认的已重复已完成部分点线的颜色、默认的轨迹回放颜色、默认的校正颜色、默认的点位半径、默认的线宽、校正范围；小车图片地址、图片宽度、图片高度；

小车实时位置carPosition、allPoints所有导航点、地图容器mapWrapper、地图图片、当前是否为删除状态、添加点位状态、校正状态、重定位状态

地图选点的框选开关，默认的mousedown、MouseMove处理的是页面的拖动；
添加检修区域开关，默认的mousedown、MouseMove处理的是页面的拖动；

右键菜单、是否展示右键菜单；未缩放点位数据,初始数据转换后的未经过 scaleRatio 缩放的数据；是否在绘制矩形，绘制矩形时禁止缩放；图片原始宽高；事件监听器是否挂载完成；

缩放相关：canvas缩放比例、追踪缩放比例state。

上一次canvas缩放的比例、缩放中心点、鼠标点击位置

# app.js

app.js是运行时的配置文件，可以在这里扩展运行时的能力，比如修改路由、修改render、qiankun方法等等。

8G运行内存的台式电脑到底是哪里卡呢？

# luanping

图片不显示：先在浏览器访问<https://guard.xiaoma.com，类似的网址，并登录好。>

控制台的WebSocket connection failed频繁报错。

切换主题需求，已经无需啥设计了。点位point positions；没写完代码之前，不开启nodejs，8G内存的电脑就一点也不卡。

progressbar&slider；vsc启动nodejs终端会特别卡。

页面结构和代码结构不一样；

# swagger

调试时，要严格按照接口格式来做，这样才能以最快速度以较高完成度完成好需求。

把form.getFieldsValue()写在render里面去做表单项的分组显示与隐藏，还做不到！！

ids传入数组时，为啥还删除失败？（只做逻辑删除，没做物理删除）

添加基本通信协议的配置时，为啥配置方案是‘05020205’，增强型通信协议？？

一键告警功能的实现；分页搜索功能UI的调整、以及添加两个查询参数（取不到values？一直为{}？？）

# rc-slider

压`import 'rc-slider/assets/index.css`

# 切换两套主题

# svg颜色和大小可定制

# 关闭360就没那么卡了吧

# eslint

`./node_modules/.bin/eslint src --fix`

# public-images & src/assets/images

# 400c

计划在2024年做好一个版本出来。

## config-config.ts

包含umi内置功能和插件的配置

proxy-stateGridApi、sdk本地222-端口号9999服务器、api-端口号8085guard-150服务器；define：process.env.FTP_SOURCE_STATIC xllssctb.xiaoma.com/ftp /WS_STREAM服务器视频流wss://192.168.0.222:8085/stateGridSafe /WS_SERVER /api/ ws://xllsctb.xiaoma.com:8085/guard

## config-routes.ts

路由配置

BlankLayout
home、login、SecurityLayout/BaseLayout: overview-UserList,historyinfo/:id-HistoryInfo,task-conf/:id-TaskConf-/task-conf/0，task-browse/:id-TaskBrowse,task-browser-/task-browse/0,thermal-ThermalControl、manage/:id-Manage,robot-control/:id-RobotControl,analysis-Analysis,home-Home,system-manage/:id-SystemConf,

device-contact/:id-DeviceContact,intel-analysis/:id-IntelAnalysis.

3D地图相关：threedMap(Three-dimensional map)-ThreeMap、监控大厅monitoring-hall/:id-MonitoringHall

## mock

存储mock文件，此目录下所有js和ts文件会被解析为mock文件

## public

model-robot，bin和gltf文件，-trackObj.obj；

static-jsmpeg.min.js

## server

### app.js

express（app）、express-ws、router

### package.json

dep-express，express-ws，moment，ws，private：true；start-node app.js，liscense-ISC。

### random.js

CreateBezierPoints(anchorpoints贝塞尔基点, pointsAmount生成的点数)

### readme.md

后台服务驱动three.js创建的3D图形实时运动

### router.js

## package.json

scripts-start、node14-start、build、report、postinstall、lang、test、test:coverage,lint:prettier,prettier,prettier,lint:fix,lint:js,lint:style,lint-staged,lint-staged:js.

deps:@ant-design/icons,pro-card,pro-descriptions,pro-layout,pro-table;@react-spring/three,@react-three/cannon,drei,fiber,postprocessing;@topology/activity-diagram,chart-diagram,class-diagram,core,flow-diagram,sequence-diagram,svg;

@typescript-eslint/eslint-plugin,parser;@uiw/react-md-editor;@umijs/plugin-qiankun,preset-react,test;@xiaoma/three-track;antd;bizcharts;classnames;dayjs;echarts;eslint-plugin-react;exceljs;flv.js;lodash;meshline;postgrogressing;qs;react;react-color;react-dev-inspector;react-dom;react-markdown;

react-promise-suspense;react-three-fiber;react-three-gui;recordrtc;remark-gfm;styled-components;three;umi;use-deep-compare-effect;xlsx;xm12js;yorkie;zustand

devDependencies:@types/lodash,qs,styled-components,three;@umijs/fabric;antd-dayjs-webpack-plugin;check-prettier;cross-env;eslint;lint-staged;
运行时配置文件，可以在这里扩展运行时的能力，js;prettier;resize-observer-polyfill;style-resources-loader;stylint.

__npminstall_done,husky/hooks/pre-commit;lint-staged.

## JSMpeg.d.ts

declare let JSMpeg: any

## tsconfig.json

compilerOptions...
include...

## src

### app.ts

运行时配置文件，可以在这里扩展运行时的能力，比如修改路由、修改render、qiankun方法等。

langs、qiankun、rem-setRootFontSize、dvaInitialState、

### @core

usePointerClick、useThreedmapSize、useWindowSize

### @types

window.d.ts-getTargetName,init

### api

role:user:globa,taskBrowse,point,manage,export,taskEdit,historyInfo,camera,analysis,tools,robot,wiringDiagram,room,linkage,intelligent

camera：摄像头列表、静默点位设置、抓拍、拍照、位置信息查询、云台位置控制、控制云台运动、摄像头抓拍查询集合、获取摄像头抓拍信息、批量删除；

摄像头状态、摄像头图像参数、摄像头图像参数设置焦距-设置亮度-设置曝光-设置对比度、摄像头设备区域、摄像头设备间隔、摄像头设备类型、获取摄像头树、获取摄像头树、设置预置点（两个）、获取预置点列表、摄像头开始录像、摄像头结束录像、视频录像列表、摄像头抓拍、摄像头录像状态、静默监视数据、静默监视导出、告警确认、摄像头Id查询点位、修改静默状态、安防告警、安防导出。

export：点位管理-全部或选中导出，任务结果-选中导出、日志选中导出、点位模板-选中或全部导出、智能联动-选中或全部导出。

global：枚举接口、获取指定识别类型下的选择、标注类型、获取上传的地图的地址、根据片区id获取地图数据、获取上传的地图的地址、更新地图设备json、获取上传的地图的地址、根据地图id获取地图信息、获取皮带撕裂报警信息、环境告警信息、机器人告警信息、任务告警信息、皮带告警信息、已读告警信息、任务告警确认、获取皮带撕裂装置数量、点位右键菜单处理操作。

媒体中心右键菜单处理操作、开启或关闭语音告警、首页点位告警信息、首页联动手动切换、视频流接口。

historyInfo: 实时巡检历史信息列表查询、首页实时巡检历史信息列表查询、任务结果选中导出、任务结果选项导出、点位告警历史信息、环境告警历史信息、皮带告警历史信息、点位告警导出、皮带告警导出、点位结果历史信息、点位结果导出。

intelligent：根据名称查询点位、根据名称查询任务、数据分析ECharts结果。

linkage：智能联动列表查询、智能联动列表删除、智能联动保存、智能联动修改、联动任务详情、联动结果列表、联动摄像头列表。

manage：装置列表查询、摄像头添加、摄像头擦除、修改装置管理、修改装置管理数据回显、查看控制权限、获取摄像头权限、测试连接装置。

point：获取点位树、获取楼层数据；通过楼层获取区域、设备、摄像头数据（分为三个子接口）；获取区域列表、获取设备列表、根据id查询相关的三相点位；根据id查询相关的点位信息；点位信息分页查询；点位信息不分页查询；点位添加；点位部署；点位标注；识别测试；根据ids删除点位信息；根据id修改点位信息；根据id清空点位阈值；根据id修改点位阈值；台账导入接口。

- ptz云台PTZ
云台绝对运动、云台相对运动、获取云台位置、云台停止、获取摄像头位置信息、抓拍、行走到此接口。
- 获取所有环境阈值
获取环境阈值、修改环境阈值、清空环境阈值。

robot：获取机器人任务列表。

role：角色权限树、角色权。

room：保存片区、删除片区、获取片区列表、托辊专项检测。

taskBrowse：任务列表分页查询-展示所有任务状态；任务列表查询-展示已完成的任务状态、首页当日任务统计信息、首页当日任务列表、任务列表查询-所有不分页、根据任务查询点位结果详情、审核数据查询、结果审核、任务删除、根据id获取任务详情、任务审核、任务结果全部导出、当日任务列表全部删除。

taskEdit：任务模板列表分页查询、任务添加、任务模板修改、任务模板删除、任务立即执行、任务定期执行、任务周期执行、任务暂停、任务继续、任务中止、获取设备区域、获取设备间隔、获取设备类型、参数查询点位树、任务模板添加、任务模板编辑。

tool：统一导出数量查询、综合报表合并导出、综合报表分别导出、导出记录分页查询。

user：获取用户列表不分页、用户添加、用户修改、用户删除、用户登录、用户退出、用户日志、重置密码、清除所有数据。

wiringDiagram：获取接线图设备树、保存接线图JSON、接线图列表分页、请求特定接线图数据、删除特定接线图数据。

### global.less

@import ~@/assets/css/global, @font-face wgsFont,ds-digi-webfont；

### assets

静态资源

#### css-theme

define.less,lightColor.less,

body[theme='defined or lightColor']

#### css

define.less,global.less,overrideAntd.less,select.less

#### images

camera,demo,global,home,login,new,robot,svg,system,task,three,tool,wiringDiagram

#### md-wiringDiagramREADME.md

快捷键说明：
空格+鼠标拖拽：移动画布；鼠标右键拖拽：移动画布；Ctrl+滚轮：缩放画布；Ctrl+点击Pen 多选；Ctrl+A 全选、C、X、V、Z、Y或Shift+Z重做。V：钢笔绘画；B：铅笔绘画；Enter 画线中，完成画线；选中线 闭合连线；Escape 完成画线或退出其他模式；方向键 移动选中图形（Ctrl移动1像素；Shift移动5像素；默认移动10像素）；H 选中连线锚点时，添加手柄；D 选中连线锚点时，删除手柄；

A 选中Pen时，添加锚点；Alt 选中Pen时拖拽时，只能水平拖拽；G 鼠标移入节点锚点后，按下G进入移动锚点状态，鼠标按下拖拽或方向键，都可以移动；Delete或Backspace，删除选中节点；M 放大镜开关；Ctrl+拖拽节点四个角（resize），等比resize节点；连线连接时，按下alt合并成一条连线，丢失另外一条的属性和样式；选中线，移入线锚点，按下S -- 切割连线，成为两条连线。

### components公共组件目录

#### 3DMap

three-track ThreeController(mapContainer.current,pathInfoList,{robotModelUrl:'/model/robot/MW-200.gltf',trackModelUrl:'/model/trackObj.obj',cameInfo{position,target:{x,y,z},zoom:1}})

pathInfo.ts-path,position,position,place,length。

#### AdjustSize

参数为visibleLIghtId、isSetFocus、mode、title、originSize、max、min、unit、handleSizeChange、nowCameraId、nowCameraName

#### AlarmModal

BeltAlarmModal皮带撕裂报警=设备名、识别时间；ElseAlarmModal；cpn-OuterToolTable、BeltAlarmList、EnvironmentAlarmList、ImageCarousel、ImageCpn、RobotAlarmList、SilentAlarmList、TaskAlarmList、

#### Annotatioin-images

#### Authorized

AuthorizedRoute、CheckPermissions、Secured、NoMatch、PromiseRender、renderAuthorize、Secured

#### Calendar

#### CameraControlTable

#### CameraPreview

CameraPreviewProps-cameraInfo、robotInfo、videoListIndex、handleClose、showToolBar、showVisibleLight

#### CircleProgress

#### ColorPicker

connect-wiringDiagramState

#### ConfirmRollerModal

托辊专项检测-托辊任务；A皮带托辊巡检、B皮带托辊巡检、AB皮带托辊巡检；

#### ConfirmModal

#### DatePicker

#### DoubleConfirm

#### DrawButton

同步

#### EchartsEnvironment

Props：value、name、threshold-warning、general、serious、crisis

#### EchartsEnvironmentModal

props：modalVisible、setModalVisible、echartsEnvironmentModalData（{environmentData,environmentalThreshold}）;environmentDataProps:{co,ch4,nh3,h2s,dust,smoke,temperature,humidity};environmentalThresholdProps环境阈值:{createTime,creator,updateTime,updator,id,roomId,robotId,value,label,warning,general,serious,crisis,threeContrast,normalState}

value: 'temperature'|'smoke'|'ch4'|'humidity'|'dust'|'nh3'|'h2s'|'co';label:'温度'|'烟雾浓度'|'甲烷浓度'|'湿度'|'粉尘浓度'|'氨气浓度'|'硫化氢浓度'|'一氧化氮浓度'

#### ExcelModule

Props：config、ResetReload，EXCELMAP:车牌plateNumber、用户名carrierName、出入类型accessTypeName、出入时间accessTime；请先下载模板

#### ExportImageModal

styled基座容器，window?.getTargetName('global', 'warning/normal,selectAll)

#### StyleComp

样式组件集合css in js

### layouts

全局布局

### models

### pages

页面模板目录

### services

### utils

项目公用JS模块，如request.ts、util.ts

# 输煤皮带巡视系统说明书V1.0

# luanping

给客户定制，192.168.0.150；用ftp服务器上传到远程后，用https协议访问<https://400c.xiaoma.com> 或 <https://400c.fe.xiaoma.com>

## apiset

createAsyncRequest from @/api/fetch

analysis：对比分析-点位对比、对比分析-点位对比（数据图）；

camera：摄像头列表、静默点位设置；可见光远程控制：抓拍、控制云台运动、摄像头抓拍查询集合、获取摄像头抓拍信息、批量删除、摄像头状态、摄像头-图像参数、-图像参数设置焦距、-设置曝光、设置对比度、-设备区域、-设备间隔、-设备类型、-获取摄像头树、设置预置点、获取预置点列表、摄像头开始录像、摄像头结束录像、视频录像列表、摄像头抓拍、摄像头录像状态、静默监视数据、摄像头Id查询点位、修改静默状态；

export：exporter、intelligent-linkage 点位管理全部导出或选中导出；任务结果 选中导出；日志选中导出、点位模板选中或全部导出；智能联动选中或全部导出；

global：枚举接口、获取指定识别类型下的选择

**npm config set registry <http://registry.npmmirror.com>**

# APP开发

打开USB调试模式的步骤可能因手机品牌和型号的不同而有所差异。以下是详细介绍：

对于大多数安卓手机，包括红米K50至尊版，通常需要进入“设置”，点击“我的设备”或“关于手机”，然后连续点击“版本号”或“MIUI版本”几次（具体次数可能因品牌和型号而异，通常为4~7次），直到提示已进入开发者模式。返回上一级菜单，找到“开发者选项”并进入，然后在其中找到并启用“USB调试”。12345
对于特定品牌的手机（如华为、小米、三星、OPPO、vivo等），可能需要进入“设置”，点击“关于手机”，然后连续点击“版本号”或“软件信息”几次，返回上一级菜单，找到并进入“开发者选项”，最后启用“USB调试”。5
对于使用特定开发工具（如Android Studio或Xcode）的用户，在连接手机时，开发工具可能会自动打开USB调试模式。3
此外，对于iPhone设备，需要使用Lightning数据线将iPhone连接到Mac电脑，通过相应的用户界面来启用USB调试。4

 npm install --registry=<http://registry.npmmirror.com>

<https://github.com/facebook/react-native/issues/23516>

distributionUrl:<https://github.com/facebook/react-native/issues/23516>

我的华为手机需要在设置搜索栏，搜索‘调试’

ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.

Please set the JAVA_HOME variable in your environment to match the
location of your Java installation.

Error: Command failed with exit code 1: adb shell am start -n com.awesomeproject2/com.awesomeproject2.MainActivity -a android.intent.action.MAIN -c android.intent.category.LAUNCHER
    at makeError (C:\Users\Administrator\projects\AwesomeProject2\node_modules\execa\lib\error.js:60:11)
    at module.exports.sync (C:\Users\Administrator\projects\AwesomeProject2\node_modules\execa\index.js:194:17)
    at tryLaunchAppOnDevice (C:\Users\Administrator\projects\AwesomeProject2\node_modules\@react-native-community\cli-platform-android\build\commands\runAndroid\tryLaunchAppOnDevice.js:52:22)
    at C:\Users\Administrator\projects\AwesomeProject2\node_modules\@react-native-community\cli-platform-android\build\commands\runAndroid\runOnAllDevices.js:93:39
    at Array.forEach (<anonymous>)
    at runOnAllDevices (C:\Users\Administrator\projects\AwesomeProject2\node_modules\@react-native-community\cli-platform-android\build\commands\runAndroid\runOnAllDevices.js:88:48)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async Command.handleAction (C:\Users\Administrator\projects\AwesomeProject2\node_modules\@react-native-community\cli\build\index.js:118:9)

## adb device 命令未找到

<https://blog.csdn.net/cgwcgw_/article/details/23651709>
adb reverse tcp:8081 tcp:8081

## adb.exe: error: no devices/emulators found

连上手机后还没有选择传输文件选项，导致的该问题。
<https://stackoverflow.com/questions/10705089/how-to-fix-error-device-not-found-with-adb-exe>

Try any of the following solutions. I get errors with adb every now and then. And one of the following always works.

Solution 1
Open command prompt as administrator and enter

adb kill-server
adb start-server

## nvm

cmd or PowerShell才能用nvm。
14.21.3 18.19.1

## npx react-native start --port 9988

React Native needs Node.js >= 18. You're currently on version v14.21.3. Please upgrade Node.js to a supported version and try again.

## rn-run-on-device

npx react-native run-android

**double tap R**.

## expo

译注：沙盒环境大量依赖于国外网络环境，也不能直接安装第三方原生组件。不建议国内用户使用

<https://www.zhihu.com/question/303934062>
exp://192...
"start": "expo start --port 19001"
需要配置全局的代理，而非自动类型。
EXPO_OFFLINE=1 --tunnel --port 19001

CommandError: Network connection is unreliable. Try again with the environment variable `EXPO_OFFLINE=1` to skip network requests.

<https://www.volcengine.com/theme/7728705-S-7-1>

<https://shijianchuo.net/question/53074570.html>
<https://github.com/expo/expo-cli/issues/134>

### start the emulator manually

Error: The emulator (INFO    | Storing crashdata in: C:\Users\Administrator\AppData\Local\Temp\\AndroidEmulator\emu-crash-34.1.19.db, detection is enabled for process: 8656) quit before it finished opening. You can try starting the emulator manually from the terminal with: C:\Users\Administrator\AppData\Local\Android\Sdk/emulator/emulator @INFO    | Storing crashdata in: C:\Users\Administrator\AppData\Local\Temp\\AndroidEmulator\emu-crash-34.1.19.db, detection is enabled for process: 8656
    at stopWaitingAndReject (C:\Users\Administrator\projects\openMind\node_modules\@expo\cli\build\src\start\platforms\android\emulator.js:110:20)
    at ChildProcess.<anonymous> (C:\Users\Administrator\projects\openMind\node_modules\@expo\cli\build\src\start\platforms\android\emulator.js:121:13)
    at ChildProcess.emit (node:events:517:28)
    at ChildProcess._handle.onexit (node:internal/child_process:292:12)

<https://github.com/react-native-community/cli/issues/1801>
<https://stackoverflow.com/questions/43593042/network-response-time-out-error-create-react-native-app-expo>

<https://www.volcengine.com/theme/8362564-E-7-1>

## adb

device_name MAR_AL00(adb devices)

## getPtzPos -云台信息

error：502 or 400

## 标注的背景图

<https://400c.fe.xiaoma.com/ftp/resource/media/video/tmp/65/20240322100352.jpegshumei>

## gradle

info Opening the app on Android...
info JS server already running.

info 💡 Tip: Make sure that you have set up your development environment correctly, by running react-native doctor. To read more about doctor command visit: <https://github.com/react-native-community/cli/blob/main/packages/cli-doctor/README.md#doctor>

Exception in thread "main" java.io.IOException: Downloading from <https://services.gradle.org/distributions/gradle-8.0.1-all.zip> failed: timeout (10000ms)
        at org.gradle.wrapper.Download.downloadInternal(Download.java:131)
        at org.gradle.wrapper.Download.download(Download.java:89)
        at org.gradle.wrapper.Install$1.call(Install.java:83)
        at org.gradle.wrapper.Install$1.call(Install.java:63)
        at org.gradle.wrapper.ExclusiveFileAccessManager.access(ExclusiveFileAccessManager.java:69)
        at org.gradle.wrapper.Install.createDist(Install.java:63)
        at org.gradle.wrapper.WrapperExecutor.execute(WrapperExecutor.java:109)
        at org.gradle.wrapper.GradleWrapperMain.main(GradleWrapperMain.java:66)
Caused by: java.net.SocketTimeoutException: Read timed out
        at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:288)
        at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:314)
        at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
        at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
        at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
        at java.base/sun.security.ssl.SSLSocketInputRecord.read(SSLSocketInputRecord.java:484)
        at java.base/sun.security.ssl.SSLSocketInputRecord.readFully(SSLSocketInputRecord.java:467)
        at java.base/sun.security.ssl.SSLSocketInputRecord.decodeInputRecord(SSLSocketInputRecord.java:243)
        at java.base/sun.security.ssl.SSLSocketInputRecord.decode(SSLSocketInputRecord.java:181)
        at java.base/sun.security.ssl.SSLTransport.decode(SSLTransport.java:111)
        at java.base/sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1509)
        at java.base/sun.security.ssl.SSLSocketImpl.readApplicationRecord(SSLSocketImpl.java:1480)
        at java.base/sun.security.ssl.SSLSocketImpl$AppInputStream.read(SSLSocketImpl.java:1065)
        at java.base/java.io.BufferedInputStream.read1(BufferedInputStream.java:282)
        at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:343)
        at java.base/sun.net.www.MeteredStream.read(MeteredStream.java:141)
        at java.base/java.io.FilterInputStream.read(FilterInputStream.java:132)
        at java.base/sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read(HttpURLConnection.java:3682)
        at java.base/sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read(HttpURLConnection.java:3675)
        at org.gradle.wrapper.Download.downloadInternal(Download.java:115)
        ... 7 more
Done in 159.04s.

### build-tools

versions:34.0.0,29.0.1,33.0.1
react-native-reanimated <https://github.com/software-mansion/react-native-reanimated/issues/1798#issuecomment-796914997>

## metro

一次只能安装一个react-native APP。并且底层是nodejs-rn终端程序，单开一个窗口。

 yarn start --reset-cache

historyPush-useNavigation,useRoute-useContext-invalid hook call at the top level.

*other js errors*会导致Metro报错：

*js engine: hermes
 LOG  Running "Xiaomarobot" with {"rootTag":101}
 ERROR  Invariant Violation: "Xiaomarobot" has not been registered. This can happen if:

- Metro (the local dev server) is run from the wrong folder. Check if Metro is running, stop it and restart it in the current project.
- A module failed to load due to an error and `AppRegistry.registerComponent` wasn't called., js engine: hermes*

## excellent-react-native-app

<https://github.com/togayther/react-native-cnblogs/blob/master/package.json> <https://github.com/fbsamples/f8app/blob/main/scripts/run-android-app.sh> <https://github.com/gitpoint/git-point/tree/master/scripts>

网络上很多代码都停止更新了，所以直接自己写app所有的源码就好了，当然遇到问题的话，可以适当地参考一些其他项目的做法。

Xiaomarobot-xiaomarobot

## 端口号

<https://blog.csdn.net/weixin_43233914/article/details/123677543>

## UI

<https://juejin.cn/post/7170606687835914271>

## taro

未来有没有可能在各种小程序里面，或者多端的APP里面用？

## umi,dva,react-redux,store,models

<https://github.com/xuyuanxiang/UMIRNExample/blob/master/package.json>
umi v3时才能使用好umi g rn

umi command not found: <https://blog.csdn.net/qq_40593656/article/details/120720830>

## App.tsx

```tsx
/**
 * Sample React Native App
 * https://github.com/facebook/react-native
 *
 * @format
 */
import * as React from 'react';
import "react-native-gesture-handler";
import Home from "./src/navigation/navigation";
import type {PropsWithChildren} from 'react';
// import store from "./src/state-managment/store";
import {Provider as UIProvider} from '@ant-design/react-native'
import { Provider } from "react-redux";
import globalModel from './src/models/global'
// import { MD3LightTheme as DefaultTheme } from 'react-native-paper';

import {create} from 'dva-core-ts';

const models = [globalModel];

const app = create();

models.forEach((o) => {
  // 装载models对象
  app.model(o);
});

app.start(); // 实例初始化

const store = app._store; // 获取redux的store对象供react-redux使用

export default class App extends React.Component {
  // const theme = {
  //   ...DefaultTheme,
  //   colors: {
  //     ...DefaultTheme.colors,
  //     // Change the primary color of the app here at just one place.
  //     primary: '#265CDF',
  //   },
  // };

  // please check developer mode in navigation.js before continuing.
  render() {

    return (
      <Provider store={store}>
          <Home />
      </Provider>
    );
  }
}

```

warn Package @ant-design/react-native contains invalid configuration: "dependency.assets" is not allowed. Please verify it's properly linked using "npx react-native config" command and contact the package maintainers about this.
Execution failed for task ':react-native-screens:configureCMakeDebug[arm64-v8a]'.
> [CXX1300] CMake '3.22.1' was not found in SDK, PATH, or by cmake.dir property.

Execution failed for task ':app:installDebug'.
> java.util.concurrent.ExecutionException: com.android.builder.testing.api.DeviceException: com.android.ddmlib.InstallException
<https://stackoverflow.com/questions/37500205/react-native-appinstalldebug-failed>

<https://xllsctb.xiaoma.com/manage/2> 部署标注；

远程监控功能：历史信息-实时巡检信息，静默的含义呢？；故障结果是告警历史信息，有两种。机器人的基本信息状态在站端，巡检状态是在地图模块？

## 调试

<https://reactnative.cn/docs/debugging：`adb> shell input keyevent 82` R按键；

<https://reactnative.cn/docs/pixelratio>

## reducer

action can be any-type.

## 创建下载链接

## 国际化

getTargetName&global.js？完全弄懂并在APP上走通。

## navigation-route

Error: Couldn't find a navigation object. Is your component inside NavigationContainer?

## // @ts-ignore:next-line

adb shell input keyevent 82
adb shell input keyevent 82
adb shell input keyevent 82

loading.effects 需要安装umi才生效？只有dva的话不起作用。

UI图可以先设计好部署标注外的其他页面，我要开始一个个写了。

政樑，这个前端设计PDF是啥时候写的，谁写的，里面提到的问题解决了哪几个，怎么解决的，解决地怎么样了？

## inspector

摇动手机，show inspector选项：inspect、perf、network、touchables

### network

symbolicate

## Virtualization安卓虚拟机

@powershell -ExecutionPolicy RemoteSigned -Command "C:\Users\Administrator\Downloads\dgreadiness_v3.6.ps1 -Disable"
<https://blog.csdn.net/qq_24033983/article/details/123335806>

# dingtalk

Ctrl+shift+A：截图

# BIOS

F2、ESC、F10

# 夜神模拟器

nox_adb connect 127.0.0.1:62001

# 国际化

<https://github.com/ant-design/ant-design/blob/master/components/locale/en_US.ts>
<https://github.com/ant-design/ant-design-mobile-rn/blob/master/components/locale-provider/index.en-US.md>

# login

鉴权模块需完善。

# react-native-reanimated

drawer:babel.config.js

Value for message cannot be cast from ReadableNativeMap to String

Console Warning Possible unhandled promise reject(id:0) TypeError: Network requesdt failed

websocket??

<https://github.com/ant-design/ant-design-mobile-rn/issues/772>

# 权限

# TypeError: Array.prototype.reduce() requires an initial value with empty array

消息通知有两个svg，带红点的和不带红点的。
SectionList、

RobotTab LeftContainer怎么是空的。

# npx react-native-asset

react-native-video: <https://github.com/react-native-video/react-native-video/issues/1738>

# react-native-video

<https://blog.csdn.net/zcylyzhi4/article/details/110626269>

# EventEmitter & model-state

# 视频流重构

滦平和400C的视频流不一样
滦平：robotInfo、cameraInfo，两者都可以组合成streamInfo、robotVideoMessage；400C：videoCode

 Warning: Cannot update a component (`ForwardRef(BaseNavigationContainer)`) while rendering a different component (`Home`). To locate the bad setState() call inside `Home`, follow the stack trace as described in <https://react.dev/link/setstate-in-render>

setTimeout...

console.log replace Alert.alert

不要忽视key、style的任何error和warnings，要不然会渲染出错！！

svg图片不会包含背景颜色部分，所以应用有限;

Navigator不能放在View里面，需要放在Container里面。

useEffect everytime.

# Storage

ALL_ENUMS_LIST {"thresholdExceptionEnum":[{"name":"正常","value":"5"},{"name":"预警","value":"4"},{"name":"一般告警","value":"1"},{"name":"严重告警","value":"2"},{"name":"危急告警","value":"3"}],"taskTypeEnum":[{"name":"例行巡检","value":"1"},{"name":"全面巡检","value":"2"},{"name":"专项巡检","value":"3"},{"name":"特殊巡检","value":"4"},{"name":"自定义巡检","value":"5"}],"taskExecuteEnum":[{"name":"立即","value":"0"},{"name":"定时","value":"1"},{"name":"周期","value":"2"}],"pwdTypeEnum":[{"name":"弱密码","value":"1"},{"name":"中等密码","value":"2"},{"name":"强密码","value":"3"},{"name":"很强密码","value":"4"}],"alarmBusinessTypeEnum":[{"name":"默认","value":"107004"},{"name":"常规","value":"107005"},{"name":"安防","value":"107006"},{"name":"温震","value":"107007"}],"intellegentEnum":[{"name":"开启","value":"1"},{"name":"关闭","value":"0"}],"recognitionTypeEnum":[{"name":"油位计","value":"1"},{"name":"气压表","value":"2"},{"name":"油温表","value":"3"},{"name":"避雷器动作次数表","value":"4"},{"name":"泄漏电流表","value":"5"},{"name":"SF6压力表","value":"6"},{"name":"液压表","value":"7"},{"name":"开关动作次数表","value":"8"},{"name":"油流继电器表计","value":"9"},{"name":"一次设备状态","value":"10"},{"name":"分合指示器","value":"11"},{"name":"分合开关","value":"12"},{"name":"空气开关","value":"13"},{"name":"开关指示灯","value":"14"},{"name":"储能开关","value":"15"},{"name":"压板状态","value":"16"},{"name":"远方控制开关","value":"17"},{"name":"档位开关","value":"18"},{"name":"旋钮","value":"19"},{"name":"LED数字灯","value":"20"},{"name":"指示仪","value":"21"},{"name":"吸湿器","value":"22"},{"name":"局放超声波","value":"23"},{"name":"局放地电波","value":"24"},{"name":"红外识别","value":"26"},{"name":"高清照片","value":"27"},{"name":"开关旋钮","value":"28"},{"name":"旋钮_自动手动_3","value":"29"},{"name":"旋钮_自储手储_2","value":"30"},{"name":"旋钮_分闸合闸_2","value":"31"},{"name":"旋钮_远方就地_2","value":"32"},{"name":"旋钮_远方就地停止_3","value":"33"},{"name":"旋钮_调压开关","value":"34"},{"name":"旋钮_远方就地停止自投_4","value":"35"},{"name":"局放特高频","value":"36"},{"name":"环境监测","value":"37"},{"name":"皮带跑偏","value":"41"},{"name":"皮带启动","value":"42"},{"name":"皮带撕边","value":"43"},{"name":"人员入侵","value":"44"},{"name":"火点检测","value":"45"},{"name":"安全帽检测","value":"46"}],"linkageTypeEnum":[{"name":"主设备联动","value":"1"},{"name":"辅助设备联动","value":"2"},{"name":"顺控联动","value":"3"}],"cameraTypeEnum":[{"name":"双光谱摄像机","value":"0"},{"name":"球型摄像机","value":"1"},{"name":"高清型摄像机","value":"2"},{"name":"皮带撕裂摄像机","value":"3"}],"messageTypeEnum":[{"name":"回馈消息","value":"0"},{"name":"心跳","value":"1"},{"name":"实时信息","value":"2"},{"name":"系统异常","value":"3"},{"name":"一键返航路径","value":"4"},{"name":"预计路径","value":"5"},{"name":"完成路径","value":"6"},{"name":"机器人变更","value":"7"},{"name":"任务变更","value":"8"},{"name":"车体控制","value":"9"},{"name":"云台控制","value":"10"},{"name":"导航控制","value":"11"},{"name":"定位控制","value":"12"},{"name":"避障控制","value":"13"},{"name":"云台位置","value":"14"},{"name":"语音对讲","value":"15"},{"name":"设备模板","value":"16"},{"name":"环境模板","value":"17"},{"name":"获取焦点值","value":"18"},{"name":"热成拍图","value":"19"},{"name":"环境信息","value":"20"},{"name":"激光点云信息","value":"21"},{"name":"导航点，导航路径变更","value":"22"},{"name":"一键导航回调","value":"23"},{"name":"任务预计路径","value":"24"},{"name":"任务完成路径","value":"25"},{"name":"录音录像状态变更","value":"26"},{"name":"云台位置，焦点值获取","value":"27"},{"name":"视频流亮度读取","value":"28"},{"name":"获取补光灯的开关状态","value":"29"},{"name":"返回","value":"30"}],"sysRolePermissionsEnum":[{"name":"综合报表","value":"1"},{"name":"导出","value":"2"},{"name":"导入","value":"3"},{"name":"添加","value":"4"},{"name":"编辑","value":"5"},{"name":"删除","value":"6"},{"name":"同步","value":"7"},{"name":"阈值","value":"8"},{"name":"标注","value":"9"},{"name":"部署","value":"10"},{"name":"查看","value":"11"}],"eventSourceCodeEnum":[{"name":"无皮带启动","value":"0"},{"name":"A皮带启动","value":"1"},{"name":"B皮带启动","value":"2"},{"name":"AB皮带启动","value":"3"}],"linkageLevelAlarmGradeEnum":[{"name":"低","value":"1"},{"name":"中","value":"2"},{"name":"高","value":"3"}],"recognitionStatusEnum":[{"name":"已识别","value":"0"},{"name":"未识别","value":"1"},{"name":"初始化","value":"101"},{"name":"漏检","value":"102"},{"name":"未巡检","value":"103"},{"name":"识别错误","value":"104"},{"name":"识别正确","value":"2000"},{"name":"图像数据错误","value":"2001"},{"name":"算法分析失败","value":"2002"}],"statusEnum":[{"name":"删除","value":"-1"},{"name":"禁用","value":"0"},{"name":"启用","value":"1"}],"labelDictionaryTypeEnum":[{"name":"标注类型","value":"0"},{"name":"标注说明","value":"1"}],"exporterStatusEnum":[{"name":"导出中","value":"1"},{"name":"导出成功","value":"2"},{"name":"导出失败","value":"3"}],"globalAlertEnum":[{"name":"environment","value":"1"},{"name":"task","value":"2"},{"name":"robot","value":"3"},{"name":"belt","value":"4"}],"thresholdEnum":[{"name":"temperature,温度","value":"1"},{"name":"smoke,烟雾浓度","value":"2"},{"name":"ch4,甲烷浓度","value":"3"},{"name":"humidity,湿度","value":"4"},{"name":"dust,粉尘浓度","value":"5"},{"name":"nh3,氨气浓度","value":"6"},{"name":"h2s,硫化氢浓度","value":"7"},{"name":"co,一氧化碳浓度","value":"8"}],"equipmentModelExceptionInfoEnum":[{"name":"","value":"40004"},{"name":"该设备不支持焦距设置！","value":"40003"},{"name":"该设备不支持缩放！","value":"40002"},{"name":"成功！","value":"200"},{"name":"该设备不支持云台移动！","value":"40000"},{"name":"该设备不支持焦距获取及设置！","value":"40001"},{"name":"失败！","value":"400"}],"auditResultEnum":[{"name":"结果正确","value":"1"},{"name":"结果错误","value":"2"},{"name":"无结果","value":"3"},{"name":"图片异常","value":"4"}],"alarmProtocolTypeEnum":[{"name":"基本通信协议","value":"107002"},{"name":"增强型通信协议","value":"107003"}],"mainPageNoticeEnum":[{"name":"静默巡检更新","value":"0"},{"name":"实时巡检更新","value":"1"},{"name":"点位告警更新","value":"2"}],"unitEnum":[{"name":"年","value":"0"},{"name":"月","value":"1"},{"name":"日","value":"2"},{"name":"时","value":"3"},{"name":"分","value":"4"},{"name":"秒","value":"5"}],"fileTypeEnum":[{"name":"视频","value":"1"},{"name":"图片","value":"2"},{"name":"录音","value":"3"}],"statisticsTypeEnum":[{"name":"红外测温","value":"2"},{"name":"巡检任务","value":"3"},{"name":"点位告警","value":"4"}],"taskStatusEnum":[{"name":"正在执行","value":"1"},{"name":"任务暂停","value":"2"},{"name":"任务终止","value":"3"},{"name":"等待执行","value":"4"},{"name":"执行失败","value":"5"},{"name":"任务完成","value":"6"},{"name":"识别中","value":"7"},{"name":"已下发,待执行","value":"8"},{"name":"停止智能联动任务","value":"9"}],"alertMarkEnum":[{"name":"误告警","value":"2"},{"name":"缺陷","value":"3"},{"name":"确认告警","value":"4"}],"runningStateEnum":[{"name":"正在运行","value":"0"},{"name":"断开连接","value":"1"}],"usingTypeEnum":[{"name":"默认","value":"0"},{"name":"SDK","value":"1"},{"name":"ONVIF","value":"2"}],"alarmGradeEnum":[{"name":"后台系统无法计算","value":"-1"},{"name":"一般告警","value":"1"},{"name":"严重告警","value":"2"},{"name":"危急告警","value":"3"},{"name":"预警","value":"4"},{"name":"正常","value":"5"},{"name":"识别异常","value":"6"},{"name":"异常","value":"8"}],"alertExportOptionEnum":[{"name":"normal","value":"5"},{"name":"abnormal","value":"-1"},{"name":"all","value":"0"}],"statisticsFrequencyEnum":[{"name":"小时","value":"4"},{"name":"每天","value":"1"},{"name":"每月","value":"2"}],"eventSourceTypeEnum":[{"name":"A皮带启动","value":"1"},{"name":"B皮带启动","value":"2"},{"name":"AB皮带启动","value":"3"}],"agreementEnum":[{"name":"ONVIF协议","value":"0"},{"name":"海康协议","value":"1"},{"name":"大华协议","value":"2"}],"linkageEventTypeEnum":[{"name":"动作","value":"1"},{"name":"异常","value":"2"},{"name":"变位","value":"3"},{"name":"越限","value":"4"},{"name":"告知","value":"5"}],"tableListeningEnum":[{"name":"environment_exception_record","value":"1"},{"name":"equipment_info","value":"2"},{"name":"equipment_model","value":"3"},{"name":"export_record","value":"4"},{"name":"intelligent_linkage","value":"5"},{"name":"label_dictionary","value":"6"},{"name":"map_info","value":"7"},{"name":"position_mark","value":"8"},{"name":"robot_exception_info","value":"9"},{"name":"robot_info","value":"10"},{"name":"room_particulars","value":"11"},{"name":"silent_info","value":"12"},{"name":"substation","value":"13"},{"name":"sys_belt_config","value":"14"},{"name":"sys_belt_info","value":"15"},{"name":"sys_code","value":"16"},{"name":"sys_menu","value":"17"},{"name":"sys_role","value":"18"},{"name":"sys_user","value":"19"},{"name":"sys_role_rel","value":"20"},{"name":"sys_video_oper_info","value":"21"},{"name":"task_item","value":"22"},{"name":"task_edit","value":"23"},{"name":"task","value":"24"},{"name":"threshold","value":"25"},{"name":"track_info","value":"26"},{"name":"user_log","value":"27"},{"name":"wiring_diagram","value":"28"},{"name":"audible_visual_alarm","value":"29"}],"errorCodeEnum":[{"name":"接口授权异常","value":"403"},{"name":"接口验证异常","value":"403"},{"name":"操作返回","value":"0"},{"name":"列表返回","value":"0"},{"name":"数据异常","value":"403"},{"name":"添加异常","value":"403"},{"name":"修改异常","value":"403"},{"name":"删除异常","value":"403"},{"name":"操作异常","value":"401"},{"name":"系统运行异常","value":"100000"},{"name":"系统未知异常","value":"101000"},{"name":"参数异常","value":"101001"},{"name":"用户名不存在","value":"102001"},{"name":"密码错误 请重新输入","value":"102002"},{"name":"用户名已使用,请重新填写","value":"102004"},{"name":"用户未启用","value":"102005"},{"name":"此用户角色无权限","value":"102007"},{"name":"请先登录","value":"102008"},{"name":"模板点位名称重复","value":"103001"},{"name":"文件格式错误","value":"103002"},{"name":"未查询到三个对应的三项数据","value":"110001"},{"name":"此三项点位未查询到已执行的任务","value":"110002"},{"name":"此点位ID不存在","value":"110003"},{"name":"模板ip地址重复","value":"103001"},{"name":"查询的架构为空","value":"104001"},{"name":"删除层级下有用户数据","value":"104002"},{"name":"删除层级下有子层级","value":"104003"},{"name":"已到最大层级，无法继续添加","value":"104004"},{"name":"xxxxx","value":"105001"},{"name":"不支持云台控制的设备类型","value":"106001"},{"name":"云台控制连接异常","value":"106002"},{"name":"该业务类型对应的声光报警配置已存在","value":"107001"}],"brandTypeEnum":[{"name":"海康","value":"0"},{"name":"大华","value":"1"},{"name":"格物优信","value":"2"}],"reviewStatusEnum":[{"name":"未审核","value":"0"},{"name":"已审核","value":"1"},{"name":"误告警","value":"2"},{"name":"缺陷","value":"3"},{"name":"确认告警","value":"4"}],"equipmentStatusEnum":[{"name":"空闲状态","value":"1"},{"name":"巡视状态","value":"2"},{"name":"充电状态","value":"3"},{"name":"检修状态","value":"4"},{"name":"后台遥控模式","value":"3"},{"name":"手持遥控模","value":"4"}],"deviceTypeEnum":[{"name":"机器人","value":"0"},{"name":"摄像头","value":"1"},{"name":"皮带撕裂摄像头","value":"2"},{"name":"所有","value":"99"}]}

CAMERAID 63
auxiliary-control-authority undefined
roomList [{"label":"19室外机","value":"9"},{"label":"400A挂轨","value":"11"},{"label":"新昌电厂","value":"12"}]
homeTimeCurrentNav 2
MEDIADEVICEID
currentUser {"createTime":1627747200000,"creator":"admin","updateTime":1681262524000,"updator":"dd","id":2,"name":"admin","pwd":"e10adc3949ba59abbe56e057f20f883e","nickName":"超级管理员","contact":null,"status":1,"loginCount":1427,"loginTime":1712717724803,"roleId":1}
localVoiceMessage
taskType 0
dva {"router":{"location":{"pathname":"/login","search":"","hash":"","query":{}},"action":"POP"},"@@dva":0,"global":{"collapsed":false,"notices":[],"pageConfiguration":{"createTime":1678702273000,"creator":"wjy","updateTime":1699421602000,"updator":"admin","id":1,"title":"输煤栈桥智能巡检系统","status":1,"subheading":"Online Intelligent Patrol System","backgroundFile":"","logoFile":"","mainTitle":"输煤栈桥智能巡检系统","navBarLogoFile":"","substationNo":"1","substationName":"1","substationLongitude":"1","substationLatitude":"1","robotFileDays":1,"cameraFileDays":1,"robotTaskBattery":-1,"robotChargeBattery":-1},"nowRoom":{"createTime":1684741902000,"creator":"admin","updateTime":1684741902000,"updator":"admin","id":11,"roomName":"400A挂轨","robotIds":"3","mapPath2d":null,"wiringDiagramId":null,"mapPath3d":"","mapId":"6"}},"historyinfo":{"treedatas":[],"tableDatas":[]},"login":{"status":1},"robot":{"robotState":[{"id":0,"key":"linearVel","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUJggg==","text":"运行速度(m/s)","value":"--"},{"id":1,"key":"battery","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAQmCC","text":"当前电池电量(%)","value":"--"},{"id":2,"key":"chargeStateInt","icon":"data:image/png;base64,iVBORw0KrkJggg==","text":"充电状态","value":"--"},{"id":3,"key":"errorCode","icon":"data:image/png;base64,iVBORw0KGgoAAAgg==","text":"错误代码","value":"--"},{"id":4,"key":"current","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhE=","text":"空调器","value":"--"}],"robotList":[],"nowRobot":""},"role":{"CurrentRoleTree":[]},"task":{"monthTaskModel":{}},"user":{"currentUser":{}},"wiringDiagram":{"actionPens":[],"formData":{"isAction":false,"name":"请选择节点","type":0,"rotate":0,"x":0,"y":0,"fontSize":12,"width":0,"height":0,"locked":0,"length":0,"lineWidth":0,"globalAlpha":0,"lineName":"","color":"","background":""},"topology":{"store":{"active":[]}}},"loading":{"global":false,"models":{"login":false,"global":false},"effects":{"login/login":false,"global/changePageConfiguration":false,"global/changeNowRoom":false,"login/logout":false}}}

clientId 1e9b9441-8f98-4ea4-8ef0-91ae769e2a3e
robotId 3

APP有时候卡qia住了，页面上的元素点击后没反应！！getStorage的promise特性不算问题！！

anum是保留关键字，不能用作变量名

# style

<https://blog.csdn.net/qq_42840755/article/details/123059375>
<https://xieyufei.com/2021/10/26/React-Native-Style.html> <https://reactnative.cn/docs/height-and-width>
Overload 1 of 2, '(props: ViewProps): View', gave the following error.
    Object literal may only specify known properties, and 'color' does not exist in type 'ViewStyle | RecursiveArray<Falsy | ViewStyle | RegisteredStyle<ViewStyle>>'.
  Overload 2 of 2, '(props: ViewProps, context: any): View', gave the following error.
    Object literal may only specify known properties, and 'color' does not exist in type 'ViewStyle | RecursiveArray<Falsy | ViewStyle | RegisteredStyle<ViewStyle>>'.

环境监测、任务概况的WebSocket数据。

EchartsEnvironmentModal/

equipment-model/device-management-r 登录失效，请重新登录： 该弹窗现象重复不断地出现。

build.gradle & app/build.gradle

# android studio

里面有关gradle等等的报错比PowerShell要更详细，可以精确到哪个JAVA文件第几行的错误级别。。

消息通知打开时全都是未读的、get-unread-task-exceptions，

icon组缺少mipmap-ldpi选项；首页无法滑动。

信息内容过长时，要有省略号，以及popconfirm或者title的效果

*从顶向下逐级注释组件，来排查某些很难排查的bug* res (res:any)

离线设备数出现负数！！ src-require Error while updating property 'src' of a view managedd by: RCTImageView null
Value for uri cannot be cast from Double to String.

image-source-require问题需要重新跑一下yarn Android
img <https://400c.fe.xiaoma.com/resource/media/video/tmp/65/20240410190435.jpeg> 无意识地按下物理返回键返回到登录页后，是否要自动登录到首页？

websocket在150:7000（正常，可以连接得上websocket）和400c.fe（不正常，连不上websocket）之间的切换问题。应该是wss只能在生产环境的服务器上才能跑通，

empty source problem => video loading

函数组件容易大量重复渲染，需要用useCallback ws://192.168.0.150:7000/stream/?url=rtsp://admin:sshw1234@192.168.20.40:554/h265/ch1/sub/av_stream&width=704&height=396&bitrate=800

Invariant Violation: requireNativeComponent: "RCTVLCPlayer" was not found in the UIManager.
yarn remove vlc-player(300+ stars);model的yield用法的问题。

wss://400c.fe.xiaoma.com/stream/?url=rtsp://admin:sshw1234@192.168.20.41:554/h265/ch2/main/av_stream&width=704&height=396&bitrate=800
请求方法:
GET
状态代码:
101 Switching Protocols
ws://192.168.0.150:7000/stream/?url=rtsp://admin:sshw1234@192.168.20.40:554/h265/ch1/sub/av_stream&width=704&height=396&bitrate=800

# Permission Android API

<https://reactnative.dev/docs/permissionsandroid.html>

# 夜神模拟器

需要先打开应用程序，然后点击那个APP，然后yarn start,yarn android

# compile-implementation

<https://stackoverflow.com/questions/72951365/could-not-find-method-compile-for-arguments-com-facebook-reactreact-native>

# http/https

<https://www.volcengine.com/theme/8139627-R-7-1> <https://blog.csdn.net/pyaizhu/article/details/126889757> <https://blog.csdn.net/taoerchun/article/details/80845049> <https://www.volcengine.com/theme/7720832-Z-7-1>

 Could not find method compile() for arguments [com.facebook.react:react-native:+] on object of type org.gradle.api.internal.artifacts.dsl.dependencies.DefaultDependencyHandler.

RNFetchBlob error when sending request : connect timed out

one powershell,one cmd;400c.fe domain name request failed on app...

# width,height,aspectRatio

Dimensions.get('window').width 4:3,3:2,w:h.

# ScrollView FlatList VirtualizedLists

VirtualizedLists should never be nested inside plain ScrollViews with the same orientatioin, because it can break windowing and other funtionality - use another VirtualizedList-backed container instead

# LogBox

```js
import React, { useEffect } from 'react';
import { LogBox } from 'react-native';

useEffect(() => {
    LogBox.ignoreLogs(['VirtualizedLists should never be nested']);
}, [])
```

怎么新增四种全局告警？？继续使用dva，但是不把请求代码放在model文件里面。

WIFI南昌研发中心密码：XM990103,JSXMJQR:JL990103

# wss certificate

<https://www.volcengine.com/theme/1118333-W-7-1>

jsmpeg.min.js:775 WebSocket connection to 'wss://guard.xiaoma.com/stream/?url=rtsp://admin:sshw1234@192.168.20.40:554/h265/ch1/sub/av_stream&width=704&height=396&bitrate=800' failed: Error in connection establishment: net::ERR_CERT_AUTHORITY_INVALID

<https://wwj718.github.io/post/%E5%B0%91%E5%84%BF%E7%BC%96%E7%A8%8B/localhost-https-ssl/>
<https://letsencrypt.org/docs/certificates-for-localhost/>

<https://blog.csdn.net/freeabc/article/details/109737552>

tart chrome with the flag --ignore-certificate-errors

PS C:\Users\Administrator> mkcert -key-file key.pem -cert-file cert.pem xiaoma.com *.xiaoma.com
Created a new local CA 💥
Note: the local CA is not installed in the system trust store.
Note: the local CA is not installed in the Java trust store.
Run "mkcert -install" for certificates to be trusted automatically ⚠️

Created a new certificate valid for the following names 📜

- "xiaoma.com"
- "*.xiaoma.com"

Reminder: X.509 wildcards only go one level deep, so this won't match a.b.xiaoma.com ℹ️

The certificate is at "cert.pem" and the key at "key.pem" ✅

It will expire on 15 July 2026 🗓

chrome://flags/ cert/https/

# 192.168.20.40

配置摄像头

# 地图

找政樑，接口-朱锦涛;水波纹的效果很棒！！但是在APP上实现起来有难度。

站端推流有问题，和政樑一起解决。去掉wss前缀，改成直接的rtsp部分。

# swagger

<http://192.168.0.150:8085/guard/doc.html>
输煤栈桥：<http://192.168.20.44:7000/guard/doc.html，站端：http://192.168.20.44:7001/xiaoma/doc.html>

# gitlab

guo_nc xiaoma123456

# metro-add-new-package

总是显示类似这样的错误： Cannot read property 'lockToLandscape' of null

# Text-comp

逐个组件注释的方法来排查这个bug，同时要特别小心react-native标签名旁边的一点点、一些些字符，眼光要仔细一些！！
Text strings must be rendered within a <Text> component.
<Video />不要包裹在<View />里面，要不然就会报出上面这样的错误；还有antd-rn的Drawer-List-NativeArray错误这样的。。

undefined Unable to resolve module react-native-linear-gradient
originModulePath components/GradientWrapper/index.tsx,targetModuleName:react-native-linear-gradient.(The development server returned response error code: 500)

requireNativeComponent: "BVLinearGradient" was not found in the UIManager.

# Style

`import { StyleSheet, TextStyle, ViewStyle } from "react-native";`

style={[styles.style1,styles.style2]} replace StyleSheet.compose

error while updating property 'position' of a view managed by: RCTVLCPlayer
‘position’,'transform' cast Double to String 直接提示哪个样式属性设置地有问题。

# gitlab

<13611782678@163.com>
123456789
gitlab账号

# toDesk

<https://400c.fe.xiaoma.com/api/equipment-info/control-PTZ-Absolute-movement/16> PUT-body: {"x":0,"y":0,"zoom":0} ; code
:
100000
exceptionInfo
:
"不支持云台控制的设备类型"
msg
:
"不支持云台控制的设备类型"

# Touchable

TouchableHighlight/TouchableOpacity/TouchableWithoutFeedback
Pressable pressedFn Pressability;

getZoneParticulars 总是服务器繁忙。。

# fullscreen

fullscreen
Controls whether the player enters fullscreen on play.

false (default) - Don't display the video in fullscreen
true - Display the video in fullscreen
Platforms: iOS

fullscreenAutorotate
If a preferred fullscreenOrientation is set, causes the video to rotate to that orientation but permits rotation of the screen to orientation held by user. Defaults to TRUE.

Platforms: iOS

fullscreenOrientation
all (default) -
landscape
portrait
Platforms: iOS

通过modal方式，在安卓端切换全屏前后，样式会错乱。

# zIndex & elevation

<https://blog.csdn.net/hzxOnlineOk/article/details/105568401>

# debug

可以一直按住鼠标然后拖拽的方式，来滚动调用栈页面。

onLongPress和定时器有关，暂时先不写！！还有slider最好有滑动效果！！

摄像头各个参数的初始值可以通过接口获取到吗，还是说都是0.5;放大、缩小；摄像头控制界面的删除操作的接口，是否只删除一个列表里的；设置静默点位？

visibleSize参数怎么是undefined？？毛玻璃；

# react

Render Error
Rendered fewer hooks than expected. This may be caused by an accidental early return statement.

renderTabContent

# react-native-vlc-media-player

<https://github.com/razorRun/react-native-vlc-media-player-test/blob/master/App.js>

刚开始画面加载地比较慢，会让人以为是

安装ffmpeg到服务器上
全屏操作时报错：immutable的错误。
Render Error:
You attempted to set the key'isNetwork' with the value`true` on an object that is meant to be immutable and has been frozen.

ReactNativeRender-dev.js
Renderer/implementations/ReactNativeRender-dev.js:21076: flushSyncCallbacksOnlyInLegacyMode

TypeError: Cannot read property 'setNativeProps' of undefined, js engine: hermes

# 间距

水平间距24，垂直方向上大的block之间的距离为24，block内部的小block之间的距离为16.

getRoomParticulars经常请求失败

# add new package

很可能会引发Text-cmpt-render-error。
react-native start --reset-cache才能彻底不报错。

Error: EBUSY: resource busy or locked, unlink 'C:\Users\Administrator\projects\xiaoma-app
\node_modules\@react-native\gradle-plugin\.gradle\buildOutputCleanup\buildOutputCleanup.lock'

多余的细线，List-InputItem？

navigationId,hoverPoint,mapId。。

capture:机器人图片获取失败,错误码:29;

IP Camera:192.168.20.40;infrared:<http://192.168.20.41:8100/> (ITT-IR)

REACT_NATIVE到底能不能动态挂载信息到window上面？事实证明可以！！

629bca90-4280-46f3-9583-60691f118118 wss://luanpingapp.techxiaoma.com/api/ws/polling/0539483a-f0e8-4270-a170-71f43a04a6f0
wss://luanpingapp.techxiaoma.com/api/ws/polling/629bca90-4280-46f3-9583-60691f118118

websocket测试工具：<https://wstool.js.org/；再次进入控制中心获取不到消息。>

{
  "pointId": "1000001",
  "pointName": "测试",
  "defectType": "1",
  "alarmLevel": "1",
  "zoneId": "1000001",
  "zoneName": "片区",
  "region": "一楼",
  "intervals": "皮带机前侧",
  "defectDevice": "缺陷装置",
  "defectDesc": "缺陷描述"
}

全屏样式调整；picker点击后变黑。

# dva-model

'yield' expression implicitly results in an 'any' type because its containing generator lacks a return-type annotation.ts(7057)

```js
*logout({ payload }, { put }):any {
      console.log('logOut2');

      const response = yield Api.GET_SYS_USER_LOGOUT()
      if (response) {
        yield put({
          type: 'changeStatus',
        })
        clearAll()
        navigate('Login')
      } else {
        console.log('logout failed');

      }
    },

*logout({ payload }, { put }) {
      console.log('logOut2');

      const response = yield Api.GET_SYS_USER_LOGOUT()
      if (response) {
        yield put({
          type: 'changeStatus',
        })
        clearAll()
        navigate('Login')
      } else {
        console.log('logout failed');

      }
    },
```

# antd-rn

## List

有上下细线，作边框作用。

[SyntaxError: JSON Parse error: Unexpected character: a] console.error(e)才能排查出console.log不能排查出的问题。
两个按钮黏在一起了。

真机上视频流出不来；切换不到摄像头控制页面。PointsList/SectionList不显示数据（改用三个FlatList合并出一个大的List）；Modal和Picker不能同时出现？查一下官网。

调整样式需要在真机上调整;不过真机上调试也有卡住的问题，需要二次刷新后页面才能点击。涉及到多个Promise和setData时要特别注意srcData、newData的位置，以及Promise.all的使用！

# View

不能在Text，不然也会报类似那种错误。

# Text

color没有全局默认颜色
设置全局默认样式：<https://blog.csdn.net/weixin_38233549/article/details/94603586>

auditUser看不到，编辑不了。

TreeView内存超限的错误或警告；点位告警历史信息的请求参数核对。

隐藏Virtualized-List的弹窗（debug 环境）

# antd-rn-InputItem

文字需要写在Text里面

# react-native-tree-multi-select

最大层数5层，最大层数7
FlashList's rendered size is not usable. Either the height or width is too
 small (<2px). Please make sure that the parent view of the list has a valid size
. FlashList will match the size of the parent.

???

typescript的报错不用花什么时间

`// @ts-ignore: Unreachable code error`

# LogBoxData

```js
export function addLog(log:LogData):void {
  const errorForStackTrace = new Error()
  // Parsing logs are expensive so we schedule this
  // otherwise spammy logs would pause rendering
  // node_modules/react-native/Libraries/LogBox/Data/LogBoxData.js 196:39
}
```

# canvas

```js
if (!(canvas instanceof _Canvas.default)) {
    throw new Error('Image must be initialized with a Canvas instance');
  }
// node_modules\react-native-canvas\dist\Image.js
```

getCurrentVideoState是否双向可用？

暂无地图的接口传不过去参数

# hooks

Error: Rendered more hooks than during the previous render.

在renderTab这样的函数里，不要随便写setState。摄像头控制页面的点位定位列表的静默点位设置操作；

onEndReached；

Modal和Toast冲突。renderProgress、切换设备时要保留之前的摄像头或机器人；iris设置失败，404，要不要给提示。全屏icon样式调整。

```js
style={{aspectRatio:1338 / 752}}
              resizeMode='contain'
```

已存视频有的是图片？TreeSelect为何不渲染，就连简单的树都不渲染。地图组件重复渲染、重复报错。真机上调试时视频有时候出不来。

首页实时巡检列表里的视频case有吗？mp4格式？？ first...

socket.ts里面log出‘重连’的两个不一样的clientId 404:<https://luanpingapp.techxiaoma.com/ftp/resource/media/video/92/20240423191808.mp4>

# console

## error

ERROR  his [TypeError: res.map is not a function (it is undefined)] `fetch.catch or Promise.catch`

# husky

<https://typicode.github.io/husky/get-started.html> <https://stackoverflow.com/questions/71863798/add-husky-pre-commit-hook-with-npm6-on-windows>

# --legacy-peer-deps

```js
code ERESOLVE
npm ERR! ERESOLVE could not resolve
npm ERR!
npm ERR! While resolving: dva-core-ts@2.0.7
npm ERR! Found: redux@5.0.1
npm ERR! node_modules/redux
npm ERR!   peerOptional redux@"^5.0.0" from react-redux@9.1.0
npm ERR!   node_modules/react-redux
npm ERR!     react-redux@"^9.1.0" from the root project
npm ERR!   redux@"^5.0.1" from the root project
npm ERR!
npm ERR! Could not resolve dependency:
npm ERR! peer redux@"4.x" from dva-core-ts@2.0.7
npm ERR! node_modules/dva-core-ts
npm ERR!   dva-core-ts@"^2.0.7" from the root project
npm ERR!
npm ERR! Conflicting peer dependency: redux@4.2.1
npm ERR! node_modules/redux
npm ERR!   peer redux@"4.x" from dva-core-ts@2.0.7
npm ERR!   node_modules/dva-core-ts
npm ERR!     dva-core-ts@"^2.0.7" from the root project
npm ERR!
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR! this command with --force or --legacy-peer-deps
npm ERR! to accept an incorrect (and potentially broken) dependency resolution.
npm ERR!
npm ERR!
npm ERR! For a full report see:
npm ERR! C:\Users\Administrator\AppData\Local\npm-cache\_logs\2024-04-24T00_42_37
```

# network

小马APP真机调试时，总是会经常出现network request failed。

# Invariant Violation

Invariant Violation: [4473,"RCTView",{"height":"<<NaN>>"}] is not usable
as a native method argument

This error is located at:
    in RCTView (created by View)
    in View (at Canvas.js:139)
    in Canvas
    in RCTView (created by View)
    in View
    in Unknown (created by DeviceController)
    in RCTView (created by View)
    in View (created by ScrollView)
    in RCTScrollView (created by ScrollView)
    in ScrollView (created by ScrollView)
    in ScrollView (created by NativeViewGestureHandler)

# MutableRefObject

# tsconfig.json

Cannot find type definition file for 'jest'.
  The file is in the program because:
    Entry point of type library 'jest' specified in compilerOptionsts

Cannot find type definition file for 'react-native'.
  The file is in the program because:
    Entry point of type library 'react-native' specified in compilerOptionsts

`"extends": "@react-native/typescript-config/tsconfig.json",`

<https://juejin.cn/s/react%20native%20%E8%A7%86%E9%A2%91%E6%B5%81、https://github.com/react-native-video/react-native-video/blob/master/examples/FabricExample/src/VideoPlayer.tsx> <https://www.reddit.com/r/reactnative/comments/o28cy9/solution_to_play_rtsp_http_stream_in_a_player_in/> <https://web.520wcf.com/sun-ming-li/React-Native-Learning-Notes-3.html> <https://lanhuapp.com/web/#/item/project/detailDetach?pid=9674781c-ba12-4df7-93dc-f44f03056ffd&project_id=9674781c-ba12-4df7-93dc-f44f03056ffd&image_id=f2e084b0-378c-4118-8c1a-59a7f6e02311&fromEditor=true>

终端的log信息的改动没有跟代码改动同步。。

The call stack is not symbolicated. Some features are unavailable such as viewing the function name or tapping to open files.

terminal经常两次Ctrl+C退出不了。。PickerTree方案不满足功能要求，还是看那个层级为2的时候multi-select-tree为何还是不显示在页面上。。
treeViewParent: {flex:1,minWidth:'100%'}。helpers/iterableToArray.js，

RNCWebView,

generateDebugResources,generateDebugResValues,preBuild,preDebugBuild; UP-TO-DATE,writeDebugAarMetaData，writeDebugAarMetadata、checkDebugAarMetadata；

Task :app:installDebug

 Error: EBUSY: resource busy or locked, unlink 'C:\Users\Administrator\projects\xiaoma-app\node_modules\@react-native\gradle-plugin\.gradle\buildOutputCleanup\buildOutputCleanup.lock'

react-native start这条命令要跑完，再stop server，要不然node_moduels文件夹里的资源会被lock住，不让进行npm add时的最后一步link操作。
This expression is not constructable.
  Type 'typeof import("c:/Users/Administrator/projects/xiaoma-app/ws")' has no construct signatures.ts(2351)

restart vsc!!

error: Error: While trying to resolve module `https` from file `C:\Users\Administrator\projects\xiaoma-app\src\api\fetch.ts`, the package `C:\Users\Administrator\projects\xiaoma-app\node_modules\https\package.json` was successfully found. However, this package itself specifies a `main` module field that could not be resolved (`C:\Users\Administrator\projects\xiaoma-app\node_modules\https\index.js`. Indeed, none of these files exist:

400c.guard.xiaoma.com的接口在APP上，为何调不通？？400c.guard.xiaoma.com访问不通接口。

忽略掉https的ssl证书校验。打生产包到真机；没有视频流时的黑色背景；录像的全屏和倍速功能；multi-select-tree；

# ScrollView&View

在超尺寸的情况下，不用ScrollView就会报错

# Nox

报no connected device的错误时，直接打开Nox后，执行`yarn start --reset-cahce`即可。

could not connect to development server.

Try the follwing to fix the issue:

- Enusure the Metro is running
- Ensure that your device/emulator is connected to your machine, and has USB debugging enabled - run

# react-native-gesture-handler

Error: NativeViewGestureHandler must be used as a descendant of GestureHa
ndlerRootView. Otherwise the gestures will not be recognized. See <https://docs.sw>
mansion.com/react-native-gesture-handler/docs/installation for more details.

This error is located at:
    in NativeViewGestureHandler (created by ScrollView)

请添加设备就不显示了；怎么发布react-native到华为应用市场、小米应用商店这些地方。

设置各个页面的mock数据，44IP地址可以访问，luanpingapp.techxiaoma可以访问后，把mockDftData都改成空数组；

antd-rn-input的默认样式设置、Toast的全局时长设置（之后改成2）、

# app-locale-国际化和皮肤配置

分为APP整体的国际化和UI框架的配置两方面。。
<https://rn.mobile.ant.design/components/locale-provider-cn/> <https://github.com/ant-design/ant-design-mobile-rn/blob/master/components/style/themes/default.tsx>

```js
// 通过组件化形式配置local语言包：https://github.com/ant-design/ant-design-mobile-rn/blob/master/components/locale-provider/zh_CN.tsx
import DatePickerView from '../date-picker-view/locale/zh_CN'
import DatePicker from '../date-picker/locale/zh_CN'
import InputItem from '../input-item/locale/zh_CN'
import ListView from '../list-view/locale/zh_CN'
import Modal from '../modal/locale/zh_CN'
import Pagination from '../pagination/locale/zh_CN'
import Picker from '../picker/locale/zh_CN'
import SearchBar from '../search-bar/locale/zh_CN'
export default {
  locale: 'zh_CN',
  DatePicker,
  DatePickerView,
  InputItem,
  Modal,
  Pagination,
  Picker,
  SearchBar,
  ListView,
}
```

给包裹InputItem的View设置marginBottom时，模拟器上几乎完全看不出效果，但是真机上有效果。地图背景、指南针、文案；识别结果--；

dftRobotId:92,dftMapId:20

baseEntityId, navigation arr/ trackIndex / setPoints / pointsArr

not logged 'typ6'...

覆盖antd-rn的主题变量，比如picker的两个btn按下时的backgroundColor;运行速度NaN（有请求返回时才这样）

切换全屏过程前后，视频流和工具icons数量和样式出现问题，以及全屏页面下的按钮样式问题。机器人位置坐标的确定；

显示长文字Modal的底部按钮

更改轨道线的粗细和颜色，还有打点的颜色；hoverPoint含义；EventBus.NAVIGATION_POINT_SELECTION

No overload matches this call.
  Overload 1 of 2, '(props: ViewProps): View', gave the following error.
    Type '{ recording: React.MutableRefObject<boolean>; "": React.JSX.Element | null; }' is not assignable to type 'ReactNode'.
  Overload 2 of 2, '(props: ViewProps, context: any): View', gave the following error.
    Type '{ recording: React.MutableRefObject<boolean>; "": React.JSX.Element | null; }' is not assignable to type 'ReactNode'.ts(2769)

点位名称显示在地图上吗？---绘制点的逻辑。

TypMsg类型名称都改造好。机器人坐标和各个点位坐标怎么不显示了？告警信息标题居左；看一下共享文档里的问题有没有可以删掉的。控制中心假数据显示一下。还有消息通知的假数据。控制中心的ActivityIndicator显示问题。。有时候不显示；

StatusBar的背景色设置成透明。 怎么监测键盘的隐藏呢？

实时巡检list的data不应该被频繁设置;倒计时3s就不显示了，不知道怎么设置，没查到相关资料，要改安卓代码。

背景图片怎么延伸到StatusBar

Execution failed for task ':app:compileDebugKotlin'.
> A failure occurred while executing org.jetbrains.kotlin.compilerRunner.GradleCo
mpilerRunnerWithWorkers$GradleKotlinCompilerWorkAction
   > Compilation error. See log for more details

- Try:

> Run with --stacktrace option to get the stack trace.
> Run with --info or --debug option to get more log output.
> Run with --scan to get full insights.
> Get more help at <https://help.gradle.org>.

Expecting qualified name
Import must be placed on a single line

npx react-native run-android --info

cd android;./gradlew assembleDebug --info, ./gradlew assembleDebug --debug;

gradle的报错应该是countdownTextView的添加导致的，暂时先不管，优先级降低。

```js
e: file:///C:/Users/Administrator/projects/xiaoma-app/android/app/src/main/java/c
om/xiaomarobot/SplashActivity.kt:5:16 Unresolved reference: android
e: file:///C:/Users/Administrator/projects/xiaoma-app/android/app/src/main/java/c
om/xiaomarobot/SplashActivity.kt:11:24 Unresolved reference: R
e: file:///C:/Users/Administrator/projects/xiaoma-app/android/app/src/main/java/c
om/xiaomarobot/SplashActivity.kt:17:46 Unresolved reference: countdownTextView
e: file:///C:/Users/Administrator/projects/xiaoma-app/android/app/src/main/java/c
om/xiaomarobot/SplashActivity.kt:17:64 Variable expected
e: file:///C:/Users/Administrator/projects/xiaoma-app/android/app/src/main/java/c
om/xiaomarobot/SplashActivity.kt:18:22 Unresolved reference: countdownTextView
e: file:///C:/Users/Administrator/projects/xiaoma-app/android/app/src/main/java/c
om/xiaomarobot/SplashActivity.kt:18:40 Variable expected
e: file:///C:/Users/Administrator/projects/xiaoma-app/android/app/src/main/java/c
om/xiaomarobot/SplashActivity.kt:18:47 Empty character literal
e: file:///C:/Users/Administrator/projects/xiaoma-app/android/app/src/main/java/c
om/xiaomarobot/SplashActivity.kt:23:59 Unresolved reference: MainActivity
```

Gradle sync finished in 17 m 52 s 589 ms

Android Gradle plugin version 8.1.1 has an upgrade available. Start the AGP Upgrade Assistant to update this project's AGP version.

Multiple Gradle daemons might be spawned because the Gradle JDK and JAVA_HOME locations are different. Project 'Xiaomarobot' is using the following JDK location when running Gradle: 'C:\Program Files\Android\Android Studio\jbr' The system environment variable JAVA_HOME is: 'C:\Program Files\Java\jdk-17' If you dont need to use different paths (or if JAVA_HOME is undefined), you can avoid spawning multiple daemons by setting JAVA_HOME and the JDK location to the same path.

<https://developer.android.com/topic/libraries/view-binding?hl=zh-cn#kts>

The application should not provide its own launch screen More... (Ctrl+F1)
Inspection info:Starting in Android 12 (API 31+), the application's Launch Screen is provided by the system and the application should not create its own, otherwise the user will see two splashscreens. Please check the SplashScreen class to check how the Splash Screen can be controlled and customized.  Issue id: CustomSplashScreen

Overload resolution ambiguity. All these functions match.
public open fun setContentView(view: View!): Unit defined in SplashActivity
public open fun setContentView(layoutResID: Int): Unit defined in SplashActivit

Do not concatenate text displayed with setText. Use resource string with placeholders

debug-hotload时才会出现绿点和机器人的icon，初始化时不会出现？？为啥呢。

指南在的WNES；

为什么一直log，不停。。当前距离拿不到值。。

RobotMap-robotInfo还是有时候拿不到值。

用ReactNative的TextInput，稍微按照公司的UI风格封装一下，就可以到处使用了。。

点位列表的三种列表的所有该显示的字段对应的正确结果显示
RNVideo的倍速控制按钮添加，封装称commonComponent。Enums里面有name和value不是一一对应的情况？？

没有当前距离的概念和计算方式。

gif图的更新，透明背景，只包含颜色圈，不含白色背景。机器人控制和摄像头控制的功能还需要调试好。

还有水波图的样式调整分两方面：innerCircle和wave部分，以及它们的整合。

登录页还在调其他接口。

怎么有时候不跳登录页？

为啥有时候离线设备会出现负数，正常吗，后端的bug？ 点击登录按钮有时候会报错：网络异常。。FlatList的翻页功能测试。。翻不到第二页。。

分页接口。FlatList的下拉刷新功能，以及交互的兼容性。

HistoryData的查询条件的各个接口的测试

}, [deviceStateList, cameras.current, robots.current])

一直弹出：‘您的网络发生异常，无法连接服务器’。iterableToArray.js影响到真机调试了(useCameraState-setDeviceStateList[...res])，有点卡。

TreeView的maxium-callstack问题:

```js
if (checkedIds.length === 1) {
                treeViewRef.current?.unselectAll()
              }
```

mockZones

 [Error: TransformError src\components\DeviceController\index.tsx: src\com
ponents\DeviceController\index.tsx:Invalid call at line 482: require(`../../asset
s/images/${waveMap[txt]}Wave.gif`)]

Modal的居下定位。

debug时Home页面的StatusBar显示异常。

不显示TreeView，台式电脑给手机充电特别慢。

要点开模拟器里面的APP，才会debug打包。
模拟器或者真机调试时，会卡住。
历史数据页面进不去。卡住。 模拟器reload失败。

`yarn remove classnames http
 https https-proxy-agent isomorphic-fetch net querystring react-native-chart-kit
react-native-fs react-native-tab-view recyclerlistview timers tls url ws`

runtime/helpers/asyncToGenerator.js asyncGeneratorStep

TreeView延迟显示。。

涉及到递归函数的操作时，要特别注意一些无用的变量，而且在render之前要特别注意一下。

TreeView点击最底部的checkbox后，会卡住。

Error: While trying to resolve module 'https' from file 'src/api/fetch.ts',the package 'node_modules/https/package.json' was successfully found. However, this package itself specifies a 'main' module field that could not be resolved(node_modules/https/index.js). Indeed, none of these files exist

react-native lazy实现
react-native kotlin SplashScreen 右上角倒计时3秒 ;如何在 Kotlin 代码中实现倒计时呢

    "postinstall": "./node_modules/.bin/rn-nodeify --install https http url --hack --yarn",

    "postinstall": "rn-nodeify --install buffer,stream,events,https,util --hack --yarn",

    "postinstall": "rn-nodeify --install --hack",

  "react-native": {
    "https": "https-browserify",
    "http": "@tradle/react-native-http",
    "_stream_transform": "readable-stream/transform",
    "_stream_readable": "readable-stream/readable",
    "_stream_writable": "readable-stream/writable",
    "_stream_duplex": "readable-stream/duplex",
    "_stream_passthrough": "readable-stream/passthrough",
    "stream": "stream-browserify"
  },
  "browser": {
    "https": "https-browserify",
    "http": "@tradle/react-native-http",
    "_stream_transform": "readable-stream/transform",
    "_stream_readable": "readable-stream/readable",
    "_stream_writable": "readable-stream/writable",
    "_stream_duplex": "readable-stream/duplex",
    "_stream_passthrough": "readable-stream/passthrough",
    "stream": "stream-browserify"
  }

dynamic import: <https://blog.logrocket.com/natively-implement-dynamic-imports-react-native/> 有一直refreshing的问题。

HistoryData 逐个注释掉组件；其他页面也是，找到性能点。

 Invariant Violation: [1029,"RNCWebView",{"height":"<<NaN>>"}] is not usab
le as a native method argument

This error is located at:
    in RNCWebView
    in RCTView (created by View)
    in View
    in Unknown (at Canvas.js:140)
    in RCTView (created by View)
    in View (at Canvas.js:139)
    in Canvas
    in RCTView (created by View)
    in View
    in Unknown (created by DeviceController)
    in RCTView (created by View)
    in View (created by ScrollView)
    in RCTScrollView (created by ScrollView)

home页面或者控制中心页面的性能杀手是VLCPlayer的url包含undefined时的一直暗暗loading，在消耗内存！！

StatusBar-历史数据页面，只更改paddingTop和marginTop、还有barStyle。

站端的地图不显示小车位置，carRealtimeInfo；路径超出地图，一部分线段在地图上方；drawCar：startPort-x/y carInfo.width/height,

this.carInfo,this.carImage ROBOT_RAIL_TYPE 3-9;drawRect;initCar(初始化小车位置并渲染);

this.carImage.onload=()=>{
  this.carPositionTransform()
  this.pointCloudTransform()
}

!this.carPosition.vehicleCoordinate

arrayToObj(JSON.parse(getLocalStorage('TRACK_INFO')) ,'trackIndex')

getCurrentRobotId robotMixin-carPositionListener:carPosition,carRealtimeInfo,mapInfo(getCurrentRobotMapData:根据当前机器人获取地图，导航点，路径等信息)

get_current_robot_use_map

robotType===sceneType:2,robotId:10,mapId:18;const robotType = getCurrentSceneType();

this.allPoints = res.navigationPoints(getMapData)

this.carRealtimeInfo.current===-354

 // 判断小车是否在地图外
        const realWidth = this.mapInfo.width * this.mapInfo.proportion; // 1775*0.05=88.75
        const realHeight = this.mapInfo.height * this.mapInfo.proportion; 1764*0.05=88.2
        const left = -this.mapInfo.originX; -59.7
        const right = -this.mapInfo.originX + realWidth; 29.7
        const top = -this.mapInfo.originY + realHeight; 38.2
        const bottom = -this.mapInfo.originY; -30
        if (
          robotMsg.localization_msg.real_time_pose.position.x < left || 2.49
          robotMsg.localization_msg.real_time_pose.position.x > right ||
          robotMsg.localization_msg.real_time_pose.position.y < bottom || -1.89,z(deg):-0.007
          robotMsg.localization_msg.real_time_pose.position.y > top
        ) {
          this.blinkText = '机器人定位在地图外';
        } else {
          this.blinkText = '';
        }

robot_map_icon.png carPositionTransform this.carPosition = { vehicleCoordinate: `${x},${y}`, deg };

const transformedCarPosition = pointsFormatBatch(
      [this.carPosition], [{vehicleCoordinate:'2.49,-1.89',deg:-.007}]
      { x: this.mapInfo.originX, y: this.mapInfo.originY }, {x:59.7,y:30}
      this.mapInfo.proportion, .05
      this.imageNaturalHeight 30?
    )[0]; {id:undefined,x}
    this.store.commit(
      'refreshCarPosition',
      transformedCarPosition.x *this.scaleRatio,
      transformedCarPosition.y* this.scaleRatio,
      (-this.carPosition.deg / Math.PI) * 180
    );

const pointsFormatBatch = (points, originalPoint, pixelRatio, imageHeight) => {
  return points.map(point => {
    const beforeFormatPoint = {
      x: point.vehicleCoordinate.split[','](0),
      y: point.vehicleCoordinate.split[','](1),
      z: point.vehicleCoordinate.split[','](2),
    }; 2.49,-1.89',deg:-.007
    const { x, y } = coordinateTransform(
      beforeFormatPoint,
      originalPoint, {x:59.7,y:30}
      pixelRatio, .05
      imageHeight 30
    );
    return {
      id: point.id,
      x, (2.49+59.7)/.05 1200
      y, 30-(-1.89+30)/.05 -532
      z: beforeFormatPoint.z, -.007
      mapId: point.mapId, 18
    };
  });
};
    coordinateTransform

robot-map:
    const transformedCarPosition = pointsFormatBatch(
      [this.carPosition],
      { x: this.mapInfo.originX, y: this.mapInfo.originY },
      this.mapInfo.proportion,
      this.imageNaturalHeight
    )[0];
    this.store.commit(
      'refreshCarPosition',
      transformedCarPosition.x *this.scaleRatio, 60
      transformedCarPosition.y* this.scaleRatio, -26.2
      (-this.carPosition.deg / Math.PI) * 180
    );

robotMixin:

this.allPoints = res.navigationPoints;

// 根据当前机器人获取地图，导航点，路径等信息
    async getCurrentRobotMapData() {
      const mapData = { mapInfo: {}, navigationPoints: [], navigation: [] };
      mapData.mapInfo = await this.$api.get_current_robot_use_map();
      mapData.navigation = mapData.mapInfo.navigation
        ? JSON.parse(mapData.mapInfo.navigation)
        : [];
      mapData.navigationPoints =
        await this.$api.get_navigation_points_by_map_id({
          urlParams: { mapId: mapData.mapInfo.id },
        });
      return mapData;
    },

navigationChangeListener() {
      this.$bus.$on('TYPE_22', msg => {
        console.log(msg);
        if (msg.navigationPoints) {
          this.allPoints = this.allPoints.concat(msg.navigationPoints);
        }
        console.log(this.allPoints);
        if (msg.navigation) {
          this.allRoutes = JSON.parse(msg.navigation);
        }
        if (msg.ids) {
          this.allPoints = this.allPoints.filter(
            point => !msg.ids.includes(point.id)
          );
        }
      });
    },

国际化json下载接口，CORS错误（222上是好的）。问一下王杰国际化语言包的更新流程。可以找很多人沟通业务细节。国际化英文字符串应该包含空格吧？umi no export member:useModel.
部署标注的上一个下一个功能要不要有，模糊查询功能？要不要做分页，数据量多少。

绘制地图，Max(1200,500)半数；起点Y的显示不对？theme-defined-dark;导航点信息从接口到websocket返回；更新地图旋转角度：this.$api.update_map_rotate_angle;interface MapInfo /guard/map/maps-by-robot-id

updateChargePosition

```js
const THRESHOLD_TOOLBAR_CONFIG = [
  // {
  //   key: 'set',
  //   name: '三相检索',
  //   url: 'GET_POINT_PAGE_INFO',
  //   compName: 'searchThreeThreshold',
  // },
  {
    key: 'set',
    name: window?.getTargetName('global', 'connectionTesting'),
    url: 'CONNECT_DEVICE_MANAGEMENT',
    compName: 'clearThreshold',
  },
]
// compName的含义，改不了？

```

xm-web的telecom里面的console语句把密码console在控制台了。

国际化还有很多没配置好。

onlyVisi & onlyInf prop的添加

gitlabg-一键导航问题修复。

Uncaught (in promise) DOMException: Failed to read the 'buffered' property from 'SourceBuffer': This SourceBuffer has been removed from the parent media source.
    at MSEController._needCleanupSourceBuffer (<http://localhost:9002/umi.js:610694:37>)
    at MSEController.appendMediaSegment (<http://localhost:9002/umi.js:610576:64>)
    at EventEmitter.<anonymous> (<http://localhost:9002/umi.js:617470:31>)
    at EventEmitter.emit (<http://localhost:9002/umi.js:608995:15>)
    at <http://localhost:9002/umi.js:611224:32>
devScripts.js:6523 [MSEController] > Failed to execute 'appendBuffer' on 'SourceBuffer': This SourceBuffer has been removed from the parent media source.

<https://learn.xiaoma.com/annotation>

标杆项目的首页的机器人视频box，正在播放摄像头的视频。white-btn样式设置不生效。

<http://localhost:9002/stateGridApi/play/start/010110000103540001/010110000103060006>

还有红外视频流切换的那个bug，没有条件复现，看不到红外视频。实现自动选择deviceId的功能。models/robot,robotModel;点位列表里的第一条记录的deviceId为啥是Null？

3D地图的显示原理.国际化-components；

部署标注代码；3D地图的绘制代码；

Point{x:number,y:number},Segment{p1:Point,p2:Point} x1,y1,x2,y2 x3,y3,x4,y4 inside(),isIntersect(segment1,segment2),isInsegment(p,s,w)

ImageMarkProps-imgUrl,lineWidth,baseColor,hoverColor,fontSize,fontColor,shadowColor矩形和多边形的中心区域的颜色,originCursorState工具切换，鼠标状态切换;optionConf,restoreCursorState  Point(x,y),React(xy,y,w,h),HoverShape(circle,rect:number[],polygon:rectInner,polygonInner,rectLine记录 hover 的哪个矩形的哪条边,endPoint记录 hover 的哪个多边形的哪个顶点)

polygonIntersect(point,points) 判断多边形的新点是否在和之前的线段相交（包括重叠）;isIncircle(p:Point,c:Point,r:number)判断点是否在圆上; isInRectSide(point,rect:Rect,lineWidth)判断点是否在矩形上; isInRect判断在矩形内部; isInPolygonSide(p,polygon:Point[],w:number); isInPolygon; isInEndPoint判断多边形端点 hover;

const {markInfo,setMarkInfo}=useContext(ImageMarkContext)

canvasRef,wrapRef,pointArrRef:{x,y,type?:string}[]=markInfo.points 点记录，用于canvas重绘
rectArrRef,polygonArrRef,isDrawPolyygon当前是否正在绘制多边形，bgImgRef、zoomRatioRef缩放比例、hoverShapeRef {circle:[],rect,polygon,rectLine,endPoint,polygonInner,rectInner}.

isInDragRef 是否在拖动状态，对应两种 cursorType 为 drag 和 drag-move;selectWrapperRef 标注类型单选框对应的元素;isResetTypeRef 是否在右键重置标注类型状态;isCopiedRef 由于 onkeydown 会持续触发，所以需要加上一个锁;zoomStep0.05,lastType[]最后编辑的标注类型，0为点，1位矩形，2为多边形，主要是为撤销操作提供记录

cursorState''当前选择的编辑状态，rect 为矩形，pin 为点，paint 为多边形，era 为橡皮擦，'' 为默认;polygonMessage多边形弹窗文本；intersection画多边形时的交点信息;showSelect 多选框的显示; currentSelectShape 当前正在设置标注类型的图形;currentSelectType 当前选择的标注类型;previousCursorState记录上一个鼠标状态用来恢复（拖动状态结束后恢复到上一个鼠标状态）; isCtrlDown判断当前 ctrl 键是否按下

refreshMarkInfo() setMarkInfo({points:pointArrRef.current,rects:rectArrRef.current,polygons:polygonArrRef.current});resetMarkInfo();drawCircle(x,y)绘制圆点 ctx=canvasRef.current!.getContext('2d')!;ctx.beginPath() ctx.arc(Math.floor(x*zoomRatioRef.current),Math.floor(y*zoomRadioRef.current),lineWidth,0,Math.PI*2,true) ctx.fill() ctx.closePath()

drawSegment(p1,p2) ctx.moveTo(Math.floor(p1.x*zoomRatioRef.current)+.5,Math.floor(p1.y*zoomRatioRef.current)+.5) lineTo(p2...) drawRect(x,y,w,h,isDragMove?:boolean) ctx.strokeRect() ctx.save().strokeStyle='#000'.lineWidth=1 .strokeRect(x-1.5,y-1.5,w+4..).strokeRect(x+2.5,y+2.5,w-4,h-4).restore() if(isDragMove){.save().fillStyle=shadowColor .globalAlpha=.4 .fillRect(+2.5,+2.5,-4,-4).restore()}

drawPolygon(points,isLast,isDragMove)绘制多边形（多线段）for(0,i,len-1) drawCircle,drawSegment,拖动时显示阴影;drawText(p,txt) canvas 上添加每个标注的标注类型 .save().font=fontSize .fillStyle=fontColor .fillText().restore()

reDraw(cursorState?:string)清除画布并重绘 .clearRect(0,0,canvasRef.current!.width,h).drawImage(bgImmgRef.current,0,0,bgImgRef.current.naturalWidth,.naH,0,0,canvasRef.w,.h) pointArrRef.current.forEach(save drawCircle,drawText restore) rectArrRef.forEach 拖动矩形内部添加蒙层

polygonArrRef.forEach(重绘还未完成的多边形（不需要连接终点和起点）cursorState:pin-rect-paint 三种画图状态不高亮;可拖动状态扩大高亮响应范围;橡皮擦和默认鼠标在多边形边上的时候高亮;拖动多边形内部添加蒙层;重绘已经完成的多边形，需要连接起点和终点)

  useEffect(() => {
    pointArrRef.current = markInfo.points
    rectArrRef.current = markInfo.rects
    polygonArrRef.current = markInfo.polygons
    reDraw()
  }, [markInfo])

currentHoverShape(p)根据 mousemove 的坐标统计当前 hover 的图形（点，矩形，和多边形）

hoverCicle,hoverRect,hoverPolygon,hoverEndPoint,hoverRectLine,hoverPolygonInner,hoverRectInner;pointArrRef getRealLineWidth 多边形内部，用来拖动多边形 矩形内部，用来拖动矩形

handleKeyDown(e:RCKeyboardEvent) 处理输入 ctrl z 撤销;e.nativeEvent.ctrlKey&&e.nativeEvent.code==='KeyZ' if (!lastType.length) return // 如果当前没有任何标注直接return 如果撤销时标注类型框已经显示，将其隐藏 根据不同的 lastType 来进行撤销，点和矩形直接删除，多边形一次撤销各条边

const handleMousemove=throttle((e:MouseEvent)) 处理 mousemove, 主要是橡皮擦和节点拖动的样式改变，以及 hover 高亮效果 绘制多边形过程中不执行 mousemove 逻辑,拖动状态也不执行 mousemove 逻辑。

const screenScale=getScreenScale() let x=e.offsetX,y=e.offsetY

const hoverShape = currentHoverShape({x: x / zoomRatioRef.current, y: y / zoomRatioRef.current})

    const isHoverShapeChange =
      JSON.stringify(hoverShape.circle) !== JSON.stringify(hoverShapeRef.current.circle) ||
      JSON.stringify(hoverShape.rect) !== JSON.stringify(hoverShapeRef.current.rect) ||...

if (isHoverShapeChange) {
      hoverShapeRef.current = hoverShape

      // 当鼠标移动到可拖拽位置的时候改变鼠标状态（进入可拖拽状态），只有橡皮擦和多边形编辑状态是不能进行拖拽的
      if (cursorState !== 'era') {
      // 处理状态的连续改变

# DeployForm

装置选择deviceId、识别类型recognitionType、缺陷识别recognitionDefect、水平角度pan、垂直角度tilt、倍率zoom、焦距focus

获取信息onDeviceData-获取设备倍率位置信息：
const info=onCommonDeviceParam() // 获取云台控制基本参数
info.useMode=currentDevice.deviceType
info.ptzPos=onCommonPtzInfo() // {pan:formValue.pan,tilt,zoom,focus}
Api.POST_SET_DEVICE_PTZ({data:info})

```js
// onCommonDeviceParam
return { // photoInfo
usename:currentDevice.username,password,patrodeviceName,agreement,ip:
isInfraredType(pointData.recognitionType)?ipInfrared:ipVisible1||ipVisible2,//'26'
port,photoType:'红外' // '可见光'
}
```

设置云台onSetDevice、 设置设备倍率位置 ApiPOST_SET_DEVICE_PTZ

部署onDeploy

```js
if(hasDeployed)return setHasDeployed(false)
if(!deployParam||!deployParam.deviceTemplateImagePath)return message.error('请先拍照')
const ptzInfo=onCommonPtzInfo()
const jsonParam=JSON.stringify(ptzInfo)
const param={deviceId,recognitionType,deviceName,deviceParameter:jsonParam,recognitionDefect,deviceTemplateImagePath}
const res=Api.PUT_POINT_DEPLOYMENT_UPDATE({ data: param, urlData: [pointData.id] })
```

# MarkForm

参数配置
<ImagePreviewer imgUrl={recognizeImgUrl} />
腐蚀参数corrosion、直线选取lineSelection、检测直线detectionLine、最大量程maxRange

重置onReset()、

识别测试onRecogTest()、

```js
const recognitionResult = await Api.POST_POINT_IDENTIFY_TEST({
      data: {cameraPhotoImagePath: pointData.deviceTemplateImagePath,deviceTemplateImagePath,
      deviceId,recognitionType,imageLabelParameter:onGetMarkInfo()},
    })
const onGetMarkInfo=()=>{// 修改markInfo，数据结构来自于算法
  const markInfoStr=getMarkInfo()
  markInfoStr.child_label_data.forEach(item => {
      item.label_type = pointData.recognitionType
  })
  return JSON.stringify(...markInfoStr,materDataArray:[values.corrosion,detectionLine,lineSelection,maxRange])
}
// shit code获取标注组合信息
const getMarkInfo=()=>{
  const markData={child_label_data:[{}]}
}
```

保存标注onMark()

```js
if(hasMarked)return setHasMarked(false)
// 非高清照片处理
if (pointData.recognitionType !== HIGHLIGHT_PICTURE_TYPE) {
  if (!markInfoStr.child_label_data.length)return message.error('请进行标注后再保存')
  if (markInfoStr.child_label_data.length === 1) {
    const { bbox = [], pointer = [] } = markInfoStr.child_label_data[0]
    if (Array.isArray(bbox) && !bbox.length && Array.isArray(pointer) && !pointer.length)
      return message.error('请进行标注后再保存')
  }
}
// 开启缺陷识别，高清照片也需要标注
// ...
markInfoStr.child_label_data.forEach(item => {
  item.label_type = values.deviceType
})
Api.POST_POINT_INFO_MARK({
        data: {
          pointId: pointData.id,
          labelType: pointData.recognitionType,
          imageLabelParameter: param,
        },
      })
```

# 400c

## components

AdujustSize;AlarmModal-BeltAlarmModal,ElseAlarmModal,Annotation,Authorized,Calendar,CameraControlTable,CameraPreview,
CircleProgress,ColorPicker,ConfirmRollerModal,ConfirmModal,

# zhoubao

熟悉标杆项目的部署标注模块、

公共组件ConfirmModal,AlarmModal,CameraPreview,ConfirmRollerModal,DrawButton,Rocker等的国际化、

(国际化的准确的英文描述会比较长，样式上要加省略号和title，这个工作要在具体文案的显示的组件那里改;接口里的请求参数需要做国际化吗？比方说需要传select-option的value)

iPhone上可以访问luanpingapp域名，但是我的华为手机不行。模拟器都访问不了luanpingapp域名，

PowerShell开始延迟显示react-native的日志。。需要手动刷新。

axios比umi-request更好。

首页的列表在闪烁，是一个bug。

app瘦身。

# rn-upgrade

<https://react-native-community.github.io/upgrade-helper/?from=0.73.6&to=0.74.1>

yarn remove @react-navigation/material-top-tabs @react-navigation/drawer

rtsp://admin:sshw1234@192.168.20.40:554/h265/ch1/sub/av_stream&width=704&height=396&bitrate=800

rtsp://admin:sshw1234@192.168.20.41/live/chn0&width=704&height=396&bitrate=800

rtsp://admin:xm123456@192.168.0.63:554/h265/ch1/sub/av_stream&width=704&height=396&bitrate=800

rtsp://admin:xm123456@192.168.0.63/live/chn0&width=704&height=396&bitrate=800
rtsp://admin:xm123456@192.168.0.63:554/h265/ch2/sub/av_stream&width=704&height=396&bitrate=800

不要自动触发onEndReached。。no need to add FlatList-Loading;websocket不断重连的原因。。

分页还有问题。。websocket一定要连接上；；

utils-robotVideoMessage注释掉mockData；

调试的时候也不能卡！！不然一般来讲都是bug

有点卡；很卡，必须解决。切换设备状况-环境监测-任务概况很慢、切换实时巡检-点位告警-静默巡检（需要等待不分页的请求）。transformToRequest catch [SyntaxError: JSON Parse error: Unexpected character: <];

分页必须弄，而且必须弄好。

yarn1 yarn3 node14 node18

<13611782678@163.com>
123456789
gitlab账号

443,8086

024/05/17 09:25:06 [crit] 1423987#1423987: *714307 SSL_do_handshake() failed (SSL: error:14094458:SSL routines:ssl3_read_bytes:tlsv1 unrecognized name:SSL alert number 112) while SSL handshaking to upstream, client: 182.98.145.241, server: papmp.techxiaoma.com, request: "GET /login HTTP/1.1", upstream: "<https://182.61.133.199:8081/login>", host: "papmp.techxiaoma.com"

systemctl restart nginx

 [{"alertLevel": 5, "alertLevelChin
ese": null, "area": null, "createTime": null, "creator": null, "exceptionValue": "24.1", "e
xceptionalItem": "temperature", "id": null, "isRead": 0, "robotId": null, "roomId": 12, "ti
me": 1715927079745, "updateTime": null, "updator": null}, {"alertLevel": 5, "alertLevelChin
ese": null, "area": null, "createTime": null, "creator": null, "exceptionValue": "0.0", "ex
ceptionalItem": "smoke", "id": null, "isRead": 0, "robotId": null, "roomId": 12, "time": 17
15927079747, "updateTime": null, "updator": null}, {"alertLevel": 5, "alertLevelChinese": n
ull, "area": null, "createTime": null, "creator": null, "exceptionValue": "0.0", "exception
alItem": "ch4", "id": null, "isRead": 0, "robotId": null, "roomId": 12, "time": 17159270797
48, "updateTime": null, "updator": null}, {"alertLevel": 5, "alertLevelChinese": null, "are
a": null, "createTime": null, "creator": null, "exceptionValue": "41.8", "exceptionalItem":
 "humidity", "id": null, "isRead": 0, "robotId": null, "ro

地图绘制很慢。。ERROR  Warning: Maximum update depth exceeded. This can happen when a component calls setS
tate inside useEffect, but useEffect either doesn't have a dependency array, or one of the
dependencies changes on every render.

TreeView渲染很慢，甚至第一次没成功渲染。展开时特别地慢，不知道为啥。。怎么解决？？
transformToRequest catch [RequestError: timeout of 60000ms exceeded] <https://luanpi>
ngapp.techxiaoma.com/api/global-alert/get-unread-robot-exceptions {"limit": -1, "page": 1}
{"data": {"limit": -1, "page": 1}, "dataType": "json", "params": {}}
rn-for-input-string-undefined;
react-native密码输入框输入时不响应;

EventBus在useEffect里的return里没有off成功。HistoryData里面的List少了最后一条数据

公共组件ConfirmModal,AlarmModal,CameraPreview,ConfirmRollerModal,DrawButton,Rocker等的国际化、

(国际化的准确英文描述会比较长，样式上要加省略号和title，这个工作要在具体文案的显示的组件那里改;接口里的请求参数需要做国际化吗？比方说需要传select-option的value)

可以随时用nvm来切换Nodejs版本，保持adb服务一直保持着，太方便了。audit.tsx样式调整。借助有道词典来做国际化时，挑最精简的句子。

国际化已有的骆驼式单词太多，不方便更改，先把未完成的国际化工作弄好。*设备点位树和recognitionTypeEnum，后端没做国际化（Api.GET_ENUMS_ALL({data: {language: key}})接口没返回响应）*;api.open(???)--Map configuration;400c\src\pages\RobotControl\containers\ControlPanel\index.tsx 还没做国际化，因为很多代码注释了。device-regions,intervals,types；tree-param接口都要做好国际化;start-video接口调用失败(因为视频流接口不是用的滦平现场的视频流数据)；

从控制中心页面切换到其他页面，还是存在崩溃问题；PersonalCenter；粉尘；上下左右按键点击后的崩溃问题；录像有时候成功，有时候录像失败，并且录像时长秒数不更新到界面；

*TaskConfModal Line545全面巡检*
国际化显示成message弹窗的话，会尽量用准确的中等长度的句子表达；而在界面上显示的是缩写版、以及title的完整版，当然，尽量都用准确、精简的词汇来表达。从控制中心也没切换到其他页面时，还是会有卡顿问题。

react-native-libs-ws Unsupported data type.

handleRockerPress up 5 {"code": 10, "command": 1, "type": 2, "value": {"linear_vel": 1, "value": 0}} undefined

{"chargePointInfo": "NULL", "code": 92, "connection": "1", "controlMachineIp": "192.168.20.92", "controlMachinePort": "6688", "createTime": 1715136561000, "creator": "admin", "electricityStatus": false, "id": 10, "infraredCameraIp": "192.168.20.41", "infraredSize": "384,288", "label": "MG-400C", "mapId": 26, "mileage": 1864684785, "name": "MG-400C", "ptzType": 2, "sceneType": 10, "status": 1, "threshold": null, "updateTime": null, "updator": "admin", "value": 10, "videoPort": "6689", "visibleCameraPassword": "sshw1234", "visibleCameraUsername": "admin", "visibleIp": "192.168.20.40", "visibleSize": "1920,1080", "yuntaiPort": "8000"} rtsp://admin:sshw1234@192.168.20.40:554/h265/ch1/sub/av_stream&width=704&height=396&bitrate=800 rtsp://admin:sshw1234@192.168.20.41:554/live/chn0/&width=704&height=396&bitrate=800

网页访问不稳定，，

国际化枚举接口还未完成，比如thresholdEnum;安防告警历史信息查询里的摄像头选项还是片区？cameraList or cameraIpList？

还有推流服务是不是要透传到公网，现在推流服务在4G网络访问不了，播放器软件打开不了rtsp的两个地址。

400c\src\pages\Manage\modal\PointMarkModal.tsx Line605:
                  required: props.row.recognitionTypeName !== '红外识别',

右边按钮组点了没反应。地图点渲染在边界上的问题；

172.16.48.2

# gitlab

guo_nc xiaoma123456

<https://xllsctb.xiaoma.com/api/file/upload/2>

多边形outline使用不当，不能勾选rectangle，怎么过滤，或者说增加一个name-value匹配对？？

为啥不是分两次绘制两个矩形或者多边形？<http://192.168.20.68/api/equipment-model/device-types>
双光谱摄像机、球型摄像机、高清型摄像机、皮带撕裂摄像机。
我怀疑所有的cameraList或者cameraIpList对应的都是片区选项列表？？实时巡检、静默、点位告警、安防历史的筛选项，都要逐个确认。。

papmp项目的二维码登录配置文档？？；恢复到滦平网络环境后，APP的Home和ControlCenter页面卡住了。

电信项目视频流出不来（重启机器人后就好了）；OKR填写；

this.$refs.waiting.(vue2) 跨组件通信。

flvjs [MSEController] > Failed to execute 'appendBuffer' on 'SourceBuffer': This SourceBuffer has been removed from the parent media source.  autoCleanupSourceBuffer attachMediaElement createPlayer

增加实时巡检、静默巡检、点位告警、安防告警历史信息的摄像头筛选条件，解决其中的下拉项列表延迟显示问题;ws://xllsctb.xiaoma.com:8085/guard/ws/asset/296807a1-be99-4082-b4ee-c76f7826a08c 在全局代理开启时访问不通；

# 周报

四棵树项目：
修复缺陷：系统默认页面显示监控大厅页面，默认显示九个相机画面；
修复缺陷：模型配置页面的监控区域树查询的不对，应该是台账管理的装置树信息；
修复缺陷：模型训练表格没有设置内边距，整体高度确认下是否和模型配置页面表格高度一致
修复缺陷：开始训练弹窗-训练对象没有显示；
修复缺陷：开始训练弹窗-每张图片右上角给个代表是否标注过的标识；
修复缺陷：模型训练提示词优化，训练进度未读条显示，训练进度条样式优化；

滦平项目：
声光告警弹窗的样式优化

标杆项目；
修复缺陷：Select组件已选项可清除的icon样式优化；
修复缺陷：任务编辑弹窗界面样式优化；
修复缺陷：后台管理-添加机器人，页面出现错误；

电信的站端项目：

下周计划：
根据现场服务修复四棵树项目的功能缺陷

站端项目：
通过观摩xm-web源码，来学习vue2的框架设计与使用，并了解站端业务代码细节

站端项目、OKR项目：
通过观摩xm-web和papmp-web的源码，来学习vue2和vue3的框架设计与使用
标杆项目
修复缺陷：首页-巡检实时信息右键点击行走到此按钮机器人并没有到该点位当中去；

媒体可能包含图片也可能包含视频或者音频。

人工上报要支持两类视频流组件;build在前，git push在后，并且两者是一对多的关系。

四棵树模型配置页面。接口地址 /guard/hikSecurityPlatform/getCamerasPreviewURLs/{cameraIndexCode}/{protocol}/{beginTime}/{endTime}

type===4 海康安防平台；联调完模型编辑和视频流type===4；点击录像右侧组件会刷新成

四棵树项目暂时不考虑国际化代码; 滦平的rtsp流没有做穿透，APP上播放不了。

控制中心：请勾选您要选择的设备;开始训练点击后页面白屏 reading property 'component' of undefined

```js

                        backgroundColor: "#52c41a"
                    },
                    offset: [5, -14]
                }), "global-alram" === e.tabsTypes && x.a.createElement(B, {
                    style: {
                        display: d[t.value] ? "inline-block" : "none",
                        left: "2" === t.value ? "83px" : "66px"
                    }
                }, d[t.value] > 99 ? "99+" : d[t.value])))), "global-alram" === e.tabsTypes && x.a.createElement(M, {
                    onClick: f
                }, null === (t = window) || void 0 === t ? void 0 : t.getTargetName("global", "read")), "global-alram" === e.tabsTypes && x.a.createElement(R, {
                    onClick: b
                }, null === (n = window) || void 0 === n ? void 0 : n.getTargetName("global", "refresh")), "global-alram" === e.tabsTypes && "2" !== s && x.a.createElement(j, {
                    title: null === (r = window) || void 0 === r ? void 0 : r.getTargetName("global", "historicalInformation"),
                    onClick: I
                }, null === (i = window) || void 0 === i ? void 0 : i.getTargetName("global", "historicalInformation")))), x.a.createElement(k, null, a.filter((e=>e.value === s))[0].component))
            }
            ;
            t["a"] = L
        },
        qCM6: function(e, t, n) {},
        qDJ8: function(e, t, n) {
            "use strict";
            e.exports = function(e) {
```

四棵树项目的视频流组件开发，遇到没调用视频流地址的问题，是一个较严重的阻碍性问题，找到实际的主要原因是，视频流服务的启动问题、以及视频流联调性问题；以后需总结相关教训，熟悉好视频流系统的相关细节；但总体上在四棵树项目上负责的需求实现较多，态度较为严谨认真。

新增声光报警的弹窗里面，有部分文字看不到。

在四棵树项目上负责的需求实现较多，负责的滦平项目音频分析功能已完成，支持了站端项目的电信客户方需求，个人成长方面完成度较高；总体上工作态度较为严谨认真。

述职报告上会遇到的提问：新疆四棵树项目视频流出不来的问题、新疆国投罗钾反复更换菜单、APP开发的视频播放问题--为什么播放不了websocket地址形式的视频流、电信的站端项目……等问题

需要更细致细心的处理工作任务；三维地图的原理和实现方案优化；ws://192.168.10.32:559/openUrl/

确实会遇到一些业务上或者系统流程上不太熟悉的问题，但是我觉得是小细节问题，或者说主要问题不是我这边的代码问题，而且不会造成阻塞性影响。 人工上报的样式调整；222:8095是不是没启动，或者说debugger了，服务访问时页面都卡住了。

xm-web\src\views\result-confirm\report-generate\index.vue：xm-web.md

1,2;四棵树的监控大厅页面的双向联动失效；

滦平的监控大厅视频有时候播放不出来，是play-useE和indexes的比较逻辑有问题导致;任务展示白屏，没找到不调相应接口的代码层原因

地图实现方案
<https://echarts.apache.org/examples/zh/editor.html?c=heatmap-bmap> <https://echarts.apache.org/examples/zh/editor.html?c=lines-bmap> <https://echarts.apache.org/examples/zh/editor.html?c=map-bar-morph>

```js
{
  series:[
    {
      type:'map',
      mapType:'china',
      label: {
        show:true,
        textStyle:{color:'blue'}
      },
      emphasis:{
        label: {
          show:true,
          textStyle:{color:'blue'},
        },
        itemStyle:{borderWidth:.5,borderColor:'#4b0083',areaColor:'#ffdead'}
      }
      zoom:1.2,aspectScale:0.75,
      itemStyle:{borderWidth:.5,borderColor:'#009fe8',areaColor:'#ffefd5'},
      data:[{name:'新疆',selected:true,value:1}]
    }
  ],
  dataRange:{splitList:[{start:1,end:1,label:'新疆',color:}]}
}
```

需确认哪些数据图表的展示要用上新接口，以及对应的数据格式？？哪些是已有接口？？

首页总览就是数据看板吗？需要调整位置、以及删除其中一个吗？

```js
$.get(ROOT_PATH + '/data/asset/data/hangzhou-tracks.json', function (data) {
  const lines = data.map(function (track) {
    return {
      coords: track.map(function (seg, idx) {
        return seg.coord;
      })
    };
  });
  myChart.setOption(
    (option = {
      backgroundColor: 'transparent',
      bmap: {
        center: [84.6785,44.4356],
        regions: [{
            name: '新疆',
            itemStyle: {
                areaColor: 'rgb(176, 227, 255)',
                color: 'white',borderColor:'#008DFF'
            }
        }],
        zoom: 14,
        roam: true,
        mapStyle: {
          styleJson: [
            {
              featureType: 'water',
              elementType: 'all',
              stylers: {
                color: '#d1d1d1'
              }
            },
            {
              featureType: 'land',
              elementType: 'all',
              stylers: {
                color: '#f3f3f3'
              }
            },
            {
              featureType: 'railway',
              elementType: 'all',
              stylers: {
                visibility: 'off'
              }
            },
            {
              featureType: 'highway',
              elementType: 'all',
              stylers: {
                color: '#fdfdfd'
              }
            },
            {
              featureType: 'highway',
              elementType: 'labels',
              stylers: {
                visibility: 'off'
              }
            },
            {
              featureType: 'arterial',
              elementType: 'geometry',
              stylers: {
                color: '#fefefe'
              }
            },
            {
              featureType: 'arterial',
              elementType: 'geometry.fill',
              stylers: {
                color: '#fefefe'
              }
            },
            {
              featureType: 'poi',
              elementType: 'all',
              stylers: {
                visibility: 'off'
              }
            },
            {
              featureType: 'green',
              elementType: 'all',
              stylers: {
                visibility: 'off'
              }
            },
            {
              featureType: 'subway',
              elementType: 'all',
              stylers: {
                visibility: 'off'
              }
            },
            {
              featureType: 'manmade',
              elementType: 'all',
              stylers: {
                color: '#d1d1d1'
              }
            },
            {
              featureType: 'local',
              elementType: 'all',
              stylers: {
                color: '#d1d1d1'
              }
            },
            {
              featureType: 'arterial',
              elementType: 'labels',
              stylers: {
                visibility: 'off'
              }
            },
            {
              featureType: 'boundary',
              elementType: 'all',
              stylers: {
                color: '#fefefe'
              }
            },
            {
              featureType: 'building',
              elementType: 'all',
              stylers: {
                color: '#d1d1d1'
              }
            },
            {
              featureType: 'label',
              elementType: 'labels.text.fill',
              stylers: {
                color: '#999999'
              }
            }
          ]
        }
      },
      series: [
        // {
        //   type: 'lines',
        //   coordinateSystem: 'bmap',
        //   data: lines,
        //   polyline: true,
        //   lineStyle: {
        //     color: 'purple',
        //     opacity: 0.6,
        //     width: 1
        //   }
        // }
      ]
    })
  );
});
```

```js
{
    "createTime": 1716193371000,
    "creator": "admin",
    "updateTime": 1716343813000,
    "updator": "admin",
    "id": 71,
    "stationName": null,
    "stationCode": null,
    "patrolDeviceName": "#1皮带尾部皮带撕裂装置",
    "maxZoom": 32,
    "patrolDeviceCode": null,
    "deviceModel": null,
    "manufacturer": "2",
    "useUnit": null,
    "deviceSource": null,
    "productionDate": null,
    "productionCode": null,
    "isTranPort": null,
    "useMode": null,
    "videoMode": null,
    "place": null,
    "type": null,
    "patrolDeviceInfo": null,
    "robotsCode": null,
    "status": 1,
    "ipAddress": "192.168.20.34",
    "port": null,
    "password": "xm123456",
    "userName": "admin",
    "connection": true,
    "cameraType": 3,
    "numberOfPoints": 0,
    "silentStatus": 0,
    "silentLastExecutionTime": null,
    "whetherSilent": null,
    "substation": null,
    "deviceType": "摄像头",
    "zoneId": 12,
    "region": "#1皮带",
    "intervals": "#1皮带尾部",
    "whetherSupportFocusing": null,
    "sipServiceId": null,
    "sipServiceDomain": null,
    "sipServerAddress": null,
    "sipServerName": null,
    "sipUserAuthenticationId": null,
    "sipServerPassword": null,
    "linkageEquipmentStatus": 0,
    "infraRedIpAddress": null,
    "visibleUrl": null,
    "infraredUrl": null,
    "infraRedIpPortAddress": null,
    "intervalTime": null,
    "ipPortAddress": "192.168.20.34"
}
```

改造getVideoData，把引用CameraPreview的地方，改造成引用CameraPreviewFlv；JSMpeg和flvjs的区别是啥？需要更换吗？

滦平的机器人是双视摄像头，ip不一样的可见光和红外地址；摄像头是海康摄像头，ip一样channel通道不一样。

使用橡皮擦清除线段的功能，暂时不加；changeTool和originCursorState在不同标注组件内部的相关逻辑区分是啥样的？线段标注类型暂不支持橡皮擦擦除功能，实现起来有点难。

思考半自动标注实现方案及其原理。AI矿山视频监控系统/输送带AI风险管控系统;mk-project的transformMarkInfo针对多边形、箭头、圆点的显示；

人工审核弹窗里是照片？不是视频？数据看板里有没有人工审核？

四棵树和标杆项目的角色管理里面的国际化完善；滦平项目里面的标注下表格行白色背景。

滦平项目：
视频流优化：解决卡顿问题，采用flv.js播放ws-rtsp地址的视频
样式优化：模块框关闭icon 水平居中
添加标注工具的选中态样式

标杆项目：
样式优化：模块框关闭icon的背景色从半透明改至先前的浅色状态，与标题栏深背景色适应
修复标注组件初始化时的标注工具选中后无法操作的问题，添加标注工具的选中态样式
样式优化：监控大厅右侧告警列表可滚动

薛凯，你之前说标注组件要新增箭头类型，不就是圆点标注类型的功能吗？

站端项目：
通过观摩xm-web源码，来学习vue2的框架设计与使用，并了解站端业务代码细节

站端项目、OKR项目：
通过观摩xm-web和papmp-web的源码，来学习vue2和vue3的框架设计与使用

验证get请求的参数拼接问题和接口返回的数据准确性方面。

Line 1012;多条线段的绘制和删除（还没有和AI同事对接好）；搞清楚hoverShapeRef.current.lineSegment的确切含义；

rectArrRef forEach #Object报错

*觉得以前的代码写得比较复杂后，就加代码，所以说，读代码比写代码更难许多，因为这些代码是经过许多人写出来的，整体上不一定写得好，但是能用。*

vscode给文件夹改名字卡住了；

查看政樑最近开发的标杆项目上的新功能；标杆APP：开发机器人控制和摄像头控制组件；新功能：机器人一键重启；超声波避障开关；首页和控制中心界面的功能实现，流程和细节要和滦平区分开。

7.27加班内容：协助政樑搭建标杆APP的react-native开发环境；开发控制中心界面的部分组件代码；峰峰还没有和政樑完全确认APP的设计细节，所以不想写代码；让政樑开发标杆APP的语音对讲、超声波避障、机器人一键重启这些功能；

修改toggleCameraChannel，或者干脆去掉这个方法？

切换videoUrl或infraredVideoUrl时，需不需要destroy VLCPlayer？？

pc端和APP端功能差异化？ 首页的任务列表；

recognition_info_desc(ription);labelLayout;柱状图hover显示有问题;视频记录没居中；默认展示最新视频流还是不展示？222-fourtrees：<http://192.168.0.222:8611/login?redirect=http%3A%2F%2F192.168.0.222%3A8611%2Fdata-board>

机器人控制、摄像头控制的功能调试和样式调整。app不想弄的太复杂，目前缺失国际化功能。所有历史信息的摄像头选择项 没作用，找志强改一下。

接收不到一部分websocket消息；后端JAVA对接Google-firebase的远程消息推送
{"a": 0, "x": "25", "y": "25", "z": 0};小车位置没有渲染出来？？引导页显示逻辑有问题

{"label": undefined, "value": undefined}问题；首次不加载实时巡检列表；enums未加载；没有正确执行引导页逻辑；

wss://xllsctb.techxiaoma.com/api/ws/asset/67ea8587-8361-4a83-90af-3bf067737c27

```js
{
  "retAction": "infoPush",
  "deviceSn": "xm01-b1868021-3f",
  "uuid": "59a67d8fa4bec00ec3bceb8b21a8c4aa",
  "data": {
    "warnCode": [],
    "errorCode": [],
    "robot": {
      "taskStatus": 0,
      "speed": 0,
      "position": -0.05
    },
    "ultrasonic": {
      "front": 9.99,
      "after": 1.17
    },
    "battery": {
      "level": 99,
      "voltage": 53.31,
      "current": 0,
      "temp": 40.5,
      "charge": false,
      "warn": null,
      "singleVoltage": [
        4,
        4,
        4,
        4,
        4,
        4,
        4,
        4,
        4,
        4,
        4,
        4,
        4
      ]
    },
    "environment": {
      "pm2_5": null,
      "pm10": 29,
      "smoke": 0,
      "temp": 37.5,
      "humidity": 50.8,
      "co": 1,
      "nh3": 0,
      "ch4": 0,
      "h2s": 0,
      "fault": 0
    },
    "pcb": {
      "temp": 48.62
    },
    "pressure": {
      "pressure": 0.62
    },
    "motor": {
      "stopButton": false,
      "busVoltage": 53,
      "status": 13,
      "current": null,
      "speed": null,
      "fault": null
    },
    "charge": {
      "openClose": true,
      "voltage": 54,
      "current": 0.5,
      "fault": 0
    },
    "rfid": {
      "label": "02000000",
      "status": true
    }
  }
}

// robot-position：-0.05 小车图标显示出来了
```

socket {"data": "{\"type\":0,\"responseId\":\"4ee22da9-aee9-4d4b-b3ad-8a35761f4895\",\"message\":null}", "isTrusted": false} wss://xllsctb.techxiaoma.com/api/ws/asset/4ee22da9-aee9-4d4b-b3ad-8a35761f4895

{"type":0,"responseId":"2141bb8a-97f7-4f6a-b700-702cb3a6c96a","message":null}

WebSocket error: {"isTrusted": false, "message": null}
WebSocket error: {"isTrusted": false, "message": "CLEARTEXT communication to xllsctb.techxiaoma.com not permitted by network security policy"} https-ws
techxiaoma.com login-suc;xiaoma.com login-fail;switchChannelWhite宽高;当前设备的显示有问题；

340*500/1600=106.5 0.2125 3.1986,3.2;首页的enums初始化时，有时候出不来。

xAxis: [
                        {
                          minInterval: 3600 *24* 1000,
                          boundaryGap: ['5%', '10%'],
                          name: '时间',
                          type: 'time',
                          axisLine: {
                            lineStyle: {
                              color: '#00AFFF',
                            },
                          },
                          nameTextStyle: {
                            color: '#FFFFFF',
                            fontSize: '14px',
                            verticalAlign: 'top',
                            align: 'right',
                            padding: [9, 0, 0, 0],
                          },
                          axisTick: {
                            show: false,
                          },
                          axisLabel: {
                            color: '#FFFFFF',
                            fontSize: '12px',
                          },
                          axisPointer: {
                            label: {
                              formatter: function (params) {
                                let date = new Date(params.value)
                                let day = date.toLocaleString()
                                return '时间：'+day
                              },
                            },
                          },
                        },
                      ],
                      yAxis: [
                        {
                          type: 'value',
                          boundaryGap: ['0%', '20%'],
                          show: true,
                          position: 'left',
                          alignTicks: true,
                          axisLine: {
                            show: true,
                            lineStyle: {
                              color: '#00AFFF',
                            },
                          },
                          nameTextStyle: {
                            color: '#FFFFFF',
                            fontSize: '14px',
                            align: 'right',
                            padding: [0, 8, 0, 0],
                          },
                          axisLabel: {
                            color: '#FFFFFF',
                            fontSize: '14px',
                          },
                          splitLine: {
                            lineStyle: {
                              color: 'rgba(24, 161, 240, 0.1)',
                              type: 'dashed',
                            },
                          },
                        },
                      ],
                      series: [
                        {
                          type: 'line',
                          itemStyle:{color:({dataIndex})=>${grades.current}[dataIndex] === 5 ? '#4FE952' : '#FFBB5A'}
                          areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                              {
                                offset: 0,
                                color: '#0083ff',
                              },
                              {
                                offset: 1,
                                color: '#0013ff',
                              },
                            ]),
                          },
                          emphasis: {
                            focus: 'series',
                          },
                          showSymbol: false,
                          smooth: true,
                          data: ${dataset},
                        },
                      ],
                    },
                    dataZoom: [{
                      type: 'slider',
                      start: 0,
                      end: 100
                    }]

                          itemStyle:{color:({data})=>data[2] === 5 ? '#4FE952' : '#FFBB5A'}

areaStyle: {
                      color: 'linear-gradient(#0083ff,#0013ff)',
                    },

xAxis: [
                        {
                          minInterval: 3600 *24* 1000,
                          boundaryGap: ['5%', '10%'],
                          name: '时间',
                          type: 'time',
                          axisLine: {
                            lineStyle: {
                              color: '#00AFFF',
                            },
                          },
                          nameTextStyle: {
                            color: '#FFFFFF',
                            fontSize: '14px',
                            verticalAlign: 'top',
                            align: 'right',
                            padding: [9, 0, 0, 0],
                          },
                          axisTick: {
                            show: false,
                          },
                          axisLabel: {
                            color: '#FFFFFF',
                            fontSize: '12px',
                          },
                          axisPointer: {
                            label: {
                              formatter: function (params) {
                                let date = new Date(params.value)
                                let day = date.toLocaleString()
                                return '时间：'+day
                              },
                            },
                          },
                        },
                      ],
                      yAxis: [
                        {
                          type: 'value',

                        },
                      ],
                      series: [
                        {
                          type: 'line',
                          itemStyle:{color:({data})=> data[2] === 5 ? '#4FE952' : '#FFBB5A'}
                          areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                              {
                                offset: 0,
                                color: '#0083ff',
                              },
                              {
                                offset: 1,
                                color: '#0013ff',
                              },
                            ]),
                          },
                          emphasis: {
                            focus: 'series',
                          },
                          showSymbol: false,
                          smooth: true,
                          data: ${[[1730509276000,100,5],[1730519276000,200,4],[1730529276000,100,4]]},
                        },
                      ],
                    },

 {"agreement": 1, "ip": "192.168.0.45", "password": "xm123456", "patroldeviceCode": 12, "patroldeviceName": "MG-420-01", "photoType": "可见光", "port": 8000, "username": "admin"} {"data": {"agreement": 1, "ip": "192.168.0.45", "password": "xm123456", "patroldeviceCode": 12, "patroldeviceName": "MG-420-01", "photoType": "可见光", "port": 8000, "username": "admin"}, "dataType": "json", "params": {}}

 <https://xllsctb.techxiaoma.com/sdk/cameraCtrl/voiceIntercom> {"agreement": 1, "ip": "192.168.0.110", "password": "xm123456", "patroldeviceCode": 12, "patroldeviceName": "MG-420-01", "port": 8000, "username": "admin"} {"data": {"agreement": 1, "ip": "192.168.0.110", "password": "xm123456", "patroldeviceCode": 12, "patroldeviceName": "MG-420-01", "port": 8000, "username": "admin"}, "dataType": "json", "params": {}}
 LOG  interceptors.req af5c67bd-c6d4-4b0b-80dc-28f6cccaefc1 http

 88 您好，我开发了一个react-native APP，要在页面当中播放公司购买的海康摄像头视频流，有个语音对讲功能，请问这个目前有实现方案吗？安卓sdk的不能集成吧，我看了里面很多安卓代码和配置，不能用在react-native？

 LOG  interceptors.req {"clientId": "af5c67bd-c6d4-4b0b-80dc-28f6cccaefc1", "config": {"credentials": "include", "data": {"id": 15, "value": 0.52}, "dataType": "json", "headers": {"Content-Type": "application/json", "clientId": "af5c67bd-c6d4-4b0b-80dc-28f6cccaefc1"}, "method": "post", "params": {}, "timeout": 60000, "url": "<https://xllsctb.techxiaoma.com/api/equipment-info-imaging/set-focus"}>,

"intelligentAnalysis":"智能分析",intelAnalysis;

# ip-cfg

ipv4：192.168.0.36,84 192.168.20.37
ipv4子网掩码：255.255.255.0；ipv4默认网关：192.168.20.1、192.168.0.1；ipv4 dns服务器：114.114.114.114。

# 国际化和主题设置

新增代码时，要同时考虑到这两方面，代码要写好

# x-iis-ctb-ii

在供应链管理中，CTB是"Cost To Build"的缩写，意为制造成本。 这是指生产一个产品所需的所有直接和间接成本的总和，包括原材料、人工、设备折旧等。 这个指标对于企业制定价格策略和产品成本控制非常重要。

首页的实时信息显示暂时搁置；告警消息、媒体中心；点位跑任务调通、点位部署；静默相关的接口都有变动；部署标注页面没有拍摄照片时给出提示标注容器内的提示文案。部署点位必须严格按步骤填写吗？

标杆APP更新相应的标杆二期内容；

```js
const annoInfo = {
  img_size:[1200,800],
  shapes:[
    {shape_type:'rect',coor:[[100,100],[200,200]],label:'l_rect',label_cn:'左边框'},
    {shape_type:'rect',coor:[[300,100],[400,200]],label:'r_rect',label_cn:'右边框'},
    {shape_type:'line',coor:[[100,100],[100,200]],label:'l_edge',label_cn:'左边缘'},
    {shape_type:'line',coor:[[200,100],[200,200]],label:'r_edge',label_cn:'右边缘'},
    {shape_type:'polygon',coor:[[200,100],[200,200]],label:'l_polygon',label_cn:'左多边形'},
    {shape_type:'polygon',coor:[[200,100],[200,200]],label:'r_polygon',label_cn:'右多边形'},
    {shape_type:'circle',coor:[100,100],label:'l_point',label_cn:'左圆点'},
    {shape_type:'circle',coor:[200,100],label:'r_point',label_cn:'右圆点'}
  ],
  threshold:6,
  alarmContent:['水煤','大块煤']
}
[
    {
        "shape_type":"point",
        "labels":[
            {
                "label_code":"r_min",
                "label_name":"最小量程"
            },
            {
                "label_code":"r_max",
                "label_name":"最大量程"
            },
            {
                "label_code":"center",
                "label_name":"中心点"
            }
        ]
    },
    {
        "shape_type":"line",
        "labels":[
            {
                "label_code":"l_rect",
                "label_name":"左边缘"
            },
            {
                "label_code":"r_rect",
                "label_name":"右边缘"
            }
        ]
    }
]

label和label_cn可通过前置接口查询特定识别算法对应的下拉框类别信息，另外可按照不同的识别算法，限定使用不同的标注形状，无法使用限定以外的形状来标注，形状的限定可以和labels一起通过接口返回。
```

tilt,pan,zoom,focus,recognitionType,recognitionDefect,focus,executeType,oasEnable,oasDistance,corrosion,detectionLine,lineSelection,maxRange

部署标注页面涉及到recognitionType的接口是否都需要改名？

调试部署标注页面和自动标注流程。

WebSocket error: {"isTrusted": false, "message": "java.security.cert.CertPathValidatorException: Trust anchor for certification path not found."}

zejingit-app\android\app\src\main\res\xml\network_security_config.xml

国际化长单词串纠正工作;LINKAGE_TASK_DETAIL;ImageList;标杆app看不到视频流（222:8004）;模拟器切换页面时有点卡顿；app的审核页面底部的提交按钮，在模拟器上只能看到一部分。

悬浮的两层菜单；

你要是绩效给我打C，我表示不服，我在这一两个礼拜干的活比较多，包括：视频流组件可见光、红外的拍照、录音、录像功能实现；还有后台管理-部署标注；标注组件支持适配不同识别类型的标注要求；AI配置管理国际化配置；图片列表放大查看器；官网二期-在线留言模块开发；告警模块的推送和设置功能；海康摄像头的焦距锐度等信息的查询和修改；

而且前端实现界面时，需要同时考虑主题适配和国际化配置这些细节，我把四棵树代码适配到标杆二期，国际化改动也比较繁琐耗时间。

你说的一些小问题是因为后来自己的代码改动，字符串书写错误导致；或者是认为有的页面想等到能对接口的时候再开发；而且标杆二期的任务量比较大，应该分阶段测试，让测试人员提前介入才行，完全靠开发自测不太靠谱。

工作上的优先级很重要，其他优先级低的细节不要弄，因为还有更重要的东西要弄，没弄完没弄好领导就会吊死你。

标注组件有点卡顿的样子，是否跟robotModel、controlModel有关系？？官网配置接口有关图片的配置；1920-1200-765-375渐进性适配；

recognitionResultToCN；defectResult;defectResultImage;recognitionStatusEnum没有出现；Number(recognitionCode) === 37;recognitionCode === 37

学习并熟悉nginx配置前端服务等相关知识;

告警Notification当中的alarmInfoId怎么传递到告警界面的接口当中去？

新增mock的fetch接口、以及增加useStateData，并设置初始值为相对应的mockData;

告警信息表格字段名；首页的‘严重告警’

甘特图调研，需求是什么样的？简单点还是复杂点，复杂点的版本可能要收费。。 <https://wenku.csdn.net/answer/1u5nvouq22>  甘特图的实际和计划两种情况。

根据思维导图拆解任务；调研一下思维导图组件;

<http://192.168.0.222:8848/nacos/index.html#/serviceDetail?name=service-okr&groupName=service>

ipcp-dev:<http://192.168.0.222:8060/swagger-ui/index.html?urls.primaryName=service-okr>

*以后只要有峰峰、政樑、张成他们三人中的一人加班，那我也跟着一起加班，一起帮忙；写总体代码之前先看懂、整理好思维导图和系统架构图*

# 呼图壁输煤廊道光纤听诊

不需要@xiaoma/three-track，因为机器人没有介入光纤设备装置图当中，该项目的重心是设备，没有机器人和摄像头。

400c/src/pages/ThreeMap/index.tsx

弄清楚umi的框架结构各个组成部分；从零开始搭建一个umi-max-pnpm项目；

## 首页

- 设备树+3D地图；
- 告警列表：

字段：：
  告警事件
    告警等级：预警、一般、严重、危急
    告警类型：皮带托辊、设备倾斜、高温报警
  告警位置、告警设备、发生时间

  告警信息
    倾角：3D示意图+告警值+阈值
    光纤：音频图谱

## 设备管理

- 光纤主机：主机IP地址、主机端口号、传感器地址、所属皮带Bc-、部署位置：Bc-3皮带--6号
- 倾角传感器：
  字段：网关IP地址、网关端口号、传感器地址、部署位置
  恢复绝对零位
  归零（设置此处为相对零位）
  告警阈值：温度+倾角

## 告警信息

- 实时告警
  告警趋势
- 历史告警
  支持筛选条件
    所属区域、皮带
    传感器、主机设备
    告警类型
    开始&结束时间
- 巡视报告

## 系统设置

- 用户管理
- 角色管理
- 系统信息
- 告警设置
  瞬时法 数据采集频率（默认5秒/次）
  均值法 数据采集频率（默认5秒/次）；组大小（默认10）

做一个threejs动态改变某段光纤设备颜色的Demo出来；

怎么做到同时安装packages &&three-track？？（pnpm）

光纤听诊项目搭建、umi、antd、yarn、nodejs（18）版本都要最高，把Bearer-Authorization的代码搬过去。先不要管页面和布局。

3D地图采用gltf或obj格式的结构组模型文件，配合threejs来弄；echarts的3D地图是完全基于地理坐标系统。而我们的3D地图是厂区地区，不是区县市地图。

分别改变各个网格的材质颜色，而不是一起改；可旋转模型。

之后再看gantt库组件的剩余API细节。<https://github.com/neuronetio/gantt-schedule-timeline-calendar/tree/master/examples/tooltip> <https://gantt-schedule-timeline-calendar.neuronet.io/documentation/configuration/locale>

有告警信息时，自动放大到第56节皮带设备的位置。

            console.log('size',size)
                console.log('position',event.deltaY,camera.current.position)
只是初始渲染了一次，只是一次；改成50秒interval后，要隔很久才能渲染第一次，而且不用很久就消失了，之后也是再也不渲染；没有渲染完全；position-NaN-NaN-NaN出现在鼠标拖动时；

echarts地图在部分浏览器加载不出来，一直Loading

Promise.all  Uncaught (in promise) SyntaxError: Unexpected token '<', "<html>;

edge/360jisu加载不出百度地图；
<h"... is not valid JSON
Promise.then
r @ umi.js:1
s @ umi.js:1
Promise.then
r @ umi.js:1
s @ umi.js:1
(匿名) @ umi.js:1
(匿名) @ umi.js:1
(匿名) @ umi.js:1
(匿名) @ umi.js:1
d @ umi.js:1
(匿名) @ umi.js:1
(匿名) @ umi.js:1
x @ umi.js:1
o @ umi.js:1
Promise.then
E @ umi.js:1
_ @ umi.js:1
O @ umi.js:1
x @ umi.js:1
Tt @ umi.js:1
T @ umi.js:1
O @ umi.js:1
x @ umi.js:1
o @ umi.js:1
(匿名) @ umi.js:1
ge @ umi.js:1
be @ umi.js:1
me @ umi.js:1
(匿名) @ umi.js:1
n @ umi.js:1
Hg0r.Mt.s.run @ umi.js:1
(匿名) @ umi.js:1
Hg0r.Mn @ umi.js:1
Hg0r.rr @ umi.js:1
(匿名) @ umi.js:1
d @ umi.js:1
(匿名) @ umi.js:1
(匿名) @ umi.js:1
r @ umi.js:1
s @ umi.js:1
(匿名) @ umi.js:1
(匿名) @ umi.js:1
(匿名) @ umi.js:1
(匿名) @ umi.js:1
ws @ umi.js:1
Xl @ umi.js:1
(匿名) @ umi.js:1
oa @ umi.js:1
Yl @ umi.js:1
(匿名) @ umi.js:1
F @ umi.js:1
(匿名) @ umi.js:1

<http://192.168.0.71:90/zentao/my-bug-assignedTo.html>

可动态适应的感叹号标志物、或者告警信息透明式弹窗在模型上层的适当位置；raycaster.intersectObjects一直是空数组;scene.current已经确保为一直都是一个HemisphereLight+一个Group；感觉是射线和摄像机的角度矛盾问题，之前偶尔出现过放大现象，现在没出现过了，不知道为何。。还有就是需要放大到一定程度，距离足够近？？

<https://lanhuapp.com/web/#/item/project/detailDetach?pid=60559a44-c362-4644-ada3-46a0f8f75aa2&project_id=60559a44-c362-4644-ada3-46a0f8f75aa2&image_id=ccf80098-7d14-4d65-af8a-4c57dc9ab12a&fromEditor=true>

iconfont上的项目图标更新过的话，需要及时更新umi项目里的链接；

```js

    // camera.current.rotation.set(
    //   cameraInfoDefault.rotation.x,
    //   cameraInfoDefault.rotation.y,
    //   cameraInfoDefault.rotation.z,
    // );
    // camera.current.zoom = cameraInfoDefault.zoom;
```

[
    "_0_96747a60-3fe7-4a3c-90a6-b7dcb8333ba0"
]

[
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_80091c0b-4c7e-4c9d-ab53-d4e119f4a17c",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0175d797-9746-40ce-a07f-cbd7874d1d56",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_57364a82-36c6-4473-ab5d-dd24129ce492",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_80091c0b-4c7e-4c9d-ab53-d4e119f4a17c_2a6866b7-d335-4c60-bc11-a4f748e91026",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0175d797-9746-40ce-a07f-cbd7874d1d56_9b90618e-0fea-4fc9-80b9-bf22f917490b",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_57364a82-36c6-4473-ab5d-dd24129ce492_c73d03b7-d03d-40ca-9ba9-beaf22932fd2",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_57364a82-36c6-4473-ab5d-dd24129ce492_2101913f-3e04-4d67-89d2-b6f5ac2588dc",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_57364a82-36c6-4473-ab5d-dd24129ce492_a1a50679-1de3-48b6-b49a-3dddbb21b9f9",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_46622094-5036-4741-befe-b70014c014fe",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_7a74ec10-1f37-43ab-8678-b1ead0a10bf2",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_7b1d7404-f7b9-4fbf-bfa5-3a839b147464",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_5552f518-30d0-4e52-8d9b-e9dea77f8767",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_731b74c3-129e-44ff-9ca0-f3cf61efc1b8",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_8806f402-ad39-478e-b7ff-7b4d042554dd",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_8fdb81fe-def8-411f-a6d4-df2b5aa95c1d",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_08b1605e-af7e-49af-84a6-6b655a921268",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_bc794e15-814e-4905-9630-200043fb45de",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_75a2ecfb-4865-4388-b90d-673f195e0cf6",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_e25d8245-198d-4beb-978e-22cd440407b2_595a2234-5d53-4433-b751-5c7a9958a672",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874_5439858a-7059-48f3-8ca1-28edc3299693",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874_c116b697-2db9-4793-a216-71e28fc7f32f",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874_b224b7ad-04f8-45c4-95d2-8305e9ce18dd",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874_34aec8f7-3fd0-480c-9523-682e184f6370",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874_d9d67eee-bd96-42b8-ab58-160c7e864fcc",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874_d765cebc-eb89-49ef-ab0b-a67068871908",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874_d06c3e85-9b83-45b9-9ae5-32fa814ed682",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874_4b958463-d4ba-4444-83ab-31e43983b4f8",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874_5295d435-ca97-44bb-b4dc-9c144827d45f",
    "_0_edaa5c9a-9828-42c9-b8c2-2a378e092805_0a5f29d4-c369-4d33-b280-492a43bce874_e0e9bf26-2c7c-4adf-b8a9-7a74f58e5ae5",
    "0-0-0-0-0-0",
    "0-0-0-1-0-0",
    "0-0-0-1-0-1",
    "0-0-0-2-0-0",
    "0-0-0-2-1-0",
    "0-0-0-2-2-0",
    "0-0-0-3-0-0",
    "0-0-0-3-0-1",
    "0-0-0-3-0-2",
    "0-0-0-3-0-3",
    "0-0-0-3-0-4",
    "0-0-0-3-0-5",
    "0-0-0-3-0-6",
    "0-0-0-3-0-7",
    "0-0-0-3-0-8",
    "0-0-0-3-0-9",
    "0-0-0-3-1-0",
    "0-0-0-3-1-1",
    "0-0-0-3-1-2",
    "0-0-0-3-1-3",
    "0-0-0-3-2-0",
    "0-0-0-3-2-1",
    "0-0-0-3-3-0",
    "0-0-0-3-3-1",
    "0-0-0-3-4-0",
    "0-0-0-3-4-1",
    "0-0-0-3-4-2",
    "0-0-0-3-4-3",
    "0-0-0-3-4-4",
    "0-0-0-3-4-5",
    "0-0-0-3-5-0",
    "0-0-0-3-5-1",
    "0-0-0-3-5-2",
    "0-0-0-3-5-3",
    "0-0-0-3-6-0",
    "0-0-0-3-6-1",
    "0-0-0-3-6-2",
    "0-0-0-3-6-3",
    "0-0-0-3-6-4",
    "0-0-0-3-7-0",
    "0-0-0-3-7-1",
    "0-0-0-3-7-2",
    "0-0-0-3-8-0",
    "0-0-0-3-8-1",
    "0-0-0-3-8-2",
    "0-0-0-3-8-3",
    "0-0-0-3-8-4",
    "0-0-0-3-8-5",
    "0-0-0-3-8-6",
    "0-0-0-3-8-7",
    "0-0-0-3-8-8",
    "0-0-0-3-8-9",
    "0-0-0-3-9-0",
    "0-0-0-3-9-1",
    "0-0-0-3-9-2",
    "0-0-0-3-9-3",
    "0-0-0-3-10-0",
    "0-0-0-3-10-1",
    "0-0-0-3-10-2",
    "0-0-0-3-10-3",
    "0-0-0-3-10-4",
    "0-0-0-4-0-0",
    "0-0-0-4-1-0",
    "0-0-0-4-1-1",
    "0-0-0-4-1-2",
    "0-0-0-4-1-3",
    "0-0-0-4-2-0",
    "0-0-0-4-2-1",
    "0-0-0-4-2-2",
    "0-0-0-4-2-3",
    "0-0-0-4-2-4",
    "0-0-0-4-3-0",
    "0-0-0-4-3-1",
    "0-0-0-4-3-2",
    "0-0-0-4-3-3",
    "0-0-0-4-3-4",
    "0-0-0-4-3-5",
    "0-0-0-4-4-0",
    "0-0-0-4-4-1",
    "0-0-0-4-4-2",
    "0-0-0-4-4-3",
    "0-0-0-4-4-4",
    "0-0-0-4-4-5",
    "0-0-0-4-5-0",
    "0-0-0-4-5-1",
    "0-0-0-4-5-2",
    "0-0-0-4-5-3",
    "0-0-0-4-5-4",
    "0-0-0-4-5-5",
    "0-0-0-4-6-0",
    "0-0-0-4-7-0",
    "0-0-0-4-7-1",
    "0-0-0-4-7-2",
    "0-0-0-4-7-3",
    "0-0-0-4-8-0",
    "0-0-0-4-8-1",
    "0-0-0-4-9-0",
    "0-0-0-4-9-1",
    "0-0-0-4-9-2",
    "0-0-0-4-9-3",
    "0-0-0-4-9-4",
    "0-0-0-4-9-5",
    "0-0-0-4-9-6",
    "0-0-0-4-9-7",
    "0-0-0-4-9-8",
    "0-0-0-4-9-9"
]

{
    "x": -1078149.9727360187,
    "y": -35726.44635172148,
    "z": 4871688.168309238
}
{
    "x": -1078149.9727360187,
    "y": -35726.44635172148,
    "z": 4871688.168309238
}

{
    "x": 3619305.618955718,
    "y": 954273.7649214286,
    "z": -264512.4615175533
}

首页告警交互和树过滤交互联动(id-name-code还存在问题)。让测试环境尽量接近真实环境，还是有些设备高亮不了！！：告警websocket和模型的零件名称；

{
    "id": "312241",
    "x": 7.1,
    "y": 13.94,
    "temperature": -29.62,
    "inspectionEquipmentId": 2091970561,
    "inspectionEquipmentName": "皮带",
    "createTime": "2024-10-27T16:12:43.000+00:00"
}
{
    "creator": "system",
    "createTime": "2024-10-29T00:57:32.000+00:00",
    "updater": "sys",
    "updateTime": "2024-10-29T00:57:32.000+00:00",
    "id": "144820",
    "inspectionEquipmentId": 2091970561,
    "inspectionEquipmentName": "皮带",
    "type": 2,
    "resourcesFile": null,
    "timeDomainImg": null,
    "spectrogramImg": null,
    "reviewStatus": 0,
    "status": 1,
    "inspectionEquipmentType": 1,
    "tiltAmount": 8.39,
    "temperature": null,
    "alarmLevel": 1,
    "position": "D102/001/皮带0-1",
    "detectorId": null,
    "inspectionEquipmentCode": "570297",
    "reportPath": "/resource/export/tile_sensor_report/2024-10-29/倾斜传感器巡视报告20241029085732.xlsx"
}

1164 32 520

{
    "creator": "system",
    "createTime": 1730086094000,
    "updater": "sys",
    "updateTime": 1730086094000,
    "id": "131113",
    "inspectionEquipmentId": -1663500287,
    "inspectionEquipmentName": "探测器3",
    "type": 1,
    "resourcesFile": "audio/2024/10/28/db9b3388-106c-4d47-9c41-88d7245fd63c.wav",
    "timeDomainImg": "audio/2024/10/28/db9b3388-106c-4d47-9c41-88d7245fd63c_time_domain.png",
    "spectrogramImg": "audio/2024/10/28/db9b3388-106c-4d47-9c41-88d7245fd63c_spectrogram.png",
    "reviewStatus": 0,
    "status": 1,
    "inspectionEquipmentType": 2,
    "tiltAmount": null,
    "temperature": null,
    "alarmLevel": 2,
    "position": "pidai/box/DA-11_2/探测器3",
    "detectorId": 3,
    "inspectionEquipmentCode": "DA-11_2",
    "reportPath": null
}

设备树和模型的交互中，要不要弹出popup；首页和示意图的模型缩放，限制旋转角度，不至于翻转；筛选条件贴边，样式问题；

示意图里有的设备可缩放，有的找不到，数据问题（表数据和待办接口数据问题）；海康综合服务平台：<http://192.168.0.54/doc/index.html#/portal/login>;jenkins:<http://192.168.0.222:9080/job/mk003_auscultation_web/>;

OA项目：调研甘特图组件：熟悉gantt-schedule-timeline-calendar组件的image、resizing、selection、 movement插件;
OA上传大文件：<http://192.168.0.222:8060/swagger-ui/index.html?urls.primaryName=service-store#/FileController/mergeUsingGET>
彻底掌握threejs的三维信息及其控制;

{
    "x": -1122050.8169198637,
    "y": -13731722.534482311,
    "z": -2533856.4361744965
}
cameraPosition:{
    "x": -2715648.1390131973,
    "y": -13407579.901356235,
    "z": 1977792.4341841505
},rotation:{
    "isEuler": true,
    "_x": 1.1825258443273787,
    "_y": 0.013632602518596977,
    "_z": -0.033315363308130695,
    "_order": "XYZ"
}
{
    "x": -4707281.596574265,
    "y": -14316518.845223747,
    "z": 5277142.776387008
}
{
    "isEuler": true,
    "_x": 0.8318170643658267,
    "_y": -0.19403497866019379,
    "_z": 0.20853006911375865,
    "_order": "XYZ"
}

根据志强提供的阈值接口完善阈值标注组件。add成功，调通通用类的唯一视频流组件。

```js
"JSON parse error: Cannot deserialize value of type `java.lang.Integer` from String \"maps/xm02-312cbe19-97/map1.png\": not a valid Integer value; nested exception is com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize value of type `java.lang.Integer` from String \"maps/xm02-312cbe19-97/map1.png\": not a valid Integer value\n at [Source: (PushbackInputStream); line: 1, column: 10] (through reference chain: com.xiaoma.guard.pojo.entity.InspectionEquipmentSurrounding[\"mapId\"])"

records:[
  {
    name:'片区A',
    mapId:1,
    mapInfo:{
      shape_type:'rect', // 矩形
      thresholds:[{
        alarmType:1,
        value:[20,30],
        cn_name:'一氧化碳浓度',
        name:'co',
        key:'6',
        unit:'μmol/mol',
      },{
        alarmType:2,
        value:[20,30],
        cn_name:'氨气浓度',
        name:'nh3',
        key:'7',
        unit:'μmol/mol',
      }],
      coordinate:[[100,100],[200,200]]
    }
  },
  {
    name:'片区B',
    mapId:1,
    mapInfo:{
      shape_type:'polygon', // 多边形
      thresholds:[{
        alarmType:1,
        value:[20,30],
        cn_name:'一氧化碳浓度',
        name:'co',
        key:'6',
        unit:'μmol/mol',
      },{
        alarmType:2,
        value:[20,30],
        cn_name:'氨气浓度',
        name:'nh3',
        key:'7',
        unit:'μmol/mol',
      }],
      coordinate:[[110,110],[220,110],[165,180]]
    }
  }
]
[
    {
        "createTime": 1715655673000,
        "creator": "admin",
        "updateTime": 1715655673000,
        "updator": "admin",
        "id": 5,
        "name": "maps/xm01-20a4b4bc-bf/mapname.png",
        "deviceJson": null,
        "mapPath": "maps/xm01-20a4b4bc-bf/mapname.png",
        "status": 1,
        "scale": null,
        "rotate": null,
        "x": null,
        "y": null,
        "modelOverallZoom": null,
        "mapScale": null,
        "ignoreModel": "",
        "source": null,
        "width": 1600,
        "height": 500,
        "originX": 0,
        "originY": 0,
        "proportion": 0.002,
        "navigationPath": null,
        "navigationPointIds": null,
        "navigationPoints": null,
        "chargingRooms": null,
        "robotType": null,
        "xaxisOffset": null,
        "yaxisOffset": null,
        "zaxisOffset": null,
        "xaxisRotation": null,
        "yaxisRotation": null,
        "zaxisRotation": null
    },
    {
        "createTime": 1715675102000,
        "creator": "admin",
        "updateTime": 1715675102000,
        "updator": "admin",
        "id": 6,
        "name": "maps/xm01-f1db2337-42/mapname.png",
        "deviceJson": null,
        "mapPath": "maps/xm01-f1db2337-42/mapname.png",
        "status": 1,
        "scale": null,
        "rotate": null,
        "x": null,
        "y": null,
        "modelOverallZoom": null,
        "mapScale": null,
        "ignoreModel": "",
        "source": null,
        "width": 1600,
        "height": 500,
        "originX": 0,
        "originY": 0,
        "proportion": 0.5,
        "navigationPath": null,
        "navigationPointIds": null,
        "navigationPoints": null,
        "chargingRooms": null,
        "robotType": null,
        "xaxisOffset": null,
        "yaxisOffset": null,
        "zaxisOffset": null,
        "xaxisRotation": null,
        "yaxisRotation": null,
        "zaxisRotation": null
    },
    {
        "createTime": 1721373614000,
        "creator": "admin",
        "updateTime": 1721373614000,
        "updator": "admin",
        "id": 8,
        "name": "maps/xm01-efd38f2a-1f/mapname.png",
        "deviceJson": null,
        "mapPath": "maps/xm01-efd38f2a-1f/mapname.png",
        "status": 1,
        "scale": null,
        "rotate": null,
        "x": null,
        "y": null,
        "modelOverallZoom": null,
        "mapScale": null,
        "ignoreModel": "",
        "source": null,
        "width": 1600,
        "height": 500,
        "originX": 0,
        "originY": 0,
        "proportion": 0.001,
        "navigationPath": null,
        "navigationPointIds": null,
        "navigationPoints": null,
        "chargingRooms": null,
        "robotType": null,
        "xaxisOffset": null,
        "yaxisOffset": null,
        "zaxisOffset": null,
        "xaxisRotation": null,
        "yaxisRotation": null,
        "zaxisRotation": null
    },
    {
        "createTime": 1727339713000,
        "creator": "admin",
        "updateTime": 1727339713000,
        "updator": "admin",
        "id": 9,
        "name": "maps/xm01-b1868021-3f/mapname.png",
        "deviceJson": null,
        "mapPath": "maps/xm01-b1868021-3f/mapname.png",
        "status": 1,
        "scale": null,
        "rotate": null,
        "x": null,
        "y": null,
        "modelOverallZoom": null,
        "mapScale": null,
        "ignoreModel": "",
        "source": null,
        "width": 1600,
        "height": 500,
        "originX": 0,
        "originY": 0,
        "proportion": 0.5,
        "navigationPath": null,
        "navigationPointIds": null,
        "navigationPoints": null,
        "chargingRooms": null,
        "robotType": null,
        "xaxisOffset": null,
        "yaxisOffset": null,
        "zaxisOffset": null,
        "xaxisRotation": null,
        "yaxisRotation": null,
        "zaxisRotation": null
    },
    {
        "createTime": 1726798619000,
        "creator": "admin",
        "updateTime": 1726798619000,
        "updator": "admin",
        "id": 10,
        "name": "maps/xm02-4d8742eb-d9/nanchang.png",
        "deviceJson": null,
        "mapPath": "maps/xm02-4d8742eb-d9/nanchang.png",
        "status": 1,
        "scale": null,
        "rotate": "0",
        "x": null,
        "y": null,
        "modelOverallZoom": null,
        "mapScale": null,
        "ignoreModel": "",
        "source": null,
        "width": 3211,
        "height": 4538,
        "originX": 107.007,
        "originY": 177.3,
        "proportion": 0.05,
        "navigationPath": "[[105,107],[107,109]]",
        "navigationPointIds": null,
        "navigationPoints": null,
        "chargingRooms": null,
        "robotType": null,
        "xaxisOffset": null,
        "yaxisOffset": null,
        "zaxisOffset": null,
        "xaxisRotation": null,
        "yaxisRotation": null,
        "zaxisRotation": null
    },
    {
        "createTime": 1731391967000,
        "creator": "admin",
        "updateTime": 1731551759000,
        "updator": "admin",
        "id": 12,
        "name": "maps/xm02-312cbe19-97/map1.png",
        "deviceJson": null,
        "mapPath": "maps/xm02-312cbe19-97/map1.png",
        "status": 1,
        "scale": null,
        "rotate": "0",
        "x": null,
        "y": null,
        "modelOverallZoom": null,
        "mapScale": null,
        "ignoreModel": "",
        "source": null,
        "width": 2802,
        "height": 1732,
        "originX": 89.523,
        "originY": 43.517,
        "proportion": 0.05,
        "navigationPath": "[[176,178],[178,180],[180,182],[184,186],[186,188]]",
        "navigationPointIds": null,
        "navigationPoints": null,
        "chargingRooms": null,
        "robotType": 210,
        "xaxisOffset": null,
        "yaxisOffset": null,
        "zaxisOffset": null,
        "xaxisRotation": null,
        "yaxisRotation": null,
        "zaxisRotation": null
    }
]

{
    "details": "异常： 2024-11-21 13:57:07，设备pdjk230210 ，检测到皮带撕裂，请尽快处理！",
    "time": "2024-11-21 13:57:07",
    "channel": "fix_camera",
    "inspectionEquipmentId": null,
    "zone": "房间1",
    "region": "主厂区",
    "intervals": "A区域",
    "pointName": null,
    "pointType": null,
    "pointMainDeviceName": null,
    "warningLevel": 1,
    "pointIntervals": null,
    "taskItemId": null,
    "alarmInfoId": 2595,
    "recognitionCode": "belt_tear",
    "recognitionName": "皮带撕裂",
    "whetherSilent": null,
    "type": 1
}
```

补充功能点：
1、添加模型场景局部元素显示状态，显示或者隐藏摄像头设备&导航点元素。
2、可通过模型场景查看机器人状态（空闲/执行中/离线）以动态浮标形式体现，机器人状态可根据浮标颜色进行判断。
3、模型场景支持切换到内部廊道进行查看，入口就是浮标图标，鼠标移入引导进入。
4、模型场景中的摄像头设备支持可点击，底部弹出现场设备的直播流列表，可根据对应设备进行查看。
5、添加操作使用说明，常驻在模型场景区域右上角，点击icon底部弹出操作说明面板@赵仁伟

四棵树和哈密的服务器密码：123.com；222:robot0905;海康摄像机设置页面：xm123456

主题设置没有与antd结合好，总是写很多覆盖antd组件的样式代码;环境阈值管理绘画多个矩形存在问题；tableList高度设置兼容所有情形；后台管理的所有表格高度和分页；
标注组件背景色和主题色有无关系？首页红点功能；皮带撕裂报警弹窗；

哈密项目测试和薛凯制定的新格式。codeMap--device_rec,state_rec

模型管理的拍照功能还需要吗？没设计，要不就隐藏按钮？

本机IP：192.168.0.36-192.168.20.5

新建需求反馈时，会校验访谈记录表，给出能否查出所填客户的相关提示。

OKR需求咨询：没有做resetFields的功能，因为没有做双向绑定表单各项value；limit person to add at only-1.

标杆二期整体项目的蓝湖样式核对。在标注第38个，工具框往下放，别遮挡图片，增加清空所有标注的按钮

可切换主题的话，div,span {color:'var(--text-color)'} 这条样式规则要应用于全局！！
自我评价：较完整的解决了哈密现场的非首页前端问题，和永拓对接首页的切换廊道内视野和距离测量的功能实现，并跟进模型样式与交互、以及机器人控制等缺陷的修复；完善AI标注组件，支持设备类多表框标注多组输入框的信息输入功能；完成标杆二期历史信息界面和后台管理的样式优化，并优化‘上一个下一个’连续标注的体验；增加视频流组件的‘设备已离线’文案显示，离线情况下不请求websoket，优化请求异常时的阻塞感体验

标注之前需要先勾选一下前面的勾选框，没勾相当于很多空信息进入标注组件，加个阻止逻辑；

<http://192.168.0.222:8005/api/equipment-model/control-robot-send-msg?action=motionControl> {mode:0}（停止） 怎么在 <http://192.168.0.222:8005/api/equipment-model/control-robot-send-msg?action=motionControl>
 {
  "mode": 1,
  "value": "0.2"
}（前进）  之后呢？？

监控大厅的新告警列表;解决学习中心‘前端开发’标签下，书籍分类不对的问题(缺少书籍类别的管理接口)；另外有没有新增或管理音视频上传模块的后台文件夹的功能？？

填写OKR……

```js
// videoDetail/index.tsx line-6 通过id获取课程详情
  //const getIdByCourse

// return code:500,msg:null
const res = await API.backCourseSelectCourseDetail({ data: { courseListId } })
```

<http://192.168.0.222:9080/view/all/job/x-iis-ctb_web_ii/> <http://192.168.0.71/yangzhengliang/400c/-/blob/dev/src/components/GlobalHeader/RobotSelect.tsx> <http://192.168.0.71:90/zentao/user-login-L3plbnRhby9idWctYnJvd3NlLTIwLmh0bWw=.html> <https://acnp6tmmnnfg.feishu.cn/wiki/ZSNkw5VTMiSz0EkSUJocrVcSnIe> <https://cn.vuejs.org/guide/essentials/computed> <https://map.bmcx.com/hutubixian__map/> <http://192.168.20.222:8060/swagger-ui/index.html?urls.primaryName=service-store> <http://three.dtking.cn/start/%E7%AC%AC%E5%9B%9B%E7%AB%A0%20%E4%BD%BF%E7%94%A8%20three.js%20%E6%9D%90%E6%96%99.html>

蒲公英iOS-uat下载地址（<https://www.pgyer.com/lr2I）>, Android-uat下载地址（<https://www.pgyer.com/UP93）。下载密码都是1234，登录的用户名：liujianyang001，密码：ghytest~1020。(蒲公英针对iOS有限制设备uuid)>

流程引擎：偏一些数值计算公式的自定义输入； 年终汇报简要：工作总结、存在问题分析、业绩数据展示、未来发展规划；自我介绍、自我岗位认知、前期工作总结、后期工作规划；工作内容回顾、未来发展规划（没有积极关注群内相关问题，比如没及时部署最新代码到客户现场；） 工作内容、难点分析、目标计划
加班内容：更改哈密现场问题，一键导航功能和其他方面；编写年终汇报PPT；

我所在岗位—web前端开发的岗位职责主要包括：1.负责Web前端页面构建及前后端交互的设计、开发、和支持工作；2.根据产品设计要求，完成机器人智能巡检系统的前端开发；3.负责解决系统的前端兼容性问题，其中涉及多浏览器、不同终端间，持续优化用户交互体验，保证执行效率；4.参与项目需求的分析、概要设计、和详细设计等，撰写相关技术文档。

个人涉及的主要项目包括：标杆项目、滦平项目、滦平APP、四棵树、哈密、呼图壁、邹县、OA项目等，需参与其中的前端开发和样式交互优化。

我会认真努力地，结合产品使用场景、硬件软件交互、前后端交互等方面，去做深入思考，明白前端界面和交互对客户使用的重大意义，持续不断地优化交互体验。不过，对产品使用的深入理解，和项目底层代码、以及各个模块和页面的深度熟悉，需要一些时间的积累，所以我还需不断努力实践，和同事相互认真协作，共同实现好领导交代的客户需求。

涵盖：启动页、登录页、首页总览、个人中心、消息通知、控制中心、人工巡查缺陷告警、历史数据、音频分析等模块页面开发。采用react-native技术栈，使用VSCode编辑器、Android Studio、夜神模拟器、adb工具等，实现了一款安卓巡检APP。经过不断优化，保障基本功能的实现，实现页面间的流畅切换与使用；同时实现内网穿透到公网的https、wss安全网络传输环境，方便客户现场使用APP，其中涉及到https证书的配置更新。

难点分析：绘制轨道地图方面耗费了较多时间

不足：目前视频流播放地址的公网服务器穿透，还需客户网络的支持；另外，缺乏react-native的iOS端开发和适配；还有就是，暂时未适配210轮式机器人。

- 皮带撕裂报警弹窗

重点：通过lottie动画库配置闪烁效果的动画

- 后台管理

环境阈值管理新增地图片区标注功能及起始点终点输入操作，支持410和210的环境阈值告警设定

- 国际化功能开发和主题适配

完成国际化功能未完善部分的开发工作，翻译准确而简短，语言切换前后，页面样式正常显示，较长的英语翻译可截断并添加tooltip（title）。

主题适配方面，同时支持浅色和暗色两套主题，支持绝大部分场景的UI正常显示。Ant Design的主题功能不能完全满足一些特殊场景，而且自研的主题功能在细节方面的自由度更高。

不足：国际化是一项需要前后端全面适配的工作，还不够全面。

- 样式优化

对齐页面内的主要元素，缩小没必要的间距，使得表格这样的主要页面内容组件占据更大空间；给系统页面设置较大的最小宽高，使得浏览器窗口缩放后，出现滚动条，不至于文字和页面元素重叠、换行等。

- 新增AI配置管理模块

是一些从四棵树项目迁移过来的AI能力，包含AI能力配置、算法库管理、模型库管理、素材库管理界面。优化AI能力配置界面内模型配置弹窗的样式，分组显示识别类型，添加分组的全选功能

- 视频流组件

从原来的nodejs FFmpeg推流服务，迁移至JAVA的zlk服务，以及flv.js播放组件，可同时支持100路按序播放flv-websocket视频流。不足之处是目前还不能适配好H265。

如果设备是离线状态，增加‘设备已离线’的提示，不建立websocket连接。

- 标注组件

基于开源组件canvas-select，可支持按接口返回的标注配置信息，在不同识别类型下显示不一样的标签和图形；可支持多表计分组识别；可以按不同识别类型，去配置需要的输入信息字段，以适应需要；可支持半自动标注

部署标注列表页，针对标注弹窗，增加‘上一个下一个’的切换功能

- 新增智能告警和告警模式设置

包含告警信息显示和历史信息的显示；告警模式可以设置为实时推送模式，或者是包含允许推送的告警等级和识别类型的定制化推送模式，或者免打扰模式

- 其他优化

树组件增加搜索后高亮关键词功能；表格组件添加loading效果；对所有分类的告警增加‘已读’和‘全部已读’的功能，并红块显示各类告警数量。丰富日志管理表格的数据展示内容；

放开所有接口请求出错的msg提示，删除所有非必要的个性化错误提示，避免二次提示；同时修正所有非必要的error型提示为warn类型；

- 首页3D模型

当光纤听诊探测器或倾斜传感器触发告警时，可放大显示具体设备的位置，并弹出告警信息的弹窗；也可从左侧额今日告警列表当中，选中单条告警数据后，联动到3D模型。

首页还可查看正常运转率、设备状态、统计类数据、和告警类数据。

- 设备管理、告警信息

主要模块除了首页3D模型，还有设备管理、和告警信息；设备管理包含批量设置阈值、探测器通道详情、告警趋势等界面。

不足：首页3D模型添加大地面后，大地效果不够好，暂定，还没有部署；

- 首页

banner替换并改进动画，更新底部合作伙伴组件，

- 关于我们

重构发展历程pc端组件，移动端样式改造

- 产品中心
更改机器人背景图，去除水印，更改MW-200B为MW-210，更改MG-400C为MG-420，增加MG410。

- 解决方案
将行业案例模块替换为解决方案，包含智慧电力的智慧电厂、智慧光伏场站、变电站智能巡视系统；智慧矿山的煤矿智能化；智慧冶金的智慧钢厂。可跳转到方案详情页和子系统页面。

- 新闻
删除字体侵权的新闻链接，增加最近的新闻

- 哈密

首页数字孪生，协助永拓开发测量功能和廊道内视角切换功能，将首页实时信息列表从虚拟列表改成普通分页，避免卡顿。

- 企业大学

视频上传和播放支持flv格式；学习平台升级为企业大学，新增删除帖子功能；修复通知中心、后台哪里的已有问题，并优化样式，修复首页学习时长数据不对的问题

- OA项目

联调完流程配置界面和市场管理的需求咨询

- 其他项目的支持

国投罗钾、四棵树等项目的开发和线上问题修复

- 邹县项目

负责项目的前端开发，较好较完整地实现UI设计的界面

- OA项目

继续开发市场管理剩余的模块，包括需求咨询、项目立项、方案策划、和需求交接等界面。

你有去看工作机会吗，打算投南昌的哪些公司？

# 周报

哈密项目：解决‘头部B侧’的预览图片缓存时间问题，是通过手动拍照，更新预览图片缓存的方式；协助政樑解决海康相机无法进行语音对讲的问题；更改控制中心的一键导航样式；
标杆二期：退出登录时保持所有localStorage，这样重新登录后不用再选择机器人；AI配置管理模块和监控大厅模块的拍照接口改为sdkCtrl；去除stateGridSafe的websocket请求；优化智能告警历史表格样式和国际化样式；修复登录页切换语言后需刷新页面才切换成功的问题；
其他：编写年终汇报PPT；
OA项目：
邹县项目：
标杆二期：各类告警信息未读数量的统计接口unreadCount优化为每隔10秒调用一次，另外在点击各种已读按钮时通过EvenBus触发调用统计接口，提升页面响应速度；日期范围组件适配暗色主题；切换机器人后就重连assetWebsocket；
学习平台-企业大学：协助志强解决upload/books跨域问题；协助志强解决‘LIMIT=10’数据库查询报错的问题；解决首页个人学习时长、部门学习时长在月份和年份维度上不对的问题；替换登录页系统logo；解决后台管理-方案管理界面内上传pdf接口调用不通的问题；

## 下周计划

完成哈密项目验收前的缺陷修复，以及对接永拓
呼图壁项目-现场维护，跟踪客户需求，及时响应
OA系统项目：开发市场管理模块

*周报要写一两个遇到的问题，和解决方式*
*百度智能云上的JoySSL-techxiaoma.com证书将在2024.11.29过期。*
*专利挖掘---南昌中易知识产权代理有限公司。发明 实用新型 外观设计。保护客体。产品 方法或者其改进。 新技术方案。形状 构造及其结合。形状 图案  色彩与形状、图案的结合。能申请实用新型的一定能申请发明专利，能申请发明专利的不一定能申请实用新型。水力诱导微涡旋发生器。洗涤塔的喷嘴。干燥面食的杆。*
*高度平齐问题；表格列各个列宽度要设置适当些；首列序号列和末尾操作列宽度要小，后者更小些；底部的分页组件要在右下角，不要跟随表格高度，特别是数据少时；*
南昌人才新政策：<https://www.ncrcw.com.cn/ngwc/#/index> <https://www.ncrcw.com.cn/ngwc/#/home/content/news-detail?id=1780507803404816385>
