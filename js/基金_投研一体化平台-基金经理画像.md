# 概要设计
*一、背景和目标*
人力资源部希望*基于客观数据构建基金经理画像模型*，从*收益能力、资产规模、回撤控制*等*多角度构建模型*，实现对*基金经理业绩的量化考核*。自动获取*基金产品、基金经理维度*的*指标数据*，构建基金经理*画像基础数据视图*，提升数据准确性、实时性，以及数据获取和计算效率。

*二、建设内容*
## 2.1基金经理画像基础数据指标
- 基金产品维度
*产品属性*：
名称、基金代码、基金成立时间、清盘时间、历任基金经理、历任基金经理任职时间、现任、现任时间、部门
*业绩属性*
一年收益率（上一个完整考核年份）、一年收益率排名、一年收益率排名百分比、一年业绩统计基金经理、最大回撤排名、回车排名百分比；
三年……
上年1月~12月规模（月底）、……（日均）、年底规模(12月底)、上年日均规模、前年年底规模、前年日均规模
多元资产子基金：上年1月道12月规模（月底）、……（日均）
*财务属性*
上年管理费收入、上年业绩报酬收入、上年成本、净收入；前年管理费收入、……
多元资产子基金：上年管理费收入、前。
*产品类型*
公募、专户、QFII、投顾（外部FOF的投资标的）
- 基金经理维度
*产品属性*：
姓名、管理基金个数
*业绩属性*
一年规模加权收益率（上一个完整考核年份）、一年规模加权收益率排名百分比、一年最大回撤排名、……比啊粉笔；三年规模加权收益率、三年规模加权收益率排名百分比；上年年底规模（12月底）、上年日均规模、前年年底规模（12月底）、前年日均规模、三年……
*财务属性*
上年管理费收入、……
## 2.2衍生指标计算逻辑
- 基金产品维度：
1. 规模加权收益=区间收益率*区间日均规模
2. 规模加权最大回撤
3. 规模加权收益率排名百分比
4. 规模加权最大回撤排名百分比
5. 区间日均规模
6. 多元资产子基金日规模
7. 多元资产子基金日管理费
8. 多元资产资金及区间日均规模
- 基金经理维度：
1. 基金经理区间日均规模
2. 基金经理日均规模加权区间收益率
3. 基金经理日均规模加权区间回撤

*基金经理画像计算模型*
## 2.3关键业务流程
1. 业务人员登录界面查看基金经理画像基础指标和衍生计算指标。视图包括基金产品和基金经理、查看维度有产品类型、时间周期。查看指标的时间周期按月、年、三年等展现。
2. 业务人员可以按照基础指标视图的格式，批量导入QFII、投顾 也可以手工补录
3. 业务人员可以手工配置维护和更改多基金经理共管基金产品时，每个基金经理的贡献权重，可以按时间范围分段，手工维护和更改记录可查询
4. 业务人员可以手工配置维护公募基金排名分类，可以基于分类实时查看年度排名结果，在基础指标和衍生计算指标视图中展现，手工维护和更改记录可查询
*5. 业务人员基于基础指标和衍生指标，构建基金经理画像计算模型，手工维护和更改记录可查询（根据基本算子和数据指标，自主搭建和修改画像计算模型）
*6.
*三、基础数据梳理*
数据源：
Jytafadb估值数据表
Acrmpdb数据中心

基金产品信息：
带AC份额关联
带基金经理信息
基金经理任职区间
基金规模
基金管理费
基金成本费（尾佣）
基金业报收入
子基金规模

基金收益、最大回撤、排名相关分类和外部基金数据，调用DataAPI基金分析相关接口

*四、整体架构设计*
基金经理任职区间权重修改-手工修改-》基金经理权重配置表
基金经理权重查询、外部数据源ACRMPDB/JYTAFADB Impala 每日数据同步 每日计算；基本信息表基础数据表（年、月、日） 月底、年底、计算
统计信息表（年、月） 统计信息查询

业绩报酬分成数据QFII、投顾产品数据 批量文件导入 实时信息查询；基金分类配置表 每日数据同步（待定，可能通过批量文件导入） 基金分类查询

蓝色部分为外部数据源，黄色部分为内部表数据，红色部分为功能模块；每日、每月、每年的数据同步和统计任务通过apscheduler定时调度。

所有功能模块通过WebAPI与前端进行数据交互。API标准符合投研一体化平台API标准（API ID、鉴权等等）

## 数据表设计
基本信息表（按日维度同步）
基金产品信息表（基金代码、分级代码、起始时间、清盘时间）
基金经理信息表（基金代码、基金经理、起始时间、结束时间）

基础数据日表（）
基金产品每日业绩表（每日规模、净值、当日收益率、子基金规模）
基金产品财务表（每日产生的管理费、尾佣、业绩报酬、子基金管理费）
基金经理业绩每日表（每日规模加总，每日规模加权收益率，每日规模加权回撤汇总）
基金经理财务每日表（每日产生的管理费、尾佣、业绩报酬汇总、子基金管理费汇总）

基础数据月表（按月维度累加，每日更新）
基金产品每月业绩表（每日日均规模、每月收益率、每月最大回撤、月日均规模加权收益率、月日均规模加权回撤、每月子基金日均规模）
基金产品每月财务表（每月累加管理费、累加尾佣、累加业绩报酬、累加子基金管理费）
基金经理每月业绩表（根据基金经理时间分段区间计算每个基金的数据）（每月每个基金日均规模，每月每个基金日均规模加权月收益率，每月每个基金日均规模加权月回撤）
基金经理财务每月表（根据基金经理时间分段区间计算每个基金的数据）（每月产生的管理费、尾佣、业绩报酬、子基金管理费）

基础数据年表（按年维度累加，每日更新）
基金产品每年业绩表（每年日均规模、每年收益率、每年最大回撤、年日均规模加权收益率、年日均规模加权回撤、每年子基金日均规模、三年日均规模、三年收益率、三年最大回撤、三年日均规模加权收益率、三年日均规模加权回撤、三年子基金日均规模）
基金产品每年财务表（每年累加管理费、）
基金经理每年业绩表（根据基金经理时间分段区间计算每个基金的数据）（每年每个基金日均规模）

统计数据月表（每月更新）
基金产品每月业务统计表（月底规模、月日均规模、月收益率、月最大回撤、月规模加权收益率）

统计数据年表（每年更新）
基金产品每年业绩统计表（年底规模、年日均规模）
*五、功能模块设计*
*六、Rest接口设计*
*七、系统交互设计*

# 前端架构

https://blog.csdn.net/wowotuo/article/details/80905628
https://cloud.tencent.com/developer/article/1939380

精通好ECharts就能完全hold住该项目。

李晋、高勇，坐在16楼他们身边的工位上，以子应用或者菜单的方式，形成一个新模块。

fundAnalysisNew项目跑起来（ECharts升级成功到5），改了代码后warning还是旧的，没有热生效？

正确变量的命名很重要，对数据结构和代码逻辑设计要相当了解。

没有定义的变量、属性、函数，居然不会报错。

*收益率rate of return;*
*最大回撤maximum ratraction*retracement
指的是一段时间内基金最大的亏损幅度。 例如某只基金成立的净值是1，在一段时间的涨涨跌跌后最高涨到了2.2，后来又跌到了最低1.2，那么它的最大回撤就是45.5%。 也就是说，你在这段时间买这只基金，最多也就亏45.5%，买的便宜一点，或者卖的贵一点，都不会亏这么多
*卡玛比率Calmar ratio*
也叫“单位回撤收益率”，是描述收益和最大回撤之间的关系的指标。 卡玛比率的计算公式是：卡玛比率=年化收益率/历史最大回撤，体现的是投资者承受每单位回撤能够得到的收益率水平。 卡玛比率越高，说明基金承受单位损失获得的回报越高，性价比也越高。
*年化波动率*
即基金在指定区间内收益率标准差的年化值。 年化波动率数值越大，代表回报远离过去平均数值，故波动风险越高； 相反，年化波动率数值越小，波动风险亦较小。 历史表现不代表未来。 本基金管理人依照诚实信用、勤勉尽责的原则管理和运用基金资产，但不保证基金一定盈利，也不保证最低收益。
*年化夏普Sharpe ratio*
夏普指数，夏普值Sharpe idnex，
在金融领域衡量的是一项投资（例如证券或投资组合）在对其调整风险后，相对于无风险资产的表现。它的定义是投资收益与无风险收益之差的期望值，再除以投资标准差（即其波动性）。它代表投资者额外承受的每一单位风险所获得的额外收益。

夏普比率这个名字来自于1966年提出它的威廉·F·夏普

选好一个基金，一定要看三大指标：夏普比率、回撤率、年化收益率。 夏普比率就是风险收益的性价比。

https://zh.wikipedia.org/wiki/%E5%A4%8F%E6%99%AE%E6%AF%94%E7%8E%87
*单位净值*
基金单位（份额）净值，指每份额基金当日的价值。 是基金当前的总净资产除以基金总份额，得出的每份额基金当日的价值。 每个营业日根据基金所投资证券市场收盘价计算出基金总资产价值，扣除基金当日的各类成本及费用后，得出该基金当日的资产净值。 除以基金当日所发生在外的基金单位总数，就是每单位基金净值。
*标准差*
标准差指统计上用于衡量一组数值中某一数值与其平均值差异程度的指标。标准差被用来评估价格可能的变化或波动程度。标准差越大，价格波动的范围就越广，股票等金融 .
标准差，又称标准偏差、均方差（英语：standard deviation，缩写SD，符号σ），在概率统计中最常使用作为测量一组数值的离散程度之用。标准差定义：为方差开算术 ...

根号里面，亦即变异数（
�
2
\sigma^2）的简易口诀为：“平方和的平均”减去“平均的平方”
https://zh.wikipedia.org/zh-hans/%E6%A8%99%E6%BA%96%E5%B7%AE


搞清楚各个变量含义，和ECharts配置项细节、和代码设计逻辑、

`className='modalRow'`

performance业绩；sinceThisYear今年以来，recent1Year,recent3Years,sinceManagement,recent1Month,recent3Months,recent6Months

单位*净值 Net* unit value，Net value of unit,Net value per unit.

资产净值（net asset value）；净年值（net annual valu

abbreviation简称。abbr。

management-mng（abbr），fnd-fund，typ-type，sz-size，

benchmark基准，index-indices。

业报收入、管理费收入

多行表头、
表格某行标红，可编辑单元格。两个Tab页（基金维度和基金经理维度。）

清算winding-up，基金成立日setupdate，


表头里一些涉及到年份的列名是固定的吗，2022,2023？

业报-trade newspaper。母基金parent fund，子基金sub-fund，

jsx风格的columns和可编辑单元格，可编辑行共存？

滚动条问题、可编辑单元格；id是前端生成还是后端生成呢；小问题好改，方向上出现了一点问题就不好解决了。

加权收益率weighted rate of return,weighting;ranking division排名划分；ranking排名；netIncome净收入；权益部、固定收益部；

修改权重配置的交互？可编辑单元格样式要突出一些~

某个表格列带有：展开动作（1到12月）；children分类好。

应用入口：
http://172.18.6.108:8011/xc-frame#/xc-frame/xcvone 的全部应用倒数第五个icon。

点击查询后日期变换为日格式。

overseasInvest/src/pages/CashAccountMsinyrnsnce

table样例可以查看宏观研究页面，
#　样式变量问题
要考虑好两套主题下的公共样式变量
# 横向滚动下的文字重叠问题
```less
td.ant-table.ant-table-cell-fix-left,td.ant-table.ant-table-cell-fix-right{
  background-color var(--xc-xone-component-background) !important;//很多时候important就是一切问题的最终解决方案
}
```
# 难点攻破
必须尝试在生产环境复现，然后如果是样式问题的话，最好通过样式变量或者基本手段来修改样式问题，确认好没问题后，就能一次性修复好问题，不用改来改去。
